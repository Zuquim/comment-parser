file path,line #,comment,satd
magenta/setup.py,1,Copyright 2020 The Magenta Authors.,
magenta/setup.py,2,,
magenta/setup.py,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/setup.py,4,you may not use this file except in compliance with the License.,
magenta/setup.py,5,You may obtain a copy of the License at,
magenta/setup.py,6,,
magenta/setup.py,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/setup.py,8,,
magenta/setup.py,9,"Unless required by applicable law or agreed to in writing, software",
magenta/setup.py,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/setup.py,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/setup.py,12,See the License for the specific language governing permissions and,
magenta/setup.py,13,limitations under the License.,
magenta/setup.py,20,Bit of a hack to parse the version string stored in version.py without,
magenta/setup.py,21,"executing __init__.py, which will end up requiring a bunch of dependencies to",
magenta/setup.py,22,"execute (e.g., tensorflow, pretty_midi, etc.).",
magenta/setup.py,23,Makes the __version__ variable available.,
magenta/setup.py,25,pylint: disable=exec-used,
magenta/setup.py,34,Temporary fix for gast issue with TF.,
magenta/setup.py,35,Details:,
magenta/setup.py,36,https://github.com/tensorflow/tensorflow/issues/32319,
magenta/setup.py,37,https://github.com/tensorflow/tensorflow/commit/c72125bd59858ec82a9238b232bbd77c45889c5a,
magenta/setup.py,39,"tensor2tensor requires gym, but the newest version of gym depends on a",
magenta/setup.py,40,a version of cloudpickle that is incompatible with tensorflow-probability,
magenta/setup.py,41,0.7.0.,
magenta/setup.py,50,1.14.6 is required for colab compatibility.,
magenta/setup.py,55,1.2 breaks us,
magenta/setup.py,60,Keep Sonnet < 2.0.0 because that requires TF2.,
magenta/setup.py,61,"For now, restrict to < 1.36 because that requires tensorflow-probability",
magenta/setup.py,62,"0.8.0, which causes problems with tensor2tensor.",
magenta/setup.py,63,Sonnet 2 requires TF2.,
magenta/setup.py,65,Magenta is not yet TF2 compatible.,
magenta/setup.py,67,Pinned to be compatible with tensor2tensor requirements.,
magenta/setup.py,72,Temporary fix for 'typing' issue,
magenta/setup.py,73,Temporary fix for:,
magenta/setup.py,74,https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2737?filter=allopenissues,
magenta/setup.py,86,pylint:disable=line-too-long,
magenta/setup.py,137,pylint:enable=line-too-long,
magenta/setup.py,141,pylint: disable=undefined-variable,
magenta/setup.py,148,PyPI package information.,
magenta/setup.py,177,1.30 has problems working with pylint plugin,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,24,TODO(adarob): Remove these imports once moved to /py internally.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,Registers all Magenta problems with Tensor2Tensor.,
magenta/,23,pylint: disable=unused-import,
magenta/,24,pylint: disable=unused-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,Registers all Magenta problems with Tensor2Tensor.,
magenta/,23,pylint: disable=unused-import,
magenta/,24,pylint: disable=unused-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,pylint: disable=unused-import,
magenta/,20,pylint: enable=unused-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,Registers all Magenta problems with Tensor2Tensor.,
magenta/,23,pylint: disable=unused-import,
magenta/,24,pylint: disable=unused-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,pylint: disable=unused-import,
magenta/,21,pylint: enable=unused-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,34,Mapping from pitch class index to name.,
magenta/,78,major,
magenta/,81,minor,
magenta/,126,major,
magenta/,129,minor,
magenta/,132,augmented,
magenta/,135,diminished,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,64,One C.,
magenta/,70,One C and one C#.,
magenta/,76,"One C, one C#, and one D.",
magenta/,83,D Major.,
magenta/,89,C# Major with accidentals.,
magenta/,96,One note in C Major.,
magenta/,102,Melody transposed down 5 half steps. 2 octave range.,
magenta/,109,Melody transposed up 19 half steps. 2 octave range.,
magenta/,116,Melody transposed zero half steps. 1 octave range.,
magenta/,124,"Melody in C, transposed to C, and squashed to 1 octave.",
magenta/,131,"Melody in D, transposed to C, and squashed to 1 octave.",
magenta/,138,"Melody in D, transposed to E, and squashed to 1 octave.",
magenta/,146,Move up an octave.,
magenta/,155,Move down an octave.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,Meter-related constants.,
magenta/,19,4/4 music sampled at 4 steps per quarter note.,
magenta/,22,Default absolute quantization.,
magenta/,25,Standard pulses per quarter.,
magenta/,26,https://en.wikipedia.org/wiki/Pulses_per_quarter_note,
magenta/,29,Special melody events.,
magenta/,34,Other melody-related constants.,
magenta/,37,Inclusive.,
magenta/,38,Inclusive.,
magenta/,41,Velocity-related constants.,
magenta/,42,Inclusive.,
magenta/,43,Inclusive.,
magenta/,45,Program-related constants.,
magenta/,49,MIDI programs that typically sound unpitched.,
magenta/,53,"Chord symbol for ""no chord"".",
magenta/,56,The indices of the pitch classes in a major scale.,
magenta/,59,NOTE_KEYS[note] = The major keys that note belongs to.,
magenta/,60,"ex. NOTE_KEYS[0] lists all the major keys that contain the note C,",
magenta/,61,which are:,
magenta/,62,"[0, 1, 3, 5, 7, 8, 10]",
magenta/,63,"[C, C#, D#, F, G, G#, A#]",
magenta/,64,,
magenta/,65,0 = C,
magenta/,66,1 = C,
magenta/,67,2 = D,
magenta/,68,3 = D,
magenta/,69,4 = E,
magenta/,70,5 = F,
magenta/,71,6 = F,
magenta/,72,7 = G,
magenta/,73,8 = G,
magenta/,74,9 = A,
magenta/,75,10 = A,
magenta/,76,11 = B,
magenta/,77,,
magenta/,78,"NOTE_KEYS can be generated using the code below, but is explicitly declared",
magenta/,79,for readability:,
magenta/,80,NOTE_KEYS = [[j for j in range(12) if (i - j) % 12 in MAJOR_SCALE],
magenta/,81,for i in range(12)],
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,161,current note,
magenta/,162,note vs. silence,
magenta/,163,attack or not,
magenta/,164,ascending or not,
magenta/,165,whether note matches lookbacks,
magenta/,166,binary counters,
magenta/,167,start of bar or not,
magenta/,168,total key estimate,
magenta/,169,recent key estimate,
magenta/,231,The pitch of current note if a note is playing.,
magenta/,233,A note is playing.,
magenta/,236,Silence is playing.,
magenta/,240,The current event is the note-on event of the currently playing note.,
magenta/,245,Whether the melody is currently ascending or descending.,
magenta/,250,Last event is repeating N bars ago.,
magenta/,258,Binary time counter giving the metric location of the *next* note.,
magenta/,264,The next event is the start of a bar.,
magenta/,269,The keys the current melody is in.,
magenta/,277,The keys the last 3 notes are in.,
magenta/,313,If the last event repeated N bars ago.,
magenta/,321,If last event was a note-off event.,
magenta/,325,If last event was a no event.,
magenta/,329,"If last event was a note-on event, the pitch of that note.",
magenta/,343,Repeat N bars ago.,
magenta/,351,Note-off event.,
magenta/,355,No event:,
magenta/,359,Note-on event for that midi pitch.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,23,Shortcut to CHORD_SYMBOL annotation type.,
magenta/,50,Standard MusicXML fields.,
magenta/,58,Populate header.,
magenta/,61,Populate time signatures.,
magenta/,69,Populate key signatures.,
magenta/,74,The Key enum in music.proto does NOT follow MIDI / MusicXML specs,
magenta/,75,Convert from MIDI / MusicXML key to music.proto key,
magenta/,83,Populate tempo changes.,
magenta/,90,Populate notes from each MusicXML part across all voices,
magenta/,91,"Unlike MIDI import, notes are not sorted",
magenta/,108,Fix negative time errors from incorrect MusicXML,
magenta/,113,Index 1 = MIDI pitch number,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,35,pylint: disable=redefined-builtin,
magenta/,41,Shortcut to CHORD_SYMBOL annotation type.,
magenta/,150,Sort track by chord times.,
magenta/,160,No more chords within range.,
magenta/,164,Chord is before start of range.,
magenta/,171,"Identical coincident chords, just skip.",
magenta/,174,Two different chords start at the same time step.,
magenta/,180,Add the previous chord.,
magenta/,192,Add the last chord active before end_step.,
magenta/,367,Add a note.,
magenta/,377,Sort text annotations by time.,
magenta/,389,Render the previous chord.,
magenta/,403,Render the last chord.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,34,pylint: enable=g-import-not-at-top,
magenta/,36,Allow pretty_midi to read MIDI files with absurdly high tick rates.,
magenta/,37,Useful for reading the MAPS dataset.,
magenta/,38,https://github.com/craffel/pretty-midi/issues/112,
magenta/,41,The offset used to change the mode of a key from major to minor when,
magenta/,42,generating a PrettyMIDI KeySignature.,
magenta/,67,In practice many MIDI files cannot be decoded with pretty_midi. Catch all,
magenta/,68,errors here and try to log a meaningful message. So many different,
magenta/,69,exceptions are raised in pretty_midi.PrettyMidi that it is cumbersome to,
magenta/,70,catch them all only for the purpose of error logging.,
magenta/,71,pylint: disable=bare-except,
magenta/,80,pylint: enable=bare-except,
magenta/,84,Populate header.,
magenta/,90,Populate time signatures.,
magenta/,96,Denominator can be too large for int32.,
magenta/,102,Populate key signatures.,
magenta/,115,Populate tempo changes.,
magenta/,122,Populate notes by gathering them all from the midi's instruments.,
magenta/,123,Also set the sequence.total_time as the max end time in the notes.,
magenta/,128,Populate instrument name from the midi's instruments,
magenta/,174,TODO(douglaseck): Estimate note type (e.g. quarter note) and populate,
magenta/,175,note.numerator and note.denominator.,
magenta/,216,"Before copying the file, flush any contents",
magenta/,218,And back the file position to top (not need for Copy but for certainty),
magenta/,247,Try to find a tempo at time zero. The list is not guaranteed to be in order.,
magenta/,262,Create an empty instrument to contain time and key signatures.,
magenta/,266,Populate time signatures.,
magenta/,274,Populate key signatures.,
magenta/,285,Populate tempos.,
magenta/,286,TODO(douglaseck): Update this code if pretty_midi adds the ability to,
magenta/,287,write tempo.,
magenta/,289,Skip if this tempo was added in the PrettyMIDI constructor.,
magenta/,296,pylint: disable=protected-access,
magenta/,299,pylint: enable=protected-access,
magenta/,301,Populate instrument names by first creating an instrument map between,
magenta/,302,instrument index and name.,
magenta/,303,"Then, going over this map in the instrument event for loop",
magenta/,308,Populate instrument events by first gathering notes and other event types,
magenta/,309,in lists then write them sorted to the PrettyMidi object.,
magenta/,334,For instr_id 0 append to the instrument created above.,
magenta/,340,propagate instrument name to the midi file,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,29,pylint:disable=invalid-name,
magenta/,98,Make comparison easier,
magenta/,123,Make comparison easier,
magenta/,143,Add 5 more steps.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,56,pylint: disable=redefined-builtin,
magenta/,298,"In this case, softmax is a list of several sub-softmaxes, each",
magenta/,299,potentially with a different size.,
magenta/,300,"shape: [[beam_size, event_num, softmax_size]]",
magenta/,307,"In this case, softmax is just one softmax.",
magenta/,308,"shape: [beam_size, event_num, softmax_size]",
magenta/,500,current event,
magenta/,501,next event for each lookback,
magenta/,502,binary counters,
magenta/,503,whether event matches lookbacks,
magenta/,544,Last event.,
magenta/,549,Next event if repeating N positions ago.,
magenta/,560,Binary time counter giving the metric location of the *next* event.,
magenta/,566,Last event is repeating N bars ago.,
magenta/,610,If last step repeated N bars ago.,
magenta/,618,"If last step didn't repeat at one of the lookback positions, use the",
magenta/,619,specific event.,
magenta/,634,Repeat N bar ago.,
magenta/,642,Return the event for that class index.,
magenta/,934,The event sequence is a list of tuples where the first element is a,
magenta/,935,disable flag.,
magenta/,992,Apply all encoders to the event sequence.,
magenta/,996,The event sequence is a list of tuples. Apply each encoder to the,
magenta/,997,elements in the corresponding tuple position.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,49,LeadSheet transposition should agree with melody & chords transpositions.,
magenta/,66,LeadSheet squash should agree with melody squash & chords transpose.,
magenta/,83,Setting LeadSheet length should agree with setting length on melody and,
magenta/,84,chords separately.,
magenta/,102,Sequence produced from lead sheet should contain notes from melody,
magenta/,103,sequence and chords from chord sequence as text annotations.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,37,TODO(adarob): Replace with FarmHash when it becomes a part of TensorFlow.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,25,pylint: disable=redefined-builtin,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,Transpose ChordProgression with basic triads.,
magenta/,59,Transpose ChordProgression with more complex chords.,
magenta/,66,Transpose ChordProgression containing NO_CHORD.,
magenta/,74,Attempt to transpose ChordProgression with unknown chord symbol.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,22,Shortcut to text annotation types.,
magenta/,75,Assume false for this test method.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,33,Shortcut to CHORD_SYMBOL annotation type.,
magenta/,83,pylint:disable=invalid-name,
magenta/,154,Test time signature changes.,
magenta/,163,Test key signature changes.,
magenta/,174,The Key enum in music.proto does NOT follow MIDI / MusicXML specs,
magenta/,175,Convert from MIDI / MusicXML key to music.proto key,
magenta/,182,Test tempos.,
magenta/,192,Test parts/instruments.,
magenta/,218,Check that the duration specified in the MusicXML and the,
magenta/,219,duration float match to within +/- 1 (delta = 1),
magenta/,220,Delta is used because duration in MusicXML is always an integer,
magenta/,221,"For example, a 3:2 half note might have a durationfloat of 341.333",
magenta/,222,but would have the 1/3 distributed in the MusicXML as,
magenta/,223,"341.0, 341.0, 342.0.",
magenta/,224,Check that (3 * 341.333) = (341 + 341 + 342) is true by checking,
magenta/,225,that 341.0 and 342.0 are +/- 1 of 341.333,
magenta/,288,Convert MusicXML to NoteSequence,
magenta/,292,Check equality,
magenta/,467,One time signature per measure,
magenta/,951,Adjust for 120 QPM.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,This example archive contains a single file consisting of just a major,
magenta/,28,chord.,
magenta/,34,allow_pickle is required because the npz files contain intervaltrees.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,60,"Don't include 1/sqrt(N) scaling, tf.signal.rfft doesn't apply it.",
magenta/,66,"We are right-multiplying by the DFT matrix, and we are keeping",
magenta/,67,"only the first half (""positive frequencies"").",
magenta/,68,"So discard the second half of rows, but transpose the array for",
magenta/,69,right-multiplication.,
magenta/,70,"The DFT matrix is symmetric, so we could have done it more",
magenta/,71,"directly, but this reflects our intention better.",
magenta/,127,"Currently tflite's gather only supports axis==0, but that may still",
magenta/,128,work if we want the last of 1 axes.,
magenta/,131,pylint: disable=deprecated-method,
magenta/,148,"frame_selector is a [num_frames, subframes_per_frame] tensor",
magenta/,149,that indexes into the appropriate frame in subframes. For example:,
magenta/,150,"[[0, 0, 0, 0], [2, 2, 2, 2], [4, 4, 4, 4]]",
magenta/,154,"subframe_selector is a [num_frames, subframes_per_frame] tensor",
magenta/,155,that indexes into the appropriate subframe within a frame. For example:,
magenta/,156,"[[0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3]]",
magenta/,160,"Adding the 2 selector tensors together produces a [num_frames,",
magenta/,161,subframes_per_frame] tensor of indices to use with tf.gather to select,
magenta/,162,subframes from subframes. We then reshape the inner-most subframes_per_frame,
magenta/,163,dimension to stitch the subframes together into frames. For example:,
magenta/,164,"[[0, 1, 2, 3], [2, 3, 4, 5], [4, 5, 6, 7]].",
magenta/,193,"Make the window be shape (1, frame_length) instead of just frame_length",
magenta/,194,in an effort to help the tflite broadcast logic.,
magenta/,251,`waveform_input` is a [?] vector as a tensor.,
magenta/,252,"`magnitude_spectrogram` is a [?, fft_length/2 + 1] tensor of spectrograms.",
magenta/,253,Derive the dependent parameters.,
magenta/,265,"Warp the linear-scale, magnitude spectrograms into the mel-scale.",
magenta/,274,"In full tf, the mel weight matrix is calculated at run time within the",
magenta/,275,"TF graph.  This avoids including a matrix of 64 x 256 float values (i.e.,",
magenta/,276,"100 kB or more, depending on the representation) in the exported graph.",
magenta/,288,"log_mel_spectrogram is a [?, num_mel_bins] gram.",
magenta/,301,"features is [num_patches, frame_width, num_mel_bins].",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,164,Group all drum notes that start at the same step.,
magenta/,166,drums only,
magenta/,167,no zero-velocity notes,
magenta/,168,after start_step only,
magenta/,174,Sort by note start times.,
magenta/,189,"If a gap of `gap` or more steps is found, end the drum track.",
magenta/,191,pylint:disable=len-as-condition,
magenta/,194,"Add a drum event, a set of drum ""pitches"".",
magenta/,201,"If no drum events were added, don't set `_start_step` and `_end_step`.",
magenta/,207,Optionally round up `_end_step` to a multiple of `steps_per_bar`.,
magenta/,240,Add a note. All drum notes last a single step.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,26,pylint:disable=invalid-name,
magenta/,196,Make comparison easier by sorting.,
magenta/,212,Make comparison easier by sorting.,
magenta/,228,"Was not started, should be ignored.",
magenta/,239,Make comparison easier by sorting.,
magenta/,263,Make comparison easier by sorting.,
magenta/,289,Make comparison easier by sorting.,
magenta/,305,Make comparison easier by sorting.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,32,pylint: disable=redefined-builtin,
magenta/,35,Set the quantization cutoff.,
magenta/,36,Note events before this cutoff are rounded down to nearest step. Notes,
magenta/,37,above this cutoff are rounded up to nearest step. The cutoff is given as a,
magenta/,38,fraction of a step.,
magenta/,39,"For example, with quantize_cutoff = 0.75 using 0-based indexing,",
magenta/,40,"if .75 < event <= 1.75, it will be quantized to step 1.",
magenta/,41,If 1.75 < event <= 2.75 it will be quantized to step 2.,
magenta/,42,"A number close to 1.0 gives less wiggle room for notes that start early,",
magenta/,43,and they will be snapped to the previous step.,
magenta/,46,Shortcut to text annotation types.,
magenta/,51,The amount to upweight note-on events vs note-off events.,
magenta/,54,The size of the frame extension for onset event.,
magenta/,55,"Frames in [onset_frame-ONSET_WINDOW, onset_frame+ONSET_WINDOW]",
magenta/,56,are considered to contain onset events.,
magenta/,132,sustain,
magenta/,133,sostenuto,
magenta/,134,una corda,
magenta/,194,Extract notes into subsequences.,
magenta/,215,"Extract time signatures, key signatures, tempos, and chord changes (beats",
magenta/,216,"are handled below, other text annotations and pitch bends are deleted).",
magenta/,217,Additional state events will be added to the beginning of each subsequence.,
magenta/,244,Add state event to the beginning of the subsequence.,
magenta/,249,Only add the event if it's actually inside the subsequence (and not on,
magenta/,250,the boundary with the next one).,
magenta/,255,Add final state event to the beginning of all remaining subsequences.,
magenta/,262,"Copy stateless events to subsequences. Unlike the stateful events above,",
magenta/,263,stateless events do not have an effect outside of the subsequence in which,
magenta/,264,they occur.,
magenta/,284,Extract piano pedal events (other control changes are deleted). Pedal state,
magenta/,285,is maintained per-instrument and added to the beginning of each,
magenta/,286,subsequence.,
magenta/,303,Add the current pedal pedal state to the beginning of the subsequence.,
magenta/,310,Only add the pedal event if it's actually inside the subsequence (and,
magenta/,311,not on the boundary with the next one).,
magenta/,318,Add final pedal pedal state to the beginning of all remaining,
magenta/,319,subsequences.,
magenta/,327,Set subsequence info for all subsequences.,
magenta/,403,Delete subsequence_info because our frame of reference has shifted.,
magenta/,406,Shift notes.,
magenta/,451,"If the only difference between the two events is time, then delete the",
magenta/,452,second one.,
magenta/,457,"Add composers and genres, preserving order, but dropping duplicates.",
magenta/,520,Delete subsequence_info because we've joined several subsequences.,
magenta/,545,Not relevant in this case.,
magenta/,574,"This is a subsequence, so the section_groups no longer make sense.",
magenta/,576,This subsequence contains only 1 section and it has been shifted to time,
magenta/,577,0.,
magenta/,584,Recursively expand section_groups.,
magenta/,617,If the QuantizationInfo message has a non-zero steps_per_quarter or,
magenta/,618,"steps_per_second, assume that the proto has been quantized.",
magenta/,632,"If the QuantizationInfo message has a non-zero steps_per_quarter, assume",
magenta/,633,that the proto has been quantized relative to tempo.,
magenta/,646,"If the QuantizationInfo message has a non-zero steps_per_second, assume",
magenta/,647,that the proto has been quantized by absolute time.,
magenta/,758,Update notes crossing potential split.,
magenta/,770,Handle the final subsequence.,
magenta/,821,Time signature didn't actually change.,
magenta/,825,Tempo didn't actually change.,
magenta/,828,Update notes crossing potential split.,
magenta/,842,"Even if we didn't split here, update the current time signature or tempo.",
magenta/,849,Handle the final subsequence.,
magenta/,937,Quantize the start and end times of the note.,
magenta/,944,Do not allow notes to start or end in negative time.,
magenta/,950,Extend quantized sequence if necessary.,
magenta/,954,Also quantize control changes and text annotations.,
magenta/,957,"Quantize the event time, disallowing negative time.",
magenta/,998,There is an implicit 4/4 time signature at 0 time. So if the first time,
magenta/,999,"signature is something other than 4/4 and it's at a time other than 0,",
magenta/,1000,that's an implicit time signature change.,
magenta/,1020,Make it clear that there is only 1 time signature and it starts at the,
magenta/,1021,beginning.,
magenta/,1042,There is an implicit 120.0 qpm tempo at 0 time. So if the first tempo is,
magenta/,1043,"something other that 120.0 and it's at a time other than 0, that's an",
magenta/,1044,implicit tempo change.,
magenta/,1058,Make it clear that there is only 1 tempo and it starts at the beginning.,
magenta/,1066,Compute quantization steps per second.,
magenta/,1152,"The pitch name, if present, will no longer be valid.",
magenta/,1163,"Since notes were deleted, we may need to update the total time.",
magenta/,1167,Also update the chord symbol text annotations. This can raise a,
magenta/,1168,ChordSymbolError if a chord symbol cannot be interpreted.,
magenta/,1173,Remove chord symbol text annotations.,
magenta/,1182,Also transpose key signatures.,
magenta/,1258,Choose random factor by which to stretch or compress note sequence.,
magenta/,1262,Choose amount by which to translate the note sequence.,
magenta/,1264,"If transposition takes a note outside of the allowed note bounds,",
magenta/,1265,we will just delete it.,
magenta/,1268,Prevent transposition from taking a note outside of the allowed note,
magenta/,1269,bounds by clamping the range we sample from.,
magenta/,1331,Stretch all notes.,
magenta/,1337,Stretch all other event times.,
magenta/,1345,Stretch tempos.,
magenta/,1384,Iterate through the original NoteSequence notes to make it easier to drop,
magenta/,1385,skipped notes from the adjusted NoteSequence.,
magenta/,1449,Adjusting tempos to accommodate arbitrary time adjustments is too,
magenta/,1450,complicated. Just delete them.,
magenta/,1486,Add a beat at the very beginning and end of the sequence and dedupe.,
magenta/,1494,Use linear interpolation to map original times to rectified times.,
magenta/,1503,Sequence probably shouldn't have time signatures but delete them just to be,
magenta/,1504,"sure, and add a single tempo.",
magenta/,1512,Constants for processing the note/sustain stream.,
magenta/,1513,The order here matters because we we want to process 'on' events before we,
magenta/,1514,"process 'off' events, and we want to process sustain events before note",
magenta/,1515,events.,
magenta/,1554,Sort all note on/off and sustain on/off events.,
magenta/,1573,"Sort, using the time and event type constants to ensure the order events are",
magenta/,1574,processed.,
magenta/,1577,"Lists of active notes, keyed by instrument.",
magenta/,1579,Whether sustain is active for a given instrument.,
magenta/,1582,Iterate through all sustain on/off and note on/off events in order.,
magenta/,1589,End all notes for the instrument that were being extended.,
magenta/,1593,This note was being extended because of sustain.,
magenta/,1594,Update the end time and don't keep it in the list.,
magenta/,1599,"This note is actually still active, keep it.",
magenta/,1604,"If sustain is on, end all previous notes with the same pitch.",
magenta/,1610,This note now has no duration because another note of the same,
magenta/,1611,pitch started at the same time. Only one of these notes should,
magenta/,1612,"be preserved, so delete this one.",
magenta/,1613,TODO(fjord): A more correct solution would probably be to,
magenta/,1614,"preserve both notes and make the same duration, but that is a",
magenta/,1615,little more complicated to implement. Will keep this solution,
magenta/,1616,until we find that we need the more complex one.,
magenta/,1621,Add this new note to the list of active notes.,
magenta/,1625,Note continues until another note of the same pitch or sustain ends.,
magenta/,1628,Remove this particular note from the active list.,
magenta/,1629,It may have already been removed if a note of the same pitch was,
magenta/,1630,played when sustain was active.,
magenta/,1636,End any notes that were still active due to sustain.,
magenta/,1680,"If the sequence is quantized, use quantized steps instead of time.",
magenta/,1688,Sort all note start and end events.,
magenta/,1705,Infer a chord symbol for the active pitches.,
magenta/,1709,Add a text annotation to the sequence.,
magenta/,1731,pylint:disable=invalid-name,
magenta/,1742,pylint: disable=unused-argument,
magenta/,1744,pylint: enable=unused-argument,
magenta/,1812,Will round down because note may start or end in the middle of the frame.,
magenta/,1815,check for > 0.0 to avoid possible numerical issues,
magenta/,1826,Ensure that every note fills at least one frame.,
magenta/,1839,label onset events. Use a window size of onset_window to account of,
magenta/,1840,rounding issue in the start_frame computation.,
magenta/,1859,label offset events.,
magenta/,1971,Add silent frame at the end so we can do a final loop and terminate any,
magenta/,1972,notes that are still active.,
magenta/,1978,Ensure that any frame with an onset prediction is considered active.,
magenta/,1984,"If the frame and offset are both on, then turn it off",
magenta/,2007,"If onset predictions were supplied, only allow a new note to start",
magenta/,2008,if we've predicted an onset.,
magenta/,2019,"Even though the frame is active, the onset predictor doesn't",
magenta/,2020,"say there should be an onset, so ignore it.",
magenta/,2026,"pitch is already active, but if this is a new onset, we should end",
magenta/,2027,the note and start a new one.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,81,C,
magenta/,82,Dm,
magenta/,83,F,
magenta/,84,G,
magenta/,99,C,
magenta/,100,Dm,
magenta/,101,F,
magenta/,102,G,
magenta/,103,F,
magenta/,104,G#m,
magenta/,105,B,
magenta/,106,C,
magenta/,121,C,
magenta/,122,Dm,
magenta/,123,F,
magenta/,124,G,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,Max piano pitch.,
magenta/,29,Min piano pitch.,
magenta/,112,Then trim or pad as needed.,
magenta/,245,Keep a dictionary of open notes for each pitch.,
magenta/,265,pylint: disable=g-explicit-length-test,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,36,pylint:disable=invalid-name,
magenta/,50,Compare section annotations and groups before expanding.,
magenta/,61,"abc2midi adds a 1-tick delay to the start of every note, but we don't.",
magenta/,66,"For now, don't compare velocities.",
magenta/,77,"We've checked the notes and time signatures, now compare the rest of the",
magenta/,78,proto to the expected proto.,
magenta/,87,Most examples taken from,
magenta/,88,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,174,Most examples taken from,
magenta/,175,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,183,Most examples taken from,
magenta/,184,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,310,TODO(fjord): re-enable once we support variant endings.,
magenta/,311,expected_ns2_metadata = testing_lib.parse_test_proto(,
magenta/,312,"music_pb2.NoteSequence,",
magenta/,313,"""""""",
magenta/,314,ticks_per_quarter: 220,
magenta/,315,source_info: {,
magenta/,316,source_type: SCORE_BASED,
magenta/,317,encoding_type: ABC,
magenta/,318,parser: MAGENTA_ABC,
magenta/,319,},
magenta/,320,reference_number: 2,
magenta/,321,sequence_metadata {,
magenta/,322,"title: ""Old Sir Simon the King""",
magenta/,323,"artist: ""Trad.""",
magenta/,324,"composers: ""Trad.""",
magenta/,325,},
magenta/,326,key_signatures {,
magenta/,327,key: G,
magenta/,328,},
magenta/,329,""""""")",
magenta/,330,self.compare_to_abc2midi_and_metadata(,
magenta/,331,"'testdata/english2.mid', expected_ns2_metadata, tunes[1])",
magenta/,333,TODO(fjord): re-enable once we support parts.,
magenta/,334,expected_ns3_metadata = testing_lib.parse_test_proto(,
magenta/,335,"music_pb2.NoteSequence,",
magenta/,336,"""""""",
magenta/,337,ticks_per_quarter: 220,
magenta/,338,source_info: {,
magenta/,339,source_type: SCORE_BASED,
magenta/,340,encoding_type: ABC,
magenta/,341,parser: MAGENTA_ABC,
magenta/,342,},
magenta/,343,reference_number: 3,
magenta/,344,sequence_metadata {,
magenta/,345,"title: ""William and Nancy; New Mown Hay; Legacy, The""",
magenta/,346,"artist: ""Trad.""",
magenta/,347,"composers: ""Trad.""",
magenta/,348,},
magenta/,349,key_signatures {,
magenta/,350,key: G,
magenta/,351,},
magenta/,352,""""""")",
magenta/,353,# TODO(fjord): verify chord annotations,
magenta/,354,del tunes[3].text_annotations[:],
magenta/,355,self.compare_to_abc2midi_and_metadata(,
magenta/,356,"'testdata/english3.mid', expected_ns3_metadata, tunes[3])",
magenta/,413,Examples from http://abcnotation.com/wiki/abc:standard:v2.1#qtempo,
magenta/,471,These tunes should be equivalent.,
magenta/,631,Several equivalent versions of the same tune.,
magenta/,781,Other versions are identical except for the reference number.,
magenta/,790,"Also identical, except the last section is played only twice.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,39,No drums should encode to zero.,
magenta/,43,"Single drum should encode to single bit active, different for different",
magenta/,44,drum types.,
magenta/,51,"Multiple drums should encode to multiple bits active, one for each drum",
magenta/,52,type.,
magenta/,59,Zero should decode to no drums.,
magenta/,63,"Single bit active should encode to single drum, different for different",
magenta/,64,bits.,
magenta/,74,Multiple bits active should encode to multiple drums.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,pylint: disable=redefined-builtin,
magenta/,118,Replace MELODY_NOTE_OFF events with MELODY_NO_EVENT before first note.,
magenta/,294,"Sort track by note start times, and secondarily by pitch descending.",
magenta/,303,"The first step in the melody, beginning at the first step of a bar.",
magenta/,311,Ignore 0 velocity notes.,
magenta/,319,"If there are no events, we don't need to check for polyphony.",
magenta/,323,If `start_index` comes before or lands on an already added note's start,
magenta/,324,"step, we cannot add it. In that case either discard the melody or keep",
magenta/,325,the highest pitch.,
magenta/,331,Keep highest note.,
magenta/,332,"Notes are sorted by pitch descending, so if a note is already at",
magenta/,333,this position its the highest pitch.,
magenta/,342,"If a gap of `gap` or more steps is found, end the melody.",
magenta/,343,pylint:disable=len-as-condition,
magenta/,346,Add the note-on and off events to the melody.,
magenta/,350,"If no notes were added, don't set `_start_step` and `_end_step`.",
magenta/,355,Strip final MELODY_NOTE_OFF event.,
magenta/,360,Optionally round up `_end_step` to a multiple of `steps_per_bar`.,
magenta/,397,End any sustained notes.,
magenta/,402,Add a note.,
magenta/,412,End any sustained notes.,
magenta/,418,End any sustained notes.,
magenta/,441,Transpose MIDI pitches. Special events below MIN_MIDI_PITCH are not,
magenta/,442,changed.,
magenta/,504,"When extending the melody on the right, we end any sustained notes.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,34,major triad,
magenta/,38,minor triad,
magenta/,42,dominant 7th,
magenta/,46,minor 9th,
magenta/,51,suspended chord,
magenta/,55,power chord,
magenta/,64,major chord,
magenta/,68,minor chord,
magenta/,83,major triad,
magenta/,87,minor triad,
magenta/,91,augmented triad,
magenta/,95,diminished triad,
magenta/,100,suspended chord,
magenta/,104,power chord,
magenta/,113,major chord,
magenta/,117,minor chord,
magenta/,121,augmented chord,
magenta/,125,diminished chord,
magenta/,143,major triad,
magenta/,151,minor triad,
magenta/,159,major triad with dominant 7th in bass,
magenta/,167,13th chord,
magenta/,175,minor triad with major 7th,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,115,The following are true only for semitone_steps = 1.,
magenta/,136,The following are true only for semitone_steps = 1.,
magenta/,158,The following are true only for semitone_steps = 1.,
magenta/,159,100,
magenta/,176,The following are true only for semitone_steps = 1.,
magenta/,177,16,
magenta/,224,expected_encoded_modulo_event is of the following form:,
magenta/,225,"(offset, encoder_width, event_type, value, bins)",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,19,"Default list of 9 drum types, where each type is represented by a list of",
magenta/,20,MIDI pitches for drum sounds belonging to that type. This default list,
magenta/,21,attempts to map all GM1 and GM2 drums onto a much smaller standard drum kit,
magenta/,22,based on drum sound and function.,
magenta/,24,kick drum,
magenta/,27,snare drum,
magenta/,30,closed hi-hat,
magenta/,33,open hi-hat,
magenta/,36,low tom,
magenta/,39,mid tom,
magenta/,42,high tom,
magenta/,45,crash cymbal,
magenta/,48,ride cymbal,
magenta/,107,"Use the first ""pitch"" for each drum type.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,39,Used for ephemeral colab_play.,
magenta/,56,"pylint:disable=g-import-not-at-top,protected-accessk,import-error",
magenta/,104,"pylint: disable=unused-import,unused-variable,g-import-not-at-top",
magenta/,141,"If no velocity differences are found, set alpha to 1.0.",
magenta/,147,"These are hard-coded reasonable values, but the user can override them",
magenta/,148,by updating the figure if need be.,
magenta/,157,Pick indexes that are maximally different in Spectral8 colormap.,
magenta/,160,Create a Pandas dataframe and group it by instrument.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,23,pylint: disable=g-direct-tensorflow-import,
magenta/,34,We make this a class method so we can keep it close to Verify...,
magenta/,35,self is unused.,
magenta/,38,Exactly 96 frames at 25 ms / 10 ms.,
magenta/,43,Exponential frequency sweep.,
magenta/,48,Raised cosine envelope.,
magenta/,50,Final test waveform.,
magenta/,53,We make this a class method so it can use the TestCase assert methods.,
magenta/,59,Expect peak magnitude to be somewhere near expected_time_steps/2 == 48,
magenta/,60,(due to raised cosine envelope.)  It isn't *exactly* in the middle because,
magenta/,61,the interaction between the sweeping tone and the mel bands causes some,
magenta/,62,ripple atop the columnwise max.  The peok is actually at frame 43.,
magenta/,66,"Expect peak frequencies to move up with sweep.  These are ""golden"",",
magenta/,67,but agree with predictions from instantaneous frequencies and mel scale.,
magenta/,75,tflite requires explicit input sizing.,
magenta/,81,This is the single function provided by the library.,
magenta/,100,Initialize TensorFlow.,
magenta/,107,Only one patch returned.,
magenta/,115,"Results don't match to 6 decimals, 1 is OK.",
magenta/,116,TODO(fjord): Eventually switch to implementation that has fewer,
magenta/,117,differences.,
magenta/,122,Attempt to run the tflite-style conversion to the current graph.,
magenta/,157,"Graph is now built in the current session, ready for tflite conversion.",
magenta/,159,Run the tflite model with the tflite interpreter.,
magenta/,161,"Be satisfied with 1 d.p. (i.e., 2 sf) agreement.",
magenta/,162,"At 2 d.p., we got 0.07% disagreement, probably just 1 value.)",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,136,"The previous event didn't move us forward in time, so the note density",
magenta/,137,here should be the same.,
magenta/,146,Count the number of note-on events within the window.,
magenta/,154,"If we're near the end of the performance, part of the window will",
magenta/,155,necessarily be empty; we don't include this part of the window when,
magenta/,156,calculating note density.,
magenta/,263,Maintain the base set of active pitches.,
magenta/,271,"The previous event didn't move us forward in time, so the histogram",
magenta/,272,here should be the same.,
magenta/,283,Count the total duration of each pitch class within the window.,
magenta/,319,Normalize by the total weight.,
magenta/,333,List of performance control signal classes.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,26,Constants.,
magenta/,33,Shortcut to CHORD_SYMBOL annotation type.,
magenta/,202,"A little ugly, but just add the chord annotations to the melody sequence.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,29,Parallel dsp/mfcc:mel_spectrum_test.,
magenta/,47,"Lower edge must be >= 0, but 0 is OK.",
magenta/,61,"Upper edge must be <= Nyquist, but Nyquist is OK.",
magenta/,75,Must be a positive gap between edges.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,40,Sort note intervals by onset time.,
magenta/,44,"MusicNet represents ""instruments"" as MIDI program numbers. Here we map each",
magenta/,45,program to a separate MIDI instrument.,
magenta/,56,"MusicNet ""instrument"" numbers use 1-based indexing, so we subtract 1 here.",
magenta/,86,Unfortunately the gfile seek function breaks the reading of NumPy,
magenta/,87,"archives, so we read the archive first then load as BytesIO.",
magenta/,90,allow_pickle is required because the npz files contain intervaltrees.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,Test basic triads.,
magenta/,42,Test more complex chords.,
magenta/,55,Test basic triads.,
magenta/,69,Test basic inversions.,
magenta/,77,Test suspended chords.,
magenta/,88,Test more complex chords.,
magenta/,99,Test chords with modifications.,
magenta/,113,Test invalid chord.,
magenta/,167,Test major chords.,
magenta/,179,Test minor chords.,
magenta/,191,Test augmented chords.,
magenta/,201,Test diminished chords.,
magenta/,211,Test other chords.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,"Number of floats used to encode NOTE_ON and NOTE_OFF events, using modulo-12",
magenta/,28,"encoding. 5 floats for: valid, octave_cos, octave_sin, note_cos, note_sin.",
magenta/,31,Number of floats used to encode TIME_SHIFT and VELOCITY events using,
magenta/,32,"module-bins encoding. 3 floats for: valid, event_cos, event_sin.",
magenta/,67,Create a lookup table for modulo-12 encoding of pitch classes.,
magenta/,68,Possible values for semitone_steps are 1 and 7. A value of 1 corresponds,
magenta/,69,to placing notes consecutively on the unit circle. A value of 7,
magenta/,70,corresponds to following each note with one that is 7 semitones above it.,
magenta/,71,"semitone_steps = 1 seems to produce better results, and is the recommended",
magenta/,72,"value. Moreover, unit tests are provided only for semitone_steps = 1. If",
magenta/,73,"in the future you plan to enable support for semitone_steps = 7, then",
magenta/,74,"please make semitone_steps a parameter of this method, and add unit tests",
magenta/,75,for it.,
magenta/,83,Create a lookup table for modulo-144 encoding of notes. Encode each note,
magenta/,84,"on a unit circle of 144 notes, spanning 12 octaves. Since there are only",
magenta/,85,"128 midi notes, the last 16 positions on the unit circle will not be used.",
magenta/,91,Create a lookup table for modulo-bins encoding of time_shifts.,
magenta/,97,Create a lookup table for modulo-bins encoding of velocities.,
magenta/,193,valid bit for the event,
magenta/,198,"Encode the note on a circle of 144 notes, covering 12 octaves.",
magenta/,204,"Encode the note's pitch class, using the encoder's lookup table.",
magenta/,210,"This must be a velocity, or a time-shift event. Encode it using",
magenta/,211,modulo-bins embedding.,
magenta/,337,Add 1 because we need to represent 0 time shifts.,
magenta/,350,TIME_SHIFT major,
magenta/,352,TIME_SHIFT minor,
magenta/,354,NOTE_ON,
magenta/,356,VELOCITY,
magenta/,358,DURATION major,
magenta/,360,DURATION minor,
magenta/,404,"Don't need to represent 0 duration, so subtract 1.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,51,Start of a new note.,
magenta/,53,End of a note.,
magenta/,55,Shift time forward.,
magenta/,57,Change current velocity.,
magenta/,59,Duration of preceding NOTE_ON.,
magenta/,60,"For Note-based encoding, used instead of NOTE_OFF events.",
magenta/,66,This checks the whole object.,
magenta/,116,Only set program for non-drum tracks.,
magenta/,185,Last event is already non-maximal time shift. Increase its duration.,
magenta/,351,Sort all note start and end events.,
magenta/,364,Shift time forward from the current step to this event.,
magenta/,366,We need to move further than the maximum shift size.,
magenta/,376,If we're using velocity and this note's velocity is different from the,
magenta/,377,"current velocity, change the current velocity.",
magenta/,387,Add a performance event for this note on/off.,
magenta/,426,Use program associated with the performance (or default program).,
magenta/,430,Map pitch to list because one pitch may be active multiple times.,
magenta/,441,Create a note for the pitch that is now ending.,
magenta/,473,There could be remaining pitches that were never ended. End them now,
magenta/,474,and create notes.,
magenta/,749,"This is not actually implemented, but to avoid raising exceptions during",
magenta/,750,generation just return instead of raising NotImplementedError.,
magenta/,751,TODO(fjord): Implement this.,
magenta/,832,TIME_SHIFT,
magenta/,843,NOTE_ON,
magenta/,848,VELOCITY,
magenta/,854,DURATION,
magenta/,889,Use program associated with the performance (or default program).,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,pylint: disable=redefined-builtin,
magenta/,88,'r' mode will decode the file as utf-8 in py3.,
magenta/,106,Split tunebook into sections based on empty lines.,
magenta/,120,"If there are multiple sections, the first one may be a header.",
magenta/,121,The first section is a header if it does not contain an X information field.,
magenta/,132,"The header sets default values for each tune, so prepend it to every",
magenta/,133,tune that is being parsed.,
magenta/,151,http://abcnotation.com/wiki/abc:standard:v2.1#decorations,
magenta/,165,http://abcnotation.com/wiki/abc:standard:v2.1#pitch,
magenta/,183,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,234,Standard ABC fields.,
magenta/,249,Default dynamic should be !mf! as per:,
magenta/,250,http://abcnotation.com/wiki/abc:standard:v2.1#decorations,
magenta/,257,Strip comments.,
magenta/,258,Strip whitespace.,
magenta/,262,"If the lines begins with a letter and a colon, it's an information",
magenta/,263,field. Extract it.,
magenta/,302,"No QPM has been specified, so will use the default one.",
magenta/,306,"Set unit note length. May depend on the current meter, so this has to be",
magenta/,307,calculated at the end of the header.,
magenta/,310,Set the tempo if it was specified in the header. May depend on current,
magenta/,311,"unit note length, so has to be calculated after that is set.",
magenta/,312,"_header_tempo_unit may be legitimately None, so check _header_tempo_rate.",
magenta/,324,http://abcnotation.com/wiki/abc:standard:v2.1#lunit_note_length,
magenta/,327,"If it has been set explicitly, leave it as is.",
magenta/,330,"For free meter, the default unit note length is 1/8.",
magenta/,333,"Otherwise, base it on the current meter.",
magenta/,365,"We're in a piece with sections, need to add a section marker at the",
magenta/,366,beginning of the piece if there isn't one there already.,
magenta/,391,"If we're still expecting a repeat at the end of the tune, that's an error",
magenta/,392,in the file.,
magenta/,399,"If a new section was started at the very end of the piece, delete it",
magenta/,400,because it will contain no notes and is meaningless.,
magenta/,401,This happens if the last line in the piece ends with a :| symbol. A new,
magenta/,402,"section is set up to handle upcoming notes, but then the end of the piece",
magenta/,403,is reached.,
magenta/,408,Make sure the final section annotation is referenced in a section group.,
magenta/,409,"If it hasn't been referenced yet, it just needs to be played once.",
magenta/,410,This checks that the final section_annotation is referenced in the final,
magenta/,411,section_group.,
magenta/,412,"At this point, all of our section_groups have only 1 section, so this",
magenta/,413,logic will need to be updated when we support parts and start creating,
magenta/,414,more complex section_groups.,
magenta/,425,http://abcnotation.com/wiki/abc:standard:v2.1#broken_rhythm,
magenta/,450,http://abcnotation.com/wiki/abc:standard:v2.1#pitch,
magenta/,454,http://abcnotation.com/wiki/abc:standard:v2.1#chords_and_unisons,
magenta/,457,http://abcnotation.com/wiki/abc:standard:v2.1#broken_rhythm,
magenta/,460,http://abcnotation.com/wiki/abc:standard:v2.1#use_of_fields_within_the_tune_body,
magenta/,463,http://abcnotation.com/wiki/abc:standard:v2.1#repeat_bar_symbols,
magenta/,465,Pattern for matching variant endings with an associated bar symbol.,
magenta/,467,Pattern for matching repeat symbols with an associated bar symbol.,
magenta/,469,Pattern for matching repeat symbols without an associated bar symbol.,
magenta/,472,http://abcnotation.com/wiki/abc:standard:v2.1#chord_symbols,
magenta/,473,http://abcnotation.com/wiki/abc:standard:v2.1#annotations,
magenta/,476,http://abcnotation.com/wiki/abc:standard:v2.1#decorations,
magenta/,479,http://abcnotation.com/wiki/abc:standard:v2.1#ties_and_slurs,
magenta/,480,"Either an opening parenthesis (not followed by a digit, since that indicates",
magenta/,481,a tuplet) or a closing parenthesis.,
magenta/,485,http://abcnotation.com/wiki/abc:standard:v2.1#duplets_triplets_quadruplets_etc,
magenta/,488,http://abcnotation.com/wiki/abc:standard:v2.1#typesetting_line-breaks,
magenta/,494,http://abcnotation.com/wiki/abc:standard:v2.1#the_tune_body,
magenta/,533,Accidentals,
magenta/,551,"No accidentals, so modify according to current key.",
magenta/,554,Octaves,
magenta/,568,Note length,
magenta/,570,http://abcnotation.com/wiki/abc:standard:v2.1#note_lengths,
magenta/,574,Handle A// shorthand case.,
magenta/,580,"If no denominator is specified (e.g., ""3/""), default to 2.",
magenta/,590,Advance clock based on note length.,
magenta/,620,"We're in a new bar, so clear the bar-wise accidentals.",
magenta/,626,This is a double bar that isn't a repeat.,
magenta/,628,There was no previous forward repeat symbol.,
magenta/,629,Add a new section so that if there is a backward repeat later,
magenta/,630,"on, it will repeat to this bar.",
magenta/,638,"If this isn't a repeat, no additional work to do.",
magenta/,641,Count colons on either side.,
magenta/,661,"A repeat implies the start of a new section, so make one.",
magenta/,673,"There were not backward repeats, but we still want to play the",
magenta/,674,previous section once.,
magenta/,675,If new_section_id is None (implying that a section at the current,
magenta/,676,"time was created elsewhere), this is not needed because it should",
magenta/,677,have been done when the section was created.,
magenta/,685,Text annotation,
magenta/,686,http://abcnotation.com/wiki/abc:standard:v2.1#chord_symbols,
magenta/,687,http://abcnotation.com/wiki/abc:standard:v2.1#annotations,
magenta/,693,http://abcnotation.com/wiki/abc:standard:v2.1#chord_symbols,
magenta/,700,http://abcnotation.com/wiki/abc:standard:v2.1#decorations,
magenta/,701,We don't currently do anything with decorations.,
magenta/,704,http://abcnotation.com/wiki/abc:standard:v2.1#ties_and_slurs,
magenta/,705,We don't currently do anything with slurs.,
magenta/,708,http://abcnotation.com/wiki/abc:standard:v2.1#ties_and_slurs,
magenta/,709,We don't currently do anything with ties.,
magenta/,710,"TODO(fjord): Ideally, we would extend the duration of the previous",
magenta/,711,note to include the duration of the next note.,
magenta/,716,http://abcnotation.com/wiki/abc:standard:v2.1#typesetting_line-breaks,
magenta/,717,"Line continuations are only for typesetting, so we can ignore them.",
magenta/,722,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,728,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,735,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,742,Shorten the mode to be at most 3 letters long.,
magenta/,745,"""Minor"" and ""Aeolian"" are special cases that are abbreviated to 'm'.",
magenta/,746,"""Major"" and ""Ionian"" are special cases that are abbreviated to ''.",
magenta/,756,pylint: disable=g-explicit-bool-comparison,
magenta/,773,Match the rest of the string for possible modifications.,
magenta/,777,Only explicit accidentals will be used.,
magenta/,804,http://abcnotation.com/wiki/abc:standard:v2.1#outdated_information_field_syntax,
magenta/,805,This syntax is deprecated but must still be supported.,
magenta/,808,http://abcnotation.com/wiki/abc:standard:v2.1#qtempo,
magenta/,814,http://abcnotation.com/wiki/abc:standard:v2.1#information_fields,
magenta/,820,Composer,
magenta/,821,http://abcnotation.com/wiki/abc:standard:v2.1#ccomposer,
magenta/,824,The first composer will be set as the primary artist.,
magenta/,838,Key,
magenta/,839,http://abcnotation.com/wiki/abc:standard:v2.1#kkey,
magenta/,847,Unit note length,
magenta/,848,http://abcnotation.com/wiki/abc:standard:v2.1#lunit_note_length,
magenta/,851,Handle the case of L:1 being equivalent to L:1/1,
magenta/,864,Meter,
magenta/,865,http://abcnotation.com/wiki/abc:standard:v2.1#mmeter,
magenta/,899,TODO(fjord): implement part parsing.,
magenta/,902,Tempo,
magenta/,903,http://abcnotation.com/wiki/abc:standard:v2.1#qtempo,
magenta/,916,http://abcnotation.com/wiki/abc:standard:v2.1#outdated_information_field_syntax,
magenta/,917,"In the deprecated syntax, the tempo is interpreted based on the unit",
magenta/,918,"note length, which is potentially dependent on the current meter.",
magenta/,919,"Set tempo_unit to None for now, and the current unit note length will",
magenta/,920,be filled in later.,
magenta/,932,"If we're in the header, save these until we've finished parsing the",
magenta/,933,header. The deprecated syntax relies on the unit note length and,
magenta/,934,"meter, which may not be set yet. At the end of the header, we'll fill",
magenta/,935,in the necessary information and add these.,
magenta/,949,Title,
magenta/,950,http://abcnotation.com/wiki/abc:standard:v2.1#ttune_title,
magenta/,953,"TODO(fjord): Non-header titles are used to name parts of tunes, but",
magenta/,954,NoteSequence doesn't currently have any place to put that information.,
magenta/,959,"If there are multiple titles, separate them with semicolons.",
magenta/,974,Reference number,
magenta/,975,http://abcnotation.com/wiki/abc:standard:v2.1#xreference_number,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,39,pylint: disable=wildcard-import,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,32,self.midi_simple_filename contains a c-major scale of 8 quarter notes each,
magenta/,33,with a sustain of .95 of the entire note. Here are the first two notes dumped,
magenta/,34,using mididump.py:,
magenta/,35,"midi.NoteOnEvent(tick=0, channel=0, data=[60, 100]),",
magenta/,36,"midi.NoteOnEvent(tick=209, channel=0, data=[60, 0]),",
magenta/,37,"midi.NoteOnEvent(tick=11, channel=0, data=[62, 100]),",
magenta/,38,"midi.NoteOnEvent(tick=209, channel=0, data=[62, 0]),",
magenta/,43,self.midi_complex_filename contains many instruments including percussion as,
magenta/,44,well as control change and pitch bend events.,
magenta/,46,"self.midi_is_drum_filename contains 41 tracks, two of which are on channel 9.",
magenta/,48,self.midi_event_order_filename contains notes ordered,
magenta/,49,non-monotonically by pitch.  Here are relevent events as printed by,
magenta/,50,mididump.py:,
magenta/,51,"midi.NoteOnEvent(tick=0, channel=0, data=[1, 100]),",
magenta/,52,"midi.NoteOnEvent(tick=0, channel=0, data=[3, 100]),",
magenta/,53,"midi.NoteOnEvent(tick=0, channel=0, data=[2, 100]),",
magenta/,54,"midi.NoteOnEvent(tick=4400, channel=0, data=[3, 0]),",
magenta/,55,"midi.NoteOnEvent(tick=0, channel=0, data=[1, 0]),",
magenta/,56,"midi.NoteOnEvent(tick=0, channel=0, data=[2, 0]),",
magenta/,81,Test time signature changes.,
magenta/,90,Test key signature changes.,
magenta/,99,Test tempos.,
magenta/,110,Test instruments.,
magenta/,173,TODO(deck): The input MIDI file is opened in pretty-midi and,
magenta/,174,"re-written to a temp file, sanitizing the MIDI data (reordering",
magenta/,175,"note ons, etc). Issue 85 in the pretty-midi GitHub",
magenta/,176,(http://github.com/craffel/pretty-midi/issues/85) requests that,
magenta/,177,this sanitization be available outside of the context of a file,
magenta/,178,"write. If that is implemented, this rewrite code should be",
magenta/,179,modified or deleted.,
magenta/,181,"When writing to the temp file, use the file object itself instead of",
magenta/,182,file.name to avoid the permission error on Windows.,
magenta/,185,Use file object,
magenta/,186,Back the file position to top to reload the rewrite_file,
magenta/,188,Use file object,
magenta/,191,Translate the NoteSequence to MIDI and write to a file.,
magenta/,194,Read it back in and compare to source.,
magenta/,195,Use file object,
magenta/,243,Translating to MIDI adds an implicit DEFAULT_QUARTERS_PER_MINUTE tempo,
magenta/,244,"at time 0, so recreate the list with that in place.",
magenta/,256,Add a final tempo long after the last note.,
magenta/,259,Translate without dropping.,
magenta/,264,Translate dropping anything after the last note.,
magenta/,267,The added tempo should have been dropped.,
magenta/,271,Add a final tempo 15 seconds after the last note.,
magenta/,274,"Translate dropping anything 30 seconds after the last note, which should",
magenta/,275,preserve the added tempo.,
magenta/,283,Translate without dropping.,
magenta/,289,Translate dropping anything after 30 seconds.,
magenta/,301,Translate without dropping.,
magenta/,306,Translate dropping anything after 30 seconds.,
magenta/,334,Use the file object when writing to the tempfile,
magenta/,335,to avoid permission error.,
magenta/,338,Count number of channel 9 Note Ons.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,49,Chord quality enum.,
magenta/,61,Intervals between scale steps.,
magenta/,64,Scale steps to MIDI mapping.,
magenta/,67,Mapping from scale degree to offset in half steps.,
magenta/,70,"All scale degree names within an octave, used when attempting to name a chord",
magenta/,71,given pitches.,
magenta/,87,List of chord kinds with abbreviations and scale degrees. Scale degrees are,
magenta/,88,"represented as strings here a) for human readability, and b) because the",
magenta/,89,number of semitones is insufficient when the chords have scale degree,
magenta/,90,modifications.,
magenta/,92,major triad,
magenta/,96,minor triad,
magenta/,100,augmented triad,
magenta/,104,diminished triad,
magenta/,108,dominant 7th,
magenta/,112,major 7th,
magenta/,116,minor 7th,
magenta/,120,diminished 7th,
magenta/,124,augmented 7th,
magenta/,128,half-diminished,
magenta/,132,minor triad with major 7th,
magenta/,137,major 6th,
magenta/,141,minor 6th,
magenta/,145,dominant 9th,
magenta/,149,major 9th,
magenta/,153,minor 9th,
magenta/,157,augmented 9th,
magenta/,161,6/9 chord,
magenta/,165,dominant 11th,
magenta/,169,major 11th,
magenta/,173,minor 11th,
magenta/,177,dominant 13th,
magenta/,181,major 13th,
magenta/,185,minor 13th,
magenta/,189,suspended 2nd,
magenta/,193,suspended 4th,
magenta/,197,suspended 4th with dominant 7th,
magenta/,201,pedal point,
magenta/,205,power chord,
magenta/,210,Dictionary mapping chord kind abbreviations to names and scale degrees.,
magenta/,216,Function to add a scale degree.,
magenta/,225,Function to remove a scale degree.,
magenta/,232,Function to alter (or add) a scale degree.,
magenta/,240,Scale degree modifications. There are three basic types of modifications:,
magenta/,241,"addition, subtraction, and alteration. These have been expanded into six types",
magenta/,242,"to aid in parsing, as each of the three basic operations has its own",
magenta/,243,requirements on the scale degree operand:,
magenta/,244,,
magenta/,245,- Addition can accept altered and unaltered scale degrees.,
magenta/,246,- Subtraction can only accept unaltered scale degrees.,
magenta/,247,- Alteration can only accept altered scale degrees.,
magenta/,258,Regular expression for chord root.,
magenta/,259,"Examples: 'C', 'G#', 'Ab', 'D######'",
magenta/,262,Regular expression for chord kind (abbreviated).,
magenta/,263,"Examples: '', 'm7b5', 'min', '-13', '+', 'm(M7)', 'dim', '/o7', 'sus2'",
magenta/,267,"Regular expression for scale degree modifications. (To keep the regex simpler,",
magenta/,268,"parentheses are not required to match here, e.g. '(#9', 'add2)', '(b5(#9)',",
magenta/,269,and 'no5)(b9' will all match.),
magenta/,270,"Examples: '#9', 'add6add9', 'no5(b9)', '(add2b5no3)', '(no5)(b9)'",
magenta/,274,Regular expression for chord bass.,
magenta/,275,"Examples: '', '/C', '/Bb', '/F##', '/Dbbbb'",
magenta/,278,Regular expression for full chord symbol.,
magenta/,280,root pitch class,
magenta/,281,chord kind,
magenta/,282,scale degree modifications,
magenta/,283,bass pitch class,
magenta/,286,Regular expression for a single pitch class.,
magenta/,287,"Examples: 'C', 'G#', 'Ab', 'D######'",
magenta/,291,Regular expression for a single scale degree.,
magenta/,292,"Examples: '1', '7', 'b3', '#5', 'bb7', '13'",
magenta/,296,Regular expression for a single scale degree modification. (To keep the regex,
magenta/,297,"simpler, parentheses are not required to match here, so open or closing paren",
magenta/,298,"could be missing, e.g. '(#9' and 'add2)' will both match.)",
magenta/,299,"Examples: '#9', 'add6', 'no5', '(b5)', '(add9)'",
magenta/,327,Here we make the assumption that each scale degree can be present in a chord,
magenta/,328,"at most once. This is not generally true, as e.g. a chord could contain both",
magenta/,329,b9 and #9.,
magenta/,411,Apply scale degree modifications.,
magenta/,421,Transpose up as many steps as we can.,
magenta/,428,Transpose up one more step and remove sharps (or add flats).,
magenta/,432,Remove flats.,
magenta/,469,"This set of scale degrees has duplicates, which we do not currently",
magenta/,470,allow.,
magenta/,476,"We store the chord kind with the most matches, and the scale degrees",
magenta/,477,representation that led to those matches (since a set of relative,
magenta/,478,pitches can be interpreted as scale degrees in multiple ways).,
magenta/,491,Add a scale degree.,
magenta/,499,"Alter a scale degree. We shouldn't be altering to natural, that's a sign",
magenta/,500,that we've chosen the wrong chord kind.,
magenta/,507,Subtract a scale degree.,
magenta/,525,"Split chord symbol into root, kind, modifications, and bass.",
magenta/,528,Parse and transpose the root.,
magenta/,535,Parse bass.,
magenta/,539,"Bass exists, transpose it.",
magenta/,540,pylint: disable=unpacking-non-sequence,
magenta/,546,No bass.,
magenta/,584,Convert to pitch classes and dedupe.,
magenta/,587,Try using the bass note as root first.,
magenta/,591,Try each pitch class in turn as root.,
magenta/,614,"If the bass pitch class is not one of the scale degrees in the chosen kind,",
magenta/,615,we don't need to include an explicit modification for it.,
magenta/,689,pylint: disable=unpacking-non-sequence,
magenta/,691,Bass is the same as root.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,45,Check content size.,
magenta/,54,Check a few obvious failure modes.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,31,Maximum number of melody frames to infer.,
magenta/,53,Evaluate the probability of each possible pitch interval.,
magenta/,58,Form the note onset transition matrix.,
magenta/,68,Continuing a rest is a non-event.,
magenta/,71,All note onsets are equally likely after rest.,
magenta/,74,Transitioning to rest/onset follows user-specified distribution.,
magenta/,78,Sustaining a note after onset is a non-event. Transitioning to a different,
magenta/,79,note (without onset) is forbidden.,
magenta/,82,Transitioning to rest/onset follows user-specified distribution.,
magenta/,86,Sustaining a note is a non-event. Transitioning to a different note (without,
magenta/,87,onset) is forbidden.,
magenta/,148,Whether or not each frame has any notes present at all.,
magenta/,151,Whether or not each note has the maximum pitch in each frame.,
magenta/,160,Initialize the log-likelihood matrix. There are two melody states for each,
magenta/,161,pitch (onset vs. non-onset) and one rest state.,
magenta/,164,Log-likelihood of each frame given rest. Depends only on presence of any,
magenta/,165,notes.,
magenta/,170,Log-likelihood of each frame given onset. Depends on presence of onset and,
magenta/,171,whether or not it is the maximum pitch. Probability of no observed onset,
magenta/,172,given melody onset is zero.,
magenta/,177,Log-likelihood of each frame given non-onset. Depends on absence of onset,
magenta/,178,and whether note is present and the maximum pitch. Probability of observed,
magenta/,179,onset given melody non-onset is zero; this is to prevent Viterbi from being,
magenta/,180,"""lazy"" and always treating repeated notes as sustain.",
magenta/,187,Take the log and scale by duration.,
magenta/,201,Assume the very first frame follows a rest.,
magenta/,206,"At each frame, store the log-likelihood of the best sequence ending in",
magenta/,207,"each melody event, along with the index of the parent melody event from",
magenta/,208,the previous frame.,
magenta/,217,Reconstruct the most likely sequence of melody events.,
magenta/,222,"Mapping from melody event index to rest or (pitch, is-onset) tuple.",
magenta/,227,Note onset.,
magenta/,230,Note sustain.,
magenta/,236,pylint:disable=g-bad-exception-name,
magenta/,289,Avoid any confusion around drum channel.,
magenta/,293,No pitches present in sequence.,
magenta/,300,Compute frame durations (times between consecutive note events).,
magenta/,309,Interval distribution is Cauchy-like.,
magenta/,314,Remove all pitches absent from sequence from transition matrix; for most,
magenta/,315,sequences this will greatly reduce the state space.,
magenta/,325,Compute log-likelihood of each frame under each possibly melody event.,
magenta/,332,Compute the most likely sequence of melody events using Viterbi.,
magenta/,350,A note has just ended.,
magenta/,357,This is a new note onset.,
magenta/,363,This is a continuation of the current note.,
magenta/,367,Add the final note.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,24,Mel spectrum constants and functions.,
magenta/,95,The i'th mel band (starting from i=1) has center frequency,
magenta/,96,"band_edges_mel[i], lower edge band_edges_mel[i-1], and higher edge",
magenta/,97,"band_edges_mel[i+1].  Thus, we need num_mel_bins + 2 values in",
magenta/,98,the band_edges_mel arrays.,
magenta/,101,Matrix to post-multiply feature arrays whose rows are num_spectrogram_bins,
magenta/,102,of spectrogram values.,
magenta/,106,Calculate lower and upper slopes for every spectrogram bin.,
magenta/,107,"Line segments are linear in the *mel* domain, not hertz.",
magenta/,112,.. then intersect them with each other and zero.,
magenta/,115,HTK excludes the spectrogram DC bin.  This line used to exclude bins 0 and,
magenta/,116,"1, but it turns out that to match mel_filterbank.cc only bin 0 should be",
magenta/,117,excluded; the use of two bins arose (I think) because of the unusual,
magenta/,118,index-origin-1 vectors in HTK (see line 493 of HSigP.c: fb.klo = 2).,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,33,Default MIDI Program (0 = grand piano),
magenta/,34,Default MIDI Channel (0 = first channel),
magenta/,96,Default to one division per measure,
magenta/,97,"From the MusicXML documentation: ""The divisions element indicates",
magenta/,98,how many divisions per quarter note are used to indicate a note's,
magenta/,99,"duration. For example, if duration = 1 and divisions = 2,",
magenta/,100,"this is an eighth note duration.""",
magenta/,103,Default to a tempo of 120 quarter notes per minute,
magenta/,104,"MusicXML calls this tempo, but Magenta calls this qpm",
magenta/,105,"Therefore, the variable is called qpm, but reads the",
magenta/,106,MusicXML tempo attribute,
magenta/,107,(120 qpm is the default tempo according to the,
magenta/,108,Standard MIDI Files 1.0 Specification),
magenta/,111,Duration of a single quarter note in seconds,
magenta/,114,Running total of time for the current event in seconds.,
magenta/,115,Resets to 0 on every part. Affected by <forward> and <backup> elements,
magenta/,118,Default to a MIDI velocity of 64 (mf),
magenta/,121,Default MIDI program (0 = grand piano),
magenta/,124,Current MIDI channel (usually equal to the part number),
magenta/,127,Keep track of previous note to get chord timing correct,
magenta/,128,This variable stores an instance of the Note class (defined below),
magenta/,131,Keep track of current transposition level in +/- semitones.,
magenta/,134,Keep track of current time signature. Does not support polymeter.,
magenta/,152,ScoreParts indexed by id.,
magenta/,156,Total time in seconds,
magenta/,178,Compressed MXL file. Uncompress in memory.,
magenta/,184,"A compressed MXL file may contain multiple files, but only one",
magenta/,185,MusicXML file. Read the META-INF/container.xml file inside of the,
magenta/,186,MXL file to locate the MusicXML file within the MXL file,
magenta/,187,http://www.musicxml.com/tutorial/compressed-mxl-files/zip-archive-structure/,
magenta/,189,Raise a MusicXMLParseError if multiple MusicXML files found,
magenta/,193,"In py3, instead of returning raw bytes, ZipFile.infolist() tries to",
magenta/,194,"guess the filenames' encoding based on file headers, and decodes using",
magenta/,195,this encoding in order to return a list of strings. If the utf-8,
magenta/,196,"header is missing, it decodes using the DOS code page 437 encoding",
magenta/,197,which is almost definitely wrong. Here we need to explicitly check,
magenta/,198,for when this has occurred and change the encoding to utf-8.,
magenta/,199,https://stackoverflow.com/questions/37723505/namelist-from-zipfile-returns-strings-with-an-invalid-encoding,
magenta/,223,"No media-type attribute, so assume this is the MusicXML file",
magenta/,236,"In py2, the filenames in infolist are utf-8 encoded, so",
magenta/,237,we encode the compressed_file_name as well in order to,
magenta/,238,be able to lookup compressed_file_info below.,
magenta/,252,Uncompressed XML file.,
magenta/,263,Parse part-list,
magenta/,271,Parse parts,
magenta/,286,Prevent duplicate chord symbols,
magenta/,313,Prevent duplicate time signatures,
magenta/,345,Prevent duplicate key signatures,
magenta/,349,"If there are no key signatures, add C major at the beginning",
magenta/,367,Use only first part,
magenta/,372,"If no tempos, add a default of 120 at beginning",
magenta/,414,"If no MIDI info, use the default MIDI channel.",
magenta/,416,Use the default MIDI program,
magenta/,443,"If this part references a score-part id that was not found in the file,",
magenta/,444,construct a default score-part.,
magenta/,447,Reset the time position when parsing each part,
magenta/,455,Issue #674: Repair measures that do not contain notes,
magenta/,456,by inserting a whole measure rest,
magenta/,471,Issue #674 - If the <forward> element is in a measure without,
magenta/,472,"any <note> elements, treat it as if it were a whole measure",
magenta/,473,rest by inserting a rest of that duration,
magenta/,477,Get the duration of the <forward> element,
magenta/,482,Delete the <forward> element,
magenta/,485,Insert the new note,
magenta/,508,Cumulative duration in MusicXML duration.,
magenta/,509,Used for time signature calculations,
magenta/,512,Record the starting time of this measure so that time signatures,
magenta/,513,can be inserted at the beginning of the measure,
magenta/,516,Update the time signature if a partial or pickup measure,
magenta/,534,Keep track of current note as previous note for chord timings,
magenta/,537,Sum up the MusicXML durations in voice 1 of this measure,
magenta/,545,Ignore other tag types because they are not relevant to Magenta.,
magenta/,566,Transposition is chromatic. Every half step up is 5 steps backward,
magenta/,567,"on the circle of fifths, which has 12 positions.",
magenta/,570,"If the new key has >6 sharps, translate to flats.",
magenta/,571,TODO(fjord): Could be more smart about when to use sharps vs. flats,
magenta/,572,when there are enharmonic equivalents.,
magenta/,577,Ignore other tag types because they are not relevant to Magenta.,
magenta/,633,Compute the fractional time signature (duration / divisions),
magenta/,634,Multiply divisions by 4 because division is always parts per quarter note,
magenta/,640,No global time signature yet and no measure time signature defined,
magenta/,641,in this measure (no time signature or senza misura).,
magenta/,642,Insert the fractional time signature as the time signature,
magenta/,643,for this measure,
magenta/,653,Check for pickup measure. Reset time signature to smaller numerator,
magenta/,658,Get the current time signature denominator,
magenta/,661,"If the fractional time signature = 1 (e.g. 4/4),",
magenta/,662,make the numerator the same as the global denominator,
magenta/,668,"Otherwise, set the time signature to the fractional time signature",
magenta/,669,Issue #674 - Use the original numerator and denominator,
magenta/,670,instead of the fractional one,
magenta/,681,Insert a new time signature only if it does not equal the global,
magenta/,682,time signature.,
magenta/,700,"Tuple (Pitch Name, MIDI number)",
magenta/,729,A time-modification element represents a tuplet_ratio,
magenta/,734,Ignore other tag types because they are not relevant to Magenta.,
magenta/,746,Parse alter string to a float (floats represent microtonal alterations),
magenta/,750,Check if this is a semitone alter (i.e. an integer) or microtonal (float),
magenta/,751,Number of semitones,
magenta/,754,Visual pitch representation,
magenta/,768,N.B. - pitch_string does not account for transposition,
magenta/,771,"Compute MIDI pitch number (C4 = 60, C1 = 24, C0 = 12)",
magenta/,773,Transpose MIDI pitch,
magenta/,808,Raise exception for unknown step (ex: 'Q'),
magenta/,843,MusicXML duration,
magenta/,844,Duration in MIDI ticks,
magenta/,845,Duration in seconds,
magenta/,846,Onset time in seconds,
magenta/,847,Number of augmentation dots,
magenta/,848,MusicXML duration type,
magenta/,849,Ratio for tuplets (default to 1),
magenta/,850,Assume true until not found,
magenta/,857,"Due to an error in Sibelius' export, force this note to have the",
magenta/,858,duration of the previous note if it is in a chord,
magenta/,870,Not sure how to handle durations of grace notes yet as they,
magenta/,871,steal time from subsequent notes and they do not have a,
magenta/,872,<duration> tag in the MusicXML,
magenta/,876,"If this is a chord, set the time position to the time position",
magenta/,877,of the previous note (i.e. all the notes in the chord will have,
magenta/,878,the same time position),
magenta/,881,Only increment time positions once in chord,
magenta/,910,Get ratio from MusicXML note type,
magenta/,914,Compute tuplet ratio,
magenta/,918,Add augmentation dots,
magenta/,926,"If the note is a grace note, force its ratio to be 0",
magenta/,927,because it does not have a <duration> tag,
magenta/,976,The below dictionary maps chord kinds to an abbreviated string as would,
magenta/,977,appear in a chord symbol in a standard lead sheet. There are often multiple,
magenta/,978,"standard abbreviations for the same chord type, e.g. ""+"" and ""aug"" both",
magenta/,979,"refer to an augmented chord, and ""maj7"", ""M7"", and a Delta character all",
magenta/,980,refer to a major-seventh chord; this dictionary attempts to be consistent,
magenta/,981,but the choice of abbreviation is somewhat arbitrary.,
magenta/,982,,
magenta/,983,The MusicXML-defined chord kinds are listed here:,
magenta/,984,http://usermanuals.musicxml.com/MusicXML/Content/ST-MusicXML-kind-value.htm,
magenta/,987,These chord kinds are in the MusicXML spec.,
magenta/,1016,"These are not in the spec, but show up frequently in the wild.",
magenta/,1021,Some abbreviated kinds also show up frequently in the wild.,
magenta/,1065,Parse alter text to an integer number of semitones.,
magenta/,1071,Visual alter representation,
magenta/,1096,Seems like this shouldn't happen but frequently does in the wild...,
magenta/,1107,Offset tag moves chord symbol time position.,
magenta/,1117,Ignore other tag types because they are not relevant to Magenta.,
magenta/,1174,"When adding unaltered scale degree, use ""add"" string.",
magenta/,1177,"When adding altered scale degree, ""add"" not necessary.",
magenta/,1181,Alter should be irrelevant when removing scale degree.,
magenta/,1186,"No type string necessary as merely appending e.g. ""#9"" suffices.",
magenta/,1192,Return a scale degree modification string that can be appended to a chord,
magenta/,1193,symbol figure string.,
magenta/,1242,"If more than 1 beats or beat-type found, this time signature is",
magenta/,1243,not supported (ex: alternating meter),
magenta/,1276,"MIDI and MusicXML identify key by using ""fifths"":",
magenta/,1277,"-1 = F, 0 = C, 1 = G etc.",
magenta/,1279,"mode is ""major"" or ""minor"" only: MIDI only supports major and minor",
magenta/,1302,Anything not minor will be interpreted as major,
magenta/,1340,"If tempo is 0, set it to default",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,32,Names of pitch classes to use (mostly ignoring spelling).,
magenta/,36,Pitch classes in a key (rooted at zero).,
magenta/,39,Pitch classes in each chord kind (rooted at zero).,
magenta/,52,"All usable chords, including no-chord.",
magenta/,56,All key-chord pairs.,
magenta/,59,Maximum length of chord sequence to infer.,
magenta/,62,Mapping from time signature to number of chords to infer per bar.,
magenta/,77,"For each key and chord, compute the number of chord notes in the key and the",
magenta/,78,number of chord notes outside the key.,
magenta/,88,"Compute the probability of each chord under each key, normalizing to sum to",
magenta/,89,one for each key.,
magenta/,110,Key change. Chord probability depends only on key and not previous,
magenta/,111,chord.,
magenta/,116,No key change.,
magenta/,119,"Chord probability depends on key, but we have to redistribute the",
magenta/,120,probability mass on the previous chord since we know the chord,
magenta/,121,changed.,
magenta/,128,No chord change.,
magenta/,159,Construct array of frame boundary times.,
magenta/,212,Initialize with a uniform distribution over keys.,
magenta/,221,"At each frame, store the log-likelihood of the best sequence ending in",
magenta/,222,"each key-chord pair, along with the index of the parent key-chord pair",
magenta/,223,from the previous frame.,
magenta/,232,Reconstruct the most likely sequence of key-chord pairs.,
magenta/,241,pylint:disable=g-bad-exception-name,
magenta/,319,Infer a fixed number of chords per bar.,
magenta/,329,Determine the number of seconds (and steps) each chord is held.,
magenta/,346,Sequence is not quantized relative to meter; chord changes will happen at,
magenta/,347,annotated beat times.,
magenta/,359,Only keep unique beats in the interior of the sequence. The first chord,
magenta/,360,"always starts at time zero, the last chord always ends at",
magenta/,361,"`sequence.total_time`, and we don't want any zero-length chords.",
magenta/,378,"Compute pitch vectors for each chord frame, then compute log-likelihood of",
magenta/,379,observing those pitch vectors under each possible chord.,
magenta/,386,"Compute distribution over chords for each key, and transition distribution",
magenta/,387,between key-chord pairs.,
magenta/,403,"Add the inferred chord changes to the sequence, optionally adding key",
magenta/,404,signature(s) as well.,
magenta/,414,A key change was inferred.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,34,pylint:disable=invalid-name,
magenta/,108,pylint:disable=protected-access,
magenta/,112,pylint:disable=protected-access,
magenta/,116,pylint:disable=protected-access,
magenta/,318,"Tests splitting a NoteSequence at regular hop size, truncating notes.",
magenta/,389,"Tests splitting a NoteSequence at specified times, truncating notes.",
magenta/,460,"Tests splitting a NoteSequence at regular hop size, skipping splits that",
magenta/,461,would have occurred inside a note.,
magenta/,516,Tests splitting a NoteSequence on time changes for a NoteSequence that has,
magenta/,517,no time changes (time signature and tempo changes).,
magenta/,536,Tests splitting a NoteSequence on time changes for a NoteSequence that has,
magenta/,537,duplicate time changes.,
magenta/,567,Tests splitting a NoteSequence on time changes for a NoteSequence that has,
magenta/,568,two time changes occurring simultaneously.,
magenta/,630,Tests splitting a NoteSequence on time changes skipping splits that occur,
magenta/,631,inside notes.,
magenta/,697,"Tests splitting a NoteSequence on time changes, truncating notes on splits",
magenta/,698,that occur inside notes.,
magenta/,778,Tests splitting a NoteSequence at specified times with stateless events.,
magenta/,1001,Single time signature.,
magenta/,1006,Multiple time signatures with no change.,
magenta/,1011,Time signature change.,
magenta/,1024,No time signature.,
magenta/,1028,Implicit time signature change.,
magenta/,1041,No time signature.,
magenta/,1045,"No implicit time signature change, but time signatures are added out of",
magenta/,1046,order.,
magenta/,1071,No tempos.,
magenta/,1075,Single tempo.,
magenta/,1080,Multiple tempos with no change.,
magenta/,1085,Tempo change.,
magenta/,1098,No tempo.,
magenta/,1102,Implicit tempo change.,
magenta/,1115,No tempo.,
magenta/,1119,"No implicit tempo change, but tempos are added out of order.",
magenta/,1196,Make sure the proto was not modified,
magenta/,1455,"The total_time field only takes *notes* into account, and should not be",
magenta/,1456,affected by a sustain-on event beyond the last note.,
magenta/,1524,Test non-quantized sequence.,
magenta/,1537,Test quantized sequence.,
magenta/,1717,A((BC)2D)2,
magenta/,2007,100 frames of notes.,
magenta/,2009,Activate key 39 for the middle 50 frames.,
magenta/,2021,100 frames of notes and onsets.,
magenta/,2024,Activate key 39 for the middle 50 frames and last 10 frames.,
magenta/,2027,Add an onset for the first occurrence.,
magenta/,2029,Add an onset for a note that doesn't have an active frame.,
magenta/,2049,100 frames of notes and onsets.,
magenta/,2053,Activate key 39 for the middle 50 frames and last 10 frames.,
magenta/,2056,Add an onset for the first occurrence with a valid velocity.,
magenta/,2059,Add an onset for the second occurrence with a NaN velocity.,
magenta/,2076,100 frames of notes and onsets.,
magenta/,2080,Activate key 39 for the middle 50 frames and last 10 frames.,
magenta/,2103,100 frames of notes and onsets.,
magenta/,2106,Activate key 39 for the middle 50 frames and last 10 frames.,
magenta/,2125,100 frames of notes and onsets.,
magenta/,2128,Activate key 39 for the middle 50 frames.,
magenta/,2130,Add multiple onsets within those frames.,
magenta/,2133,"If an onset lasts for multiple frames, it should create only 1 note.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,195,"48, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,209,"NO_EVENT, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,223,"49, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,237,"83, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,251,"NOTE_OFF, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,265,"48, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,279,"NOTE_OFF, lookbacks = (49, NO_EVENT)",
magenta/,293,"48, lookbacks = (NOTE_OFF, NO_EVENT)",
magenta/,307,"NOTE_OFF, lookbacks = (NO_EVENT, 49)",
magenta/,321,"49, lookbacks = (NO_EVENT, 83)",
magenta/,335,"82, lookbacks = (NO_EVENT, NOTE_OFF)",
magenta/,384,"24, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,389,"NO_EVENT, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,394,"25, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,399,"35, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,404,"NOTE_OFF, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,409,"24, lookbacks = (NO_EVENT, NO_EVENT)",
magenta/,414,"NOTE_OFF, lookbacks = (25, NO_EVENT)",
magenta/,419,"24, lookbacks = (NOTE_OFF, NO_EVENT)",
magenta/,424,"NOTE_OFF, lookbacks = (NO_EVENT, 25)",
magenta/,429,"25, lookbacks = (NO_EVENT, 35)",
magenta/,434,"34, lookbacks = (NO_EVENT, NOTE_OFF)",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,29,pylint:disable=g-bad-exception-name,
magenta/,75,"Read the wav file, converting sample rate & number of channels.",
magenta/,77,pylint: disable=broad-except,
magenta/,81,Convert to float32.,
magenta/,84,Already float32.,
magenta/,90,Convert to mono and the desired sample rate.,
magenta/,96,pylint: disable=broad-except,
magenta/,126,"Before copying the file, flush any contents",
magenta/,128,And back the file position to top (not need for Copy but for certainty),
magenta/,240,pylint: disable=broad-except,
magenta/,266,Mask of valid places in each row,
magenta/,270,Setup output array and put elements from data into masked positions,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,pylint: skip-file,
magenta/,16,Generated by the protocol buffer compiler.  DO NOT EDIT!,
magenta/,17,source: music.proto,
magenta/,25,@@protoc_insertion_point(imports),
magenta/,1535,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.Note),
magenta/,1542,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.TimeSignature),
magenta/,1549,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.KeySignature),
magenta/,1556,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.Tempo),
magenta/,1563,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.PitchBend),
magenta/,1570,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.ControlChange),
magenta/,1577,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.PartInfo),
magenta/,1584,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.InstrumentInfo),
magenta/,1591,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.SourceInfo),
magenta/,1598,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.TextAnnotation),
magenta/,1605,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.QuantizationInfo),
magenta/,1612,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.SubsequenceInfo),
magenta/,1619,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.SectionAnnotation),
magenta/,1626,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.Section),
magenta/,1633,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence.SectionGroup),
magenta/,1638,@@protoc_insertion_point(class_scope:tensorflow.magenta.NoteSequence),
magenta/,1660,@@protoc_insertion_point(class_scope:tensorflow.magenta.SequenceMetadata),
magenta/,1667,@@protoc_insertion_point(class_scope:tensorflow.magenta.VelocityRange),
magenta/,1673,@@protoc_insertion_point(module_scope),
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,pylint: skip-file,
magenta/,16,Generated by the protocol buffer compiler.  DO NOT EDIT!,
magenta/,17,source: generator.proto,
magenta/,25,@@protoc_insertion_point(imports),
magenta/,375,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorDetails),
magenta/,384,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorOptions.SequenceSection),
magenta/,391,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorOptions.ArgValue),
magenta/,398,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorOptions.ArgsEntry),
magenta/,403,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorOptions),
magenta/,415,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorBundle.BundleDetails),
magenta/,420,@@protoc_insertion_point(class_scope:tensorflow.magenta.GeneratorBundle),
magenta/,427,@@protoc_insertion_point(module_scope),
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,39,Constants based on craffel's example alignment script:,
magenta/,40,https://github.com/craffel/pretty-midi/blob/master/examples/align_midi.py,
magenta/,43,~3ms,
magenta/,61,Compute log-amplitude,
magenta/,97,It is critical that ns_samples and samples are the same length because the,
magenta/,98,alignment code does not do subsequence alignment.,
magenta/,103,"Pad samples too, if needed, because there are some cases where the",
magenta/,104,synthesized NoteSequence is actually longer.,
magenta/,109,Note that we skip normalization here becasue it happens in C++.,
magenta/,133,Write to file.,
magenta/,139,Align with C++ program.,
magenta/,142,Read file.,
magenta/,146,Clean up.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,Encoder weights (`V` in [1]).,
magenta/,57,Transposed decoder weights (`W'` in [1]).,
magenta/,62,Internal encoder bias term (`b` in [1]). Will be used if external biases,
magenta/,63,are not provided.,
magenta/,71,Internal decoder bias term (`c` in [1]). Will be used if external biases,
magenta/,72,are not provided.,
magenta/,115,Broadcast if needed.,
magenta/,121,Initial condition before the loop.,
magenta/,135,Get variables for time step.,
magenta/,143,Get log probability for this value. Log space avoids numerical issues.,
magenta/,146,Accumulate log probability.,
magenta/,149,Save conditional probabilities.,
magenta/,152,Encode value and add to hidden units.,
magenta/,157,Build the actual loop,
magenta/,191,Broadcast if needed.,
magenta/,208,Get weights and bias for time step.,
magenta/,222,Accumulate sampled values.,
magenta/,225,Get log probability for this value. Log space avoids numerical issues.,
magenta/,228,Accumulate log probability.,
magenta/,231,Encode value and add to hidden units.,
magenta/,258,Decode hidden units to get conditional probability.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,102,"Copy the current offset, since it might change.",
magenta/,109,Enter critical section for updating the offset.,
magenta/,111,Only update if the current offset value is what was used in this call.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,73,pylint: disable=invalid-name,
magenta/,76,pylint: disable=invalid-name,
magenta/,77,protobuf's SerializeToString returns binary string,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,88,"Since there may be fewer records than SHUFFLE_MIN_AFTER_DEQUEUE, take the",
magenta/,89,minimum of that number and the number of records.,
magenta/,145,"The sequences are equal length, so we should just flatten over the first",
magenta/,146,two dimensions.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,24,"This acts as a binary counter for testing purposes. For scoring, zeros",
magenta/,25,"accumulate value exponentially in the state, ones ""cash in"". The highest-",
magenta/,26,scoring sequence would be all zeros followed by a single one.,
magenta/,45,"The generator should emit all zeros, as only a single sequence is ever",
magenta/,46,considered so the counter doesn't reach one.,
magenta/,57,"Like the above case, the counter should never reach one as only a single",
magenta/,58,sequence is ever considered.,
magenta/,69,Here the beam search should greedily choose ones.,
magenta/,80,Here the beam has enough capacity to find the optimal solution without,
magenta/,81,branching.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,25,"A beam entry containing a) the current sequence, b) a ""state"" containing any",
magenta/,26,"information needed to extend the sequence, and c) a score for the current",
magenta/,27,sequence e.g. log-likelihood.,
magenta/,60,No need to make copies if there's no branching.,
magenta/,129,Choose the number of steps for the first iteration such that subsequent,
magenta/,130,iterations can all take the same number of steps.,
magenta/,144,Prune to the single best beam entry.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,Burn in.,
magenta/,36,Burn in.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,51,"Combine these two states, which each have a batch size of 2, together.",
magenta/,52,"Request a batch_size of 5, which means that a new batch of all zeros will",
magenta/,53,be created.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,53,Initialize MidiHub.,
magenta/,59,Assumes 4 beats per bar.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,46,pylint:disable=invalid-name,
magenta/,63,Burn in Sleeper for calibration.,
magenta/,75,Unsupported type.,
magenta/,81,Invalid arguments.,
magenta/,91,Non-inferrale type.,
magenta/,155,Use a time in the past to test handling of past notes.,
magenta/,171,The first note on will not be sent since it started before,
magenta/,172,`start_playback` is called.,
magenta/,186,Use a time in the past to test handling of past notes.,
magenta/,206,Sleep past first note start.,
magenta/,217,Finish playing sequence.,
magenta/,220,Start and end the unclosed note from the first sequence.,
magenta/,223,The second note will not be played since it started before the update,
magenta/,224,and was not in the original sequence.,
magenta/,346,Channels are 0-indexed in mido.,
magenta/,368,Receive the first 6 messages.,
magenta/,402,Receive the rest of the messages.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,69,Base QPM when set by a tempo control change.,
magenta/,90,A signal to tell the main loop when to stop.,
magenta/,260,Event for signalling when to end a call.,
magenta/,262,Event for signalling when to flush playback sequence.,
magenta/,264,Even for signalling when to mutate response.,
magenta/,321,Generation is simplified if we always start at 0 time.,
magenta/,333,Get current temperature setting.,
magenta/,336,Generate response.,
magenta/,360,Set callback for end call signal.,
magenta/,371,Keep track of the end of the previous tick time.,
magenta/,374,Keep track of the duration of a listen state.,
magenta/,377,Start with an empty response sequence.,
magenta/,384,Enter loop at each clock tick.,
magenta/,396,"Set to current QPM, since it might have changed.",
magenta/,408,True iff there was no input captured during the last tick.,
magenta/,415,Reset captured sequence since we are still idling.,
magenta/,432,Create response and start playback.,
magenta/,438,Move the sequence forward one tick in time.,
magenta/,444,Compute duration of response.,
magenta/,451,Use capture duration.,
magenta/,461,"If it took too long to generate, push response to next tick.",
magenta/,471,Start response playback. Specify the start_time to avoid stripping,
magenta/,472,initial events due to generation lag.,
magenta/,476,Optionally capture during playback.,
magenta/,482,Clear end signal and reset listen_ticks.,
magenta/,486,Continue listening.,
magenta/,489,Potentially loop or mutate previous response.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,39,pylint: disable=redefined-builtin,
magenta/,181,A map from a string generator name to its class.,
magenta/,319,Load generators.,
magenta/,326,Initialize MidiHub.,
magenta/,342,"Set the tick duration to be a single bar, assuming a 4/4 time signature.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,TODO(adarob): Use flattened imports.,
magenta/,32,Melodic Tom,
magenta/,41,0-indexed.,
magenta/,45,The RtMidi backend is easier to install and has support for virtual ports.,
magenta/,46,"pylint: disable=unused-import,g-import-not-at-top",
magenta/,49,Tries to use PortMidi backend by default.,
magenta/,53,pylint:disable=g-bad-exception-name,
magenta/,125,The compatible mido.Message types.,
magenta/,127,"If msg is not provided, check that the given arguments are valid for some",
magenta/,128,message type.,
magenta/,144,"If there is only a single valid inferred type, use it.",
magenta/,167,Generate regex pattern.,
magenta/,222,Locking is not required since variables are independent and assignment is,
magenta/,223,atomic.,
magenta/,226,Set the program number for the channels.,
magenta/,307,Set of notes (pitches) that are currently on.,
magenta/,309,Lock for serialization.,
magenta/,311,A control variable to signal when the sequence has been updated.,
magenta/,313,"The queue of mido.Message objects to send, sorted by ascending time.",
magenta/,315,An event that is set when `stop` has been called.,
magenta/,318,Initialize message queue.,
magenta/,319,"We first have to allow ""updates"" to set the initial sequence.",
magenta/,322,We now make whether we allow updates dependent on the argument.,
magenta/,350,The set of pitches that are already playing and will be closed without,
magenta/,351,first being reopened in in the new sequence.,
magenta/,365,Close remaining open notes at the next event time to avoid abruptly ending,
magenta/,366,notes.,
magenta/,386,Assumes model where NoteSequence is time-stamped with wall time.,
magenta/,387,TODO(hanzorama): Argument to allow initial start not at sequence start?,
magenta/,405,"Either keep player alive and wait for sequence update, or return.",
magenta/,422,Replace message queue with immediate end of open notes.,
magenta/,448,A message that is used to wake the consumer thread.,
magenta/,452,A lock for synchronization.,
magenta/,460,A set of active MidiSignals being used by iterators.,
magenta/,462,An event that is set when `stop` has been called.,
magenta/,464,Active callback threads keyed by unique thread name.,
magenta/,566,Acquire lock to avoid race condition with `iterate`.,
magenta/,568,Set final captured sequence.,
magenta/,570,Wake up all generators.,
magenta/,594,Force the thread to wake since we've updated the stop time.,
magenta/,620,Make a copy of the sequence currently being captured.,
magenta/,691,This is only recieved when the thread is in the process of,
magenta/,692,terminating. Wait until it is done before yielding the final,
magenta/,693,sequence.,
magenta/,697,Acquire lock so that `captured_sequence` will be called before thread,
magenta/,698,"terminates, if it has not already done so.",
magenta/,799,This is not the note we're looking for. Drop it.,
magenta/,808,This is just a repeat of the previous message.,
magenta/,810,End the previous note.,
magenta/,820,A dictionary of open NoteSequence.Note messages keyed by pitch.,
magenta/,833,This is not a note we're looking for. Drop it.,
magenta/,841,This is likely just a repeat of the previous message.,
magenta/,882,"When `passthrough` is True, this is the set of open MIDI note pitches.",
magenta/,884,This lock is used by the serialized decorator.,
magenta/,886,A dictionary mapping a compiled MidiSignal regex to a condition variable,
magenta/,887,that will be notified when a matching messsage is received.,
magenta/,889,A dictionary mapping a compiled MidiSignal regex to a list of functions,
magenta/,890,that will be called with the triggering message in individual threads when,
magenta/,891,a matching message is received.,
magenta/,893,A dictionary mapping integer control numbers to most recently-received,
magenta/,894,integer value.,
magenta/,896,Threads actively being used to capture incoming messages.,
magenta/,898,Potentially active player threads.,
magenta/,902,Open MIDI ports.,
magenta/,915,Start processing incoming messages.,
magenta/,918,Keep references to input ports to prevent deletion.,
magenta/,959,Close all open notes.,
magenta/,984,Notify any threads waiting for this message.,
magenta/,991,Call any callbacks waiting for this message.,
magenta/,999,Remove any captors that are no longer alive.,
magenta/,1001,Add a different copy of the message to the receive queue of each live,
magenta/,1002,capture thread.,
magenta/,1006,Update control values if this is a control change message.,
magenta/,1012,"Pass the message through to the output port, if appropriate.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,76,pylint: disable=broad-except,
magenta/,85,pylint: disable=broad-except,
magenta/,93,pylint: disable=broad-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,47,pylint: disable=invalid-name,
magenta/,74,"abc2midi adds a 1-tick delay to the start of every note, but we don't.",
magenta/,79,"For now, don't compare velocities.",
magenta/,87,pylint: disable=broad-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,50,pylint: disable=g-explicit-bool-comparison,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,26,Shortcut to chord symbol text annotation type.,
magenta/,183,"Note that transpose is called even with a transpose amount of zero, to",
magenta/,184,ensure that out-of-range pitches are handled correctly.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,92,Tests that the DAGPipeline has the correct `input_type` and,
magenta/,93,`output_type` values based on the DAG given to it.,
magenta/,113,Tests single object and dictionaries in the DAG.,
magenta/,133,The following outputs are the result of passing the values in,
magenta/,134,"`input_object` through the transform functions of UnitA, UnitB, UnitC,",
magenta/,135,"and UnitD (all defined at the top of this file), connected in the way",
magenta/,136,defined by `dag`.,
magenta/,144,Tests a pipeline.Pipeline that maps a single input to multiple outputs.,
magenta/,177,Tests dictionary output type where each output list has a different size.,
magenta/,226,Tests that intermediate output lists which are not the same length are,
magenta/,227,handled correctly.,
magenta/,284,Tests a direct dict to dict connection in the DAG.,
magenta/,345,Test that empty lists or dicts as intermediate or final outputs don't,
magenta/,346,break anything.,
magenta/,671,Pipelines that do not output to anywhere are not allowed.,
magenta/,679,Pipelines which need to be executed but don't have inputs are not allowed.,
magenta/,704,Missing Input.,
magenta/,711,Missing Output.,
magenta/,717,Multiple instances of Input with the same type IS allowed.,
magenta/,724,Multiple instances with different types is not allowed.,
magenta/,769,This happens when the output of a pipeline's `transform` method does not,
magenta/,770,match the type signature given by the pipeline's `output_type`.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,64,`output_type` and `input_type` are set by DAGPipeline. Since `DagOutput`,
magenta/,65,"is not given its type, the type must be infered from what it is connected",
magenta/,66,to in the DAG. Having `output_type` and `input_type` makes `DagOutput` act,
magenta/,67,like a `Pipeline` in some cases.,
magenta/,235,Expand DAG shorthand.,
magenta/,238,Make sure DAG is valid.,
magenta/,239,DagInput types match output types. Nothing depends on outputs.,
magenta/,240,Things that require input get input. DAG is composed of correct types.,
magenta/,264,Check that all input types match output types.,
magenta/,266,DagOutput objects don't know their types.,
magenta/,275,"Make sure all Pipeline names are unique, so that Statistic objects don't",
magenta/,276,clash.,
magenta/,287,Find DagInput and DagOutput objects and make sure they are being used,
magenta/,288,correctly.,
magenta/,312,Compute output_type for self and call super constructor.,
magenta/,320,"Make sure all Pipeline objects have DAG vertices that feed into them,",
magenta/,321,and feed their output into other DAG vertices.,
magenta/,340,Construct topological ordering to determine the execution order of the,
magenta/,341,pipelines.,
magenta/,342,https://en.wikipedia.org/wiki/Topological_sorting#Kahn.27s_algorithm,
magenta/,344,`graph` maps a pipeline to the pipelines it depends on. Each dict value,
magenta/,345,"is a list with the dependency pipelines in the 0th position, and a count",
magenta/,346,of forward connections to the key pipeline (how many pipelines use this,
magenta/,347,pipeline as a dependency).,
magenta/,354,Topologically sorted elements go here.,
magenta/,369,Check for cycles by checking if any edges remain.,
magenta/,374,Note: this exception should never be raised. Disconnected graphs will be,
magenta/,375,caught where NotConnectedError is raised. If this exception goes off,
magenta/,376,there is likely a bug.,
magenta/,408,Direct connection.,
magenta/,500,Compute transformation.,
magenta/,507,If this unit has no inputs don't run it.,
magenta/,535,"If there are no outputs, just return nothing.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,229,Test that extract_melodies discards melodies with too few pitches where,
magenta/,230,pitches are equivalent by octave.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,220,List of inclusive lowest values in each bucket.,
magenta/,225,https://docs.python.org/2/library/bisect.html#searching-sorted-lists,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,84,Create a histogram measuring drum track lengths (in bars not steps).,
magenta/,85,"Capture drum tracks that are very small, in the range of the filter lower",
magenta/,86,"bound `min_bars`, and large. The bucket intervals grow approximately",
magenta/,87,exponentially.,
magenta/,96,Quantize the track into a DrumTrack object.,
magenta/,97,"If any notes start at the same time, only one is kept.",
magenta/,112,Require a certain drum track length.,
magenta/,117,Discard drum tracks that are too long.,
magenta/,122,Truncate drum tracks that are too long.,
magenta/,152,pylint has a false positive error on this method call for some reason.,
magenta/,153,pylint:disable=redundant-keyword-arg,
magenta/,159,pylint:enable=redundant-keyword-arg,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,62,Transpose up to a major third in either direction.,
magenta/,128,pylint: disable=g-complex-comprehension,
magenta/,134,pylint: enable=g-complex-comprehension,
magenta/,139,Create a histogram measuring lengths (in bars not steps).,
magenta/,144,Allow only 1 program.,
magenta/,152,Translate the quantized sequence into a PianorollSequence.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,143,"If `chords` is None, it's because a chord progression could not be",
magenta/,144,extracted for this particular melody.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,127,TODO(danabo): Convert `ignore_polyphonic_notes` into a float which controls,
magenta/,128,the degree of polyphony that is acceptable.,
magenta/,130,pylint: disable=g-complex-comprehension,
magenta/,137,pylint: enable=g-complex-comprehension,
magenta/,138,Create a histogram measuring melody lengths (in bars not steps).,
magenta/,139,"Capture melodies that are very small, in the range of the filter lower",
magenta/,140,"bound `min_bars`, and large. The bucket intervals grow approximately",
magenta/,141,exponentially.,
magenta/,151,Quantize the track into a Melody object.,
magenta/,152,"If any notes start at the same time, only one is kept.",
magenta/,166,Look for monophonic melodies in other tracks.,
magenta/,167,Start search for next melody on next bar boundary (inclusive).,
magenta/,174,Require a certain melody length.,
magenta/,179,Discard melodies that are too long.,
magenta/,184,Truncate melodies that are too long.,
magenta/,192,Require a certain number of unique pitches.,
magenta/,199,TODO(danabo),
magenta/,200,Add filter for rhythmic diversity.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,157,Make sure `input_type` and `output_type` are valid.,
magenta/,159,"This will get the name of the subclass, not ""Pipeline"".",
magenta/,378,pylint:disable=not-an-iterable,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,29,pylint: disable=invalid-name,
magenta/,143,This happens if PipelineKey() is used on a pipeline with out a dictionary,
magenta/,144,"output, or the key is not in the output_type dict.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,55,Encode conditional on control signals.,
magenta/,61,"Create two copies, one with and one without conditioning.",
magenta/,62,pylint: disable=g-complex-comprehension,
magenta/,68,pylint: enable=g-complex-comprehension,
magenta/,73,Encode unconditional.,
magenta/,115,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,118,Transpose no more than a major third.,
magenta/,189,pylint: disable=g-complex-comprehension,
magenta/,196,pylint: enable=g-complex-comprehension,
magenta/,200,Create a histogram measuring lengths in seconds.,
magenta/,207,Create a histogram measuring lengths in bars.,
magenta/,216,Allow only 1 program.,
magenta/,227,Translate the quantized sequence into a Performance.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,145,Last lead sheet should be rejected for coincident chords.,
magenta/,173,Last lead sheet should be rejected for having no chords.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2017 Google Inc. All Rights Reserved.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,107,resize the images,
magenta/,113,create the pair,
magenta/,118,save file,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,93,no need to convert,
magenta/,96,print('file open'),
magenta/,100,resize the images,
magenta/,109,save file,
magenta/,110,remove old path & old extension:,
magenta/,119,pylint: disable=bare-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,94,pylint: disable=bare-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,160,save file,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,46,Load Config,
magenta/,53,Load dataset,
magenta/,59,Make the directory,
magenta/,66,Set random seed,
magenta/,70,Load Model,
magenta/,75,noqa,
magenta/,77,Initialize,
magenta/,80,Load,
magenta/,84,Sample from prior,
magenta/,90,from prior,
magenta/,97,"Sample from priro, as Grid",
magenta/,109,Reconstruction,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,125,Variable that in its name has A or B indictating their belonging of one side,
magenta/,126,of data has name consider to be invalid by pylint so we disable the warning.,
magenta/,127,pylint:disable=invalid-name,
magenta/,183,pylint:enable=invalid-name,
magenta/,275,Variable that in its name has A or B indictating their belonging of one side,
magenta/,276,of data has name consider to be invalid by pylint so we disable the warning.,
magenta/,277,pylint:disable=invalid-name,
magenta/,323,pylint:enable=invalid-name,
magenta/,392,from one-hot to label,
magenta/,621,"pylint:disable=unused-variable,possibly-unused-variable",
magenta/,622,Reason:,
magenta/,623,All endpoints are stored as attribute at the end of `_build`.,
magenta/,624,Pylint cannot infer this case so it emits false alarm of,
magenta/,625,unused-variable if we do not disable this warning.,
magenta/,627,pylint:disable=invalid-name,
magenta/,628,Reason:,
magenta/,629,Variable useing 'G' in is name to be consistent with WaveGAN's author,
magenta/,630,has name consider to be invalid by pylint so we disable the warning.,
magenta/,632,"Dataset (SC09, WaveGAN)'s generator",
magenta/,635,"Use the retrained, Gaussian priored model",
magenta/,641,"Dataset (SC09, WaveGAN)'s  classifier (inception)",
magenta/,649,"Dataset B (SC09, WaveGAN)'s Tensor symbols",
magenta/,653,Classification: Tensor symbols,
magenta/,657,Add all endpoints as object attributes,
magenta/,682,"pylint:enable=unused-variable,possibly-unused-variable",
magenta/,683,pylint:enable=invalid-name,
magenta/,757,The sample object servers both purpose.,
magenta/,761,In this case two diffent objects serve two purpose.,
magenta/,784,We don't need restore the `m_classifier_helper` again since `m_helper`,
magenta/,785,and `m_classifier_helper` are two identicial objects.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,pylint: skip-file,
magenta/,16,TODO(adarob): Remove skip-file with https://github.com/PyCQA/astroid/issues/627,
magenta/,55,For Overriding configs,
magenta/,73,pylint:disable=unused-variable,
magenta/,74,Reason:,
magenta/,75,This training script relys on many programmatical call to function and,
magenta/,76,access to variables. Pylint cannot infer this case so it emits false alarm,
magenta/,77,of unused-variable if we do not disable this warning.,
magenta/,79,pylint:disable=invalid-name,
magenta/,80,Reason:,
magenta/,81,Following variables have their name consider to be invalid by pylint so,
magenta/,82,we disable the warning.,
magenta/,83,- Variable that in its name has A or B indictating their belonging of,
magenta/,84,one side of data.,
magenta/,87,Load main config,
magenta/,96,Load dataset,
magenta/,104,Prepare directories,
magenta/,108,Set random seed,
magenta/,112,Real Training.,
magenta/,116,Load model's architecture (= build),
magenta/,125,Prepare summary,
magenta/,133,Initialize and restore,
magenta/,139,Miscs from config,
magenta/,146,Data iterators,
magenta/,161,Training loop,
magenta/,164,Prepare data for this batch,
magenta/,165,- Unsupervised (A),
magenta/,168,- Supervised (aligning),
magenta/,172,Run training op and write summary,
magenta/,182,Save the model if instructed,
magenta/,191,Evaluate if instructed,
magenta/,193,Helper functions,
magenta/,226,This [cell-var-from-loop] is intented,
magenta/,227,pylint: disable=cell-var-from-loop,
magenta/,229,Classifier based evaluation,
magenta/,247,pylint: disable=cell-var-from-loop,
magenta/,271,Use x_A in outer scope,
magenta/,272,These [cell-var-from-loop]s are intended,
magenta/,273,pylint: disable=cell-var-from-loop,
magenta/,274,pylint: disable=cell-var-from-loop,
magenta/,277,use x_B in outer scope,
magenta/,278,These [cell-var-from-loop]s are intended,
magenta/,279,pylint: disable=cell-var-from-loop,
magenta/,280,pylint: disable=cell-var-from-loop,
magenta/,282,Do all manual summary,
magenta/,295,Sampling based evaluation / sampling,
magenta/,321,Here `var` would be None if,
magenta/,322,"- there is no such variable in `locals()`, or",
magenta/,323,- such variable exists but the value is None,
magenta/,324,"In both case, we would skip saving data from it.",
magenta/,329,pylint:enable=invalid-name,
magenta/,330,pylint:enable=unused-variable,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,121,"pylint:disable=unused-variable,possibly-unused-variable",
magenta/,122,Reason:,
magenta/,123,All endpoints are stored as attribute at the end of `_build`.,
magenta/,124,Pylint cannot infer this case so it emits false alarm of,
magenta/,125,unused-variable if we do not disable this warning.,
magenta/,129,Constants,
magenta/,134,---------------------------------------------------------------------,
magenta/,135,## Placeholders,
magenta/,136,---------------------------------------------------------------------,
magenta/,140,---------------------------------------------------------------------,
magenta/,141,## Modules with parameters,
magenta/,142,---------------------------------------------------------------------,
magenta/,143,Variable that is class has name consider to be invalid by pylint so we,
magenta/,144,disable the warning.,
magenta/,145,pylint:disable=invalid-name,
magenta/,150,pylint:enable=invalid-name,
magenta/,152,---------------------------------------------------------------------,
magenta/,153,## Placeholders,
magenta/,154,---------------------------------------------------------------------,
magenta/,157,for summary only,
magenta/,161,Decode,
magenta/,164,Reconstruction Loss,
magenta/,165,Don't use log_prob from tf.ds (larger = better),
magenta/,166,"Instead, we use L2 norm (smaller = better)",
magenta/,167,"# recons = tf.reduce_sum(p_x.log_prob(x), axis=[-1])",
magenta/,171,Prior,
magenta/,176,Space filling,
magenta/,178,We use `KL` in variable name for naming consistency with math.,
magenta/,179,pylint:disable=invalid-name,
magenta/,191,pylint:enable=invalid-name,
magenta/,193,VAE Loss,
magenta/,198,---------------------------------------------------------------------,
magenta/,199,## Training,
magenta/,200,---------------------------------------------------------------------,
magenta/,201,Learning rates,
magenta/,203,Training Ops,
magenta/,208,"Here, if we use identity transferm, there is no var to optimize,",
magenta/,209,"so in this case we shall avoid building optimizer and saver,",
magenta/,210,otherwise there would be,
magenta/,211,"""No variables to optimize."" / ""No variables to save"" error.",
magenta/,213,Optimizer,
magenta/,217,Savers,
magenta/,220,Add all endpoints as object attributes,
magenta/,224,"pylint:enable=unused-variable,possibly-unused-variable",
magenta/,239,"pylint:disable=unused-variable,possibly-unused-variable",
magenta/,240,Reason:,
magenta/,241,All endpoints are stored as attribute at the end of `_build`.,
magenta/,242,Pylint cannot infer this case so it emits false alarm of,
magenta/,243,unused-variable if we do not disable this warning.,
magenta/,245,pylint:disable=invalid-name,
magenta/,246,Reason:,
magenta/,247,Following variables have their name consider to be invalid by pylint so,
magenta/,248,we disable the warning.,
magenta/,249,- Variable that is class,
magenta/,250,- Variable that in its name has A or B indictating their belonging of,
magenta/,251,one side of data.,
magenta/,253,---------------------------------------------------------------------,
magenta/,254,## Extract parameters from config,
magenta/,255,---------------------------------------------------------------------,
magenta/,267,---------------------------------------------------------------------,
magenta/,268,## VAE containing Modules with parameters,
magenta/,269,---------------------------------------------------------------------,
magenta/,282,---------------------------------------------------------------------,
magenta/,283,## Computation Flow,
magenta/,284,---------------------------------------------------------------------,
magenta/,286,Tensor Endpoints,
magenta/,315,VI in joint space,
magenta/,322,- KL,
magenta/,330,- Reconstruction (from joint Gussian),
magenta/,344,- Reconstruction (from transfer),
magenta/,364,Full loss,
magenta/,368,train op,
magenta/,373,Add all endpoints as object attributes,
magenta/,377,"pylint:enable=unused-variable,possibly-unused-variable",
magenta/,378,pylint:enable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,45,"pylint:disable=unused-variable,possibly-unused-variable",
magenta/,46,Reason:,
magenta/,47,All endpoints are stored as attribute at the end of `_build`.,
magenta/,48,Pylint cannot infer this case so it emits false alarm of,
magenta/,49,unused-variable if we do not disable this warning.,
magenta/,53,Constants,
magenta/,58,---------------------------------------------------------------------,
magenta/,59,## Placeholders,
magenta/,60,---------------------------------------------------------------------,
magenta/,61,Image data,
magenta/,69,p_x_fn = lambda logits: ds.Bernoulli(logits=logits),
magenta/,72,noqa,
magenta/,83,noqa,
magenta/,85,Attributes,
magenta/,87,Real / fake label reward,
magenta/,89,Transform through optimization,
magenta/,92,---------------------------------------------------------------------,
magenta/,93,## Modules with parameters,
magenta/,94,---------------------------------------------------------------------,
magenta/,95,Abstract Modules.,
magenta/,96,Variable that is class has name consider to be invalid by pylint so we,
magenta/,97,disable the warning.,
magenta/,98,pylint:disable=invalid-name,
magenta/,102,pylint:enable=invalid-name,
magenta/,108,---------------------------------------------------------------------,
magenta/,109,## Classify Attributes from pixels,
magenta/,110,---------------------------------------------------------------------,
magenta/,115,---------------------------------------------------------------------,
magenta/,116,## VAE,
magenta/,117,---------------------------------------------------------------------,
magenta/,118,Encode,
magenta/,122,Optimize / Amortize or feedthrough,
magenta/,127,Decode,
magenta/,132,Reconstruction Loss,
magenta/,140,Prior,
magenta/,144,KL Loss.,
magenta/,145,We use `KL` in variable name for naming consistency with math.,
magenta/,146,pylint:disable=invalid-name,
magenta/,153,pylint:enable=invalid-name,
magenta/,155,VAE Loss,
magenta/,159,---------------------------------------------------------------------,
magenta/,160,## Training,
magenta/,161,---------------------------------------------------------------------,
magenta/,162,Learning rates,
magenta/,166,Training Ops,
magenta/,177,Savers,
magenta/,181,Add all endpoints as object attributes,
magenta/,185,"pylint:enable=unused-variable,possibly-unused-variable",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,110,pylint:disable=unused-argument,
magenta/,111,pylint:disable=unused-argument,
magenta/,114,pylint:disable=unused-argument,
magenta/,115,pylint:disable=g-doc-args,
magenta/,122,"If op level seed is not set, use whatever graph level seed is",
magenta/,123,returned.,
magenta/,129,"Convert shape from [num examples, rows, columns, depth]",
magenta/,130,"to [num examples, rows*columns] (assuming depth == 1)",
magenta/,135,"Convert from [0, 255] -> [0.0, 1.0].",
magenta/,170,Shuffle for the first epoch,
magenta/,176,Go to the next epoch,
magenta/,178,Finished epoch,
magenta/,180,Get the rest examples in this epoch,
magenta/,184,Shuffle the data,
magenta/,190,Start next epoch,
magenta/,207,pylint:disable=unused-argument,
magenta/,215,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,23,pylint:disable=invalid-name,
magenta/,49,Load Config,
magenta/,57,Load dataset,
magenta/,65,Make the directory,
magenta/,76,Load Model,
magenta/,80,noqa,
magenta/,82,Create summaries,
magenta/,91,Summary writers,
magenta/,95,Initialize,
magenta/,111,Train the Classifier,
magenta/,118,train op,
magenta/,128,write training reconstructions,
magenta/,130,write eval summaries,
magenta/,148,Save the best model,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,42,Load Config,
magenta/,49,Load dataset,
magenta/,56,Make the directory,
magenta/,63,Load Model,
magenta/,67,noqa,
magenta/,69,Initialize,
magenta/,72,Load,
magenta/,76,Encode,
magenta/,118,Save encoded as npz file,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,53,Load Config,
magenta/,61,Load dataset,
magenta/,69,Make the directory,
magenta/,77,We use `N` in variable name to emphasis its being the Number of something.,
magenta/,78,pylint:disable=invalid-name,
magenta/,79,pylint:disable=invalid-name,
magenta/,81,Load Model,
magenta/,86,noqa,
magenta/,88,Create summaries,
magenta/,104,Summary writers,
magenta/,108,Initialize,
magenta/,112,pylint:disable=invalid-name,
magenta/,123,Train the VAE,
magenta/,130,train op,
magenta/,141,write training reconstructions,
magenta/,150,write sample reconstructions,
magenta/,158,write eval summaries,
magenta/,179,Save the best model,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,50,For Overriding configs,
magenta/,62,For controling interpolation,
magenta/,74,pylint:disable=unused-variable,
magenta/,75,Reason:,
magenta/,76,This training script relys on many programmatical call to function and,
magenta/,77,access to variables. Pylint cannot infer this case so it emits false alarm,
magenta/,78,of unused-variable if we do not disable this warning.,
magenta/,80,pylint:disable=invalid-name,
magenta/,81,Reason:,
magenta/,82,Following variables have their name consider to be invalid by pylint so,
magenta/,83,we disable the warning.,
magenta/,84,- Variable that in its name has A or B indictating their belonging of,
magenta/,85,one side of data.,
magenta/,88,Load main config,
magenta/,97,Load dataset,
magenta/,105,Prepare directories,
magenta/,109,Set random seed,
magenta/,113,Real Training.,
magenta/,117,Load model's architecture (= build),
magenta/,126,Initialize and restore,
magenta/,132,Restore from ckpt,
magenta/,139,prepare intepolate dir,
magenta/,144,things,
magenta/,181,Generate data domain instances and save.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,29,https://ccrma.stanford.edu/~jos/sasp/Product_Two_Gaussian_PDFs.html,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,47,pylint:disable=invalid-name,
magenta/,48,Reason:,
magenta/,49,Following variables have their name consider to be invalid by pylint so,
magenta/,50,we disable the warning.,
magenta/,51,- Variable that is class,
magenta/,60,TF init,
magenta/,62,- generative model,
magenta/,74,- classifier (inception),
magenta/,83,Generate: Tensor symbols,
magenta/,86,G_z_spec = graph_gan.get_tensor_by_name('G_z_spec:0'),
magenta/,87,Classification: Tensor symbols,
magenta/,91,Sample something AND classify them,
magenta/,116,"_G_z, _G_z_spec = sess_gan.run([G_z, G_z_spec], {z: _z})",
magenta/,129,remove unneeded tails,
magenta/,140,output a few samples as image,
magenta/,159,Make Numpy arrays and save everything as an npz file,
magenta/,178,pylint:enable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,118,unused,
magenta/,119,unused,
magenta/,129,black-on-white MNIST (harder to learn than white-on-black MNIST),
magenta/,130,Running locally (pre-download data locally),
magenta/,146,Load Data,
magenta/,256,clipping,
magenta/,259,grey -> rgb,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,71,model,
magenta/,78,training dynamics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,92,model,
magenta/,99,training dynamics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,71,model,
magenta/,78,training dynamics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,92,model,
magenta/,99,training dynamics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,It's case-insensitive.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,71,model,
magenta/,78,training dynamics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,18,pylint:disable=invalid-name,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,133,Default configurations.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,82,Dictionary of functions that take `min_note` and `max_note` and return the,
magenta/,83,appropriate EventSequenceEncoderDecoder object.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,165,Derive the total number of seconds to generate based on the QPM of the,
magenta/,166,priming sequence and the num_steps flag.,
magenta/,170,Specify start/stop time for generation based on starting generation at the,
magenta/,171,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,172,long.,
magenta/,176,Set the start time to begin on the next step after the last note ends.,
magenta/,206,Make the generate request num_outputs times and save the output as midi,
magenta/,207,files.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,85,Quantize the priming sequence.,
magenta/,88,Setting gap_bars to infinite ensures that the entire input will be used.,
magenta/,97,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,98,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,99,seconds when the requested end time is 4.99.,
magenta/,106,"If no melody could be extracted, create an empty melody that starts 1",
magenta/,107,step before the request start_step. This will result in 1 step of,
magenta/,108,silence when the melody is extended below.,
magenta/,116,Ensure that the melody extends up to the step we want to start generating.,
magenta/,119,Extract generation arguments from generator options.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,61,Load the model,
magenta/,65,Make an output directory if it doesn't exist,
magenta/,71,"If a MIDI file is provided, synthesize interpolations across the clip",
magenta/,74,Distribute latent vectors linearly in time,
magenta/,80,Get latent vectors for each note,
magenta/,83,Generate audio for each note,
magenta/,87,Make a single audio clip,
magenta/,93,Write the wave files,
magenta/,97,"Otherwise, just generate a batch of random sounds",
magenta/,99,Write the wave files,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,72,Save normalizer.,
magenta/,73,"Note if normalizer has been saved, save() is no-op. To regenerate the",
magenta/,74,"normalizer, delete the normalizer file in train_root_dir/assets",
magenta/,89,Train one stage at a time,
magenta/,105,Set hyperparams from json args and defaults,
magenta/,107,Config hparams,
magenta/,112,Command line hparams,
magenta/,114,Set default flags,
magenta/,120,Create training directory,
magenta/,125,Save the flags to help with loading the model latter,
magenta/,128,pytype: disable=wrong-arg-types,
magenta/,130,Run training,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,21,Hyperparameters,
magenta/,23,"'linear', 'phase'",
magenta/,27,Define Config,
magenta/,30,Training,
magenta/,41,Network,
magenta/,49,Loss Functions,
magenta/,57,STFT specific,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,159,Note when current_image_id >= min_total_num_images - 1 (which means we,
magenta/,160,"are already at the highest resolution), we want to keep progress constant.",
magenta/,161,"Therefore, cap current_image_id here.",
magenta/,366,Pad the 1 x 1 image to 2 * (start_h - 1) x 2 * (start_w - 1),
magenta/,367,with zeros for the next conv.,
magenta/,369,The output is start_h x start_w x num_filters_fn(1).,
magenta/,416,alpha_i is used to replace lod_select. Note sum(alpha_i) is,
magenta/,417,garanteed to be 1.,
magenta/,506,alpha_i is used to replace lod_select.,
magenta/,535,flatten,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,mel spectrum constants.,
magenta/,71,Validate input arguments,
magenta/,90,HTK excludes the spectrogram DC bin.,
magenta/,95,spectrogram_bins_mel = hertz_to_mel(linear_frequencies),
magenta/,97,"Compute num_mel_bins triples of (lower_edge, center, upper_edge). The",
magenta/,98,center of each band is the lower and upper edge of the adjacent bands.,
magenta/,99,"Accordingly, we divide [lower_edge_hertz, upper_edge_hertz] into",
magenta/,100,num_mel_bins + 2 pieces.,
magenta/,125,Calculate lower and upper slopes for every spectrogram bin.,
magenta/,126,"Line segments are linear in the mel domain, not Hertz.",
magenta/,132,Intersect the line segments with each other and zero.,
magenta/,135,Re-add the zeroed lower bins we sliced out above.,
magenta/,136,"[freq, mel]",
magenta/,214,Can lead to loss of precision.,
magenta/,218,Keep dphase bounded. N.B. runs faster than a single mod-2pi expression.,
magenta/,223,Add an initial phase to dphase.,
magenta/,258,Force audio length.,
magenta/,265,Force number of channels.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,38,Must be specified externally,
magenta/,42,Dataset,
magenta/,44,"linear, phase, mel",
magenta/,47,"specgrams_simple_normalizer, specgrams_freq_normalizer",
magenta/,56,Losses,
magenta/,57,Gradient norm target for wasserstein loss,
magenta/,60,Additional penalty to keep the scores from drifting too far from zero,
magenta/,62,Auxiliary loss for conditioning,
magenta/,65,Weight of G&L consistency loss,
magenta/,68,Optimization,
magenta/,69,Learning rate,
magenta/,70,Learning rate,
magenta/,71,Adam beta 1,
magenta/,72,Adam beta 2,
magenta/,73,The fake image batch size,
magenta/,75,Distributed Training,
magenta/,76,Name of the TensorFlow master to use,
magenta/,77,"The number of parameter servers. If the value is 0, then the parameters",
magenta/,78,are handled locally by the worker,
magenta/,80,The Task ID. This value is used when training with multiple workers to,
magenta/,81,identify each worker,
magenta/,84,Debugging,
magenta/,87,-----------  HPARAM Settings for testing eval,
magenta/,88,Progressive Training,
magenta/,89,"A list of batch sizes for each resolution, if len(batch_size_schedule)",
magenta/,90,"< num_resolutions, pad the schedule in the beginning with first batch size",
magenta/,97,"For fixed-wall-clock-time training, total training time limit in sec.",
magenta/,98,"If specified, overrides the iteration limits.",
magenta/,102,Architecture,
magenta/,103,Choose an architecture function,
magenta/,104,'specgram',
magenta/,108,Start specgram height,
magenta/,109,Start specgram width,
magenta/,110,Scale mode ALL|H,
magenta/,111,Resolution multiplier,
magenta/,112,N progressive resolutions,
magenta/,115,Number of filters,
magenta/,116,Base number of filters,
magenta/,141,Read the flags from the experiment.json file,
magenta/,142,experiment.json is in the folder above,
magenta/,143,Remove last '/' if present,
magenta/,151,Read json to dict,
magenta/,154,Load dict as a Flags() object,
magenta/,156,pylint: disable=broad-except,
magenta/,159,Set default flags,
magenta/,162,Get list_of_directories,
magenta/,168,Get last checkpoint,
magenta/,174,"Load the model, use eval_batch_size if present",
magenta/,195,gen_one_hot_labels = real_one_hot_labels,
magenta/,231,"Maximum value, must be float.",
magenta/,237,Add to config,
magenta/,248,Define model.,
magenta/,251,Get network functions and wrap with hparams,
magenta/,255,Extra lambda functions to conform to tfgan.gan_model interface,
magenta/,262,Define loss.,
magenta/,265,Auxiliary loss functions,
magenta/,284,Magnitude loss,
magenta/,287,Normalize loss to max,
magenta/,297,Loss weights,
magenta/,302,AC losses.,
magenta/,307,GL losses.,
magenta/,318,Total losses.,
magenta/,326,Update the loss functions,
magenta/,344,Define train ops.,
magenta/,350,Generator smoothing.,
magenta/,362,Separate path for generating samples with a placeholder (ph),
magenta/,363,Mapping of pitches to one-hot labels,
magenta/,369,"(label_ph, noise_ph) -> fake_wave_ph",
magenta/,381,config['train_time_limit'] * \,
magenta/,382,(float(stage_id+1) / ((2*config['num_resolutions'])-1)),
magenta/,386,Add variables as properties,
magenta/,441,"When making prediction, use the ema smoothed generator vars by",
magenta/,442,`_custom_getter`.,
magenta/,451,Set shapes,
magenta/,457,Generate waves and summaries,
magenta/,458,Convert to audio,
magenta/,461,Wave summaries,
magenta/,464,Spectrogram summaries,
magenta/,496,Create list of pitches to generate,
magenta/,523,Pads zeros to make batches even batch size.,
magenta/,527,Generate waves,
magenta/,537,Trim waves,
magenta/,541,Remove waves corresponding to the padded zeros.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,101,Instantaneous Frequency in numpy,
magenta/,105,Append with initial phase,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,114,remove quotes for string argument.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,186,"data_np: [N, time, freq, channels]",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,61,"If fresh start, start with start_stage_id = 0",
magenta/,62,"If has been trained for n = len(train_sub_dirs) stages, start with the last",
magenta/,63,"stage, i.e. start_stage_id = n - 1.",
magenta/,130,Even stage_id: stable training stage.,
magenta/,131,Odd stage_id: transition training stage.,
magenta/,298,"When making prediction, use the ema smoothed generator vars.",
magenta/,365,Holds variables that from the previous stage and need to be restored.,
magenta/,376,Holds variables created in the new block of the current stage. If the,
magenta/,377,"current stage is a stable stage (except the initial stage), this list",
magenta/,378,will be empty.,
magenta/,386,Every variables that are 1) not for optimizers and 2) from the new block,
magenta/,387,need to be restored.,
magenta/,393,Add saver op to graph. This saver is used to restore variables from the,
magenta/,394,previous stage.,
magenta/,397,Add the op to graph that initializes all global variables.,
magenta/,401,First initialize every variables.,
magenta/,404,Then overwrite variables saved in previous stage.,
magenta/,408,Use a dummy init_op here as all initialization is done in init_fn.,
magenta/,447,type: float,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,53,Power of two only has 1 nonzero in binary representation,
magenta/,69,"For Nsynth dataset, we are putting all padding in the front",
magenta/,70,This causes edge effects in the tail,
magenta/,119,Python does not allow rslice of -0,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,37,"inputs = (noises, one_hot_labels)",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,66,Handles out of bounds errors.,
magenta/,84,attack envelope doesn't add to sound length,
magenta/,86,Linear attack,
magenta/,88,Linear release,
magenta/,112,Generate an amplitude envelope,
magenta/,117,Normalize,
magenta/,120,Add to clip buffer,
magenta/,125,Normalize,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,114,Filter just acoustic instruments (as in the paper),
magenta/,115,"(0=acoustic, 1=electronic, 2=synthetic)",
magenta/,117,Filter just pitches 24-84,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,40,Reduce batch size and audio length to speed up test,
magenta/,46,Test the standard configuration of SpecgramsHelper,
magenta/,71,"Transform the data, test shape",
magenta/,79,"Reconstruct the audio, test shape",
magenta/,85,Test reconstruction error,
magenta/,86,Mel compression adds differences so skip,
magenta/,88,Edges have known differences due to windowing,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,pylint:disable=g-bad-exception-name,
magenta/,33,TODO(adarob): Replace with tf.saver.checkpoint_file_exists when released.,
magenta/,120,Either self._checkpoint or self._bundle should be set.,
magenta/,121,This is enforced by the constructor.,
magenta/,123,Check if the checkpoint file exists.,
magenta/,128,"If this is a directory, try to determine the latest checkpoint in it.",
magenta/,141,Write checkpoint and metagraph files to a temp dir.,
magenta/,147,"For now, we support only 1 checkpoint file.",
magenta/,148,"If needed, we can later change this to support sharded checkpoints.",
magenta/,157,Clean up the temp dir.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,80,Test with non-bundle generator.,
magenta/,84,Test with bundle-based generator.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,89,TODO(adarob): Limit to a single epoch each evaluation step.,
magenta/,147,Reset timer.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,26,pylint: disable=redefined-builtin,
magenta/,30,"Model state when generating event sequences, consisting of the next inputs to",
magenta/,31,"feed the model, the current RNN state, the current control sequence (if",
magenta/,32,"applicable), and state for the current control sequence (if applicable).",
magenta/,122,"For backwards compatibility, we only try to pass temperature if the",
magenta/,123,placeholder exists in the graph.,
magenta/,144,"The inputs batch is longer than a single step, so we also want to",
magenta/,145,compute the log-likelihood of the event sequences up until the step,
magenta/,146,we're generating.,
magenta/,199,Split the sequences to extend into batches matching the model batch size.,
magenta/,204,Extract inputs and RNN states from the model states.,
magenta/,208,Also extract control sequences and states.,
magenta/,217,Add padding to fill the final batch.,
magenta/,227,Generate a single step for one batch of event sequences.,
magenta/,237,Construct inputs for next step.,
magenta/,239,We are conditioning on control sequences.,
magenta/,241,Extend each control sequence to ensure that it is longer than the,
magenta/,242,corresponding event sequence.,
magenta/,252,Modify event sequences and inputs for next step.,
magenta/,332,"Sequence is already long enough, no need to generate.",
magenta/,337,Construct inputs for first step after primer.,
magenta/,339,We are conditioning on a control sequence. Make sure it is longer than,
magenta/,340,the primer sequence.,
magenta/,350,Modify event sequences and inputs for first step after primer.,
magenta/,357,Beam search will maintain a state for each sequence consisting of the next,
magenta/,358,"inputs to feed the model, and the current RNN state. We start out with the",
magenta/,359,initial full inputs batch and the zero state.,
magenta/,409,"For backwards compatibility, we only try to pass temperature if the",
magenta/,410,placeholder exists in the graph.,
magenta/,452,"Since we're computing log-likelihood and not generating, the inputs batch",
magenta/,453,doesn't need to include the final event in each sequence.,
magenta/,455,We are conditioning on a control sequence.,
magenta/,469,Evaluate a single step for one batch of event sequences.,
magenta/,479,There's an extra non-full batch. Pad it with a bunch of copies of the,
magenta/,480,final sequence.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,Read in bundle file.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,59,Add attention wrapper to first layer.,
magenta/,122,We can make a single call to CudnnLSTM since all layers are the same,
magenta/,123,size and we aren't using residual connections.,
magenta/,136,At generation time we use CudnnCompatibleLSTMCell.,
magenta/,146,"We need to make multiple calls to CudnnLSTM, keeping the initial and final",
magenta/,147,states at each layer.,
magenta/,152,If we're using residual connections and this layer is not the same size,
magenta/,153,"as the previous layer, we need to project into the new size so the",
magenta/,154,(projected) input can be added to the output.,
magenta/,177,At generation time we use CudnnCompatibleLSTMCell.,
magenta/,314,Compute the total number of time steps across all sequences in the,
magenta/,315,batch. For some models this will be different from the number of RNN,
magenta/,316,steps.,
magenta/,376,Perplexity is just exp(loss) and doesn't need its own update op.,
magenta/,407,Flatten state tuples for metagraph compatibility.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,215,"If dataset.path is a list, then it's a list of sources to mix together",
magenta/,216,"to form new examples. First, do the mixing, then pass the results to",
magenta/,217,the rest of the pipeline.,
magenta/,228,Note that we do not specify a coder when reading here.,
magenta/,229,This is so that the hashing in key_example below can work directly,
magenta/,230,on the serialized version instead of having to re-serialize it.,
magenta/,231,"Also, deserializing with a coder and then re-serializing does not",
magenta/,232,always generate the same hash for the same example (likely due to,
magenta/,233,the map fields in tf.train.Example). This is important when reading,
magenta/,234,the same dataset multiple times to mix it with itself.,
magenta/,240,Key all examples with a hash.,
magenta/,247,Create a list of source_id to example id.,
magenta/,254,"('example_hash', serialized_example)",
magenta/,259,"('source_id, 'example_hash')",
magenta/,264,"Pass the list of source id to example IDs to generate_mixes,",
magenta/,265,which will create mixes by selecting random IDs from each source,
magenta/,266,(with replacement). This is represented as a list of example IDs,
magenta/,267,to Mix IDs.,
magenta/,268,Note: beam.Create([0]) is just a single dummy value to allow the,
magenta/,269,sourceid_to_exids to be passed in as a python list so we can do the,
magenta/,270,sampling with numpy.,
magenta/,277,"Create a list of (Mix ID, Full Example proto). Note: Examples may be",
magenta/,278,"present in more than one mix. Then, group by Mix ID.",
magenta/,289,"Take these groups of Examples, mix their audio and sequences to return",
magenta/,290,"a single new Example. Then, carry on with the rest of the pipeline",
magenta/,291,like normal.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,43,A0,
magenta/,79,Ensure onsets take up only a single frame during pianoroll,
magenta/,80,generation.,
magenta/,87,10ms,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,66,Flatten while preserving batch and time dimensions.,
magenta/,137,"for consistency with cudnn, here we just return the top of the stack,",
magenta/,138,"although this can easily be altered to do other things, including be",
magenta/,139,more resnet like,
magenta/,252,onset_probs_flat is used during inference.,
magenta/,272,offset_probs_flat is used during inference.,
magenta/,307,TODO(eriche): this is broken when hparams.frame_lstm_units > 0,
magenta/,456,Include some features and labels in output because Estimator 'predict',
magenta/,457,API does not give access to them.,
magenta/,471,"Creates a pianoroll labels in red and probs in green [minibatch, 88]",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,59,Flatten while preserving batch and time dimensions.,
magenta/,125,Uses tflite compatible LSTM cell. The graph is name-compatible,
magenta/,126,with the graph created by lstm_layer.,
magenta/,128,Dropout not implemented for this mode.,
magenta/,129,Only used for dropout.,
magenta/,131,Static RNNs will take a list of input tensors instead of a single block,
magenta/,132,"tensor. I.e. we need to convert from Tensor(size=[batch, time, width]) to",
magenta/,133,"a list=[Tensor(size=[batch, width])] of length 'time'",
magenta/,139,Here we use the basic LSTMCell which tflite knows about and fudging it so,
magenta/,140,that it sets it's scopes as if it was a,
magenta/,141,tf.contrib.cudnn_rnn.BasicLSTMCell,
magenta/,153,This emulates the scoping that contrib.rnn.stack_bidirectional_dynamic_rnn,
magenta/,154,does.,
magenta/,167,not bidirectional,
magenta/,175,We gotta undo our earlier split and fuse it back into a single tensor.,
magenta/,186,default to lstm_layer,
magenta/,253,TODO(eriche): this is broken when hparams.frame_lstm_units > 0,
magenta/,329,"Hack to restore the batch dimension, which is lost in some cases.",
magenta/,356,20 seconds,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,60,Iterate through all note on events,
magenta/,76,"if the last note is the same time as the end, don't add it",
magenta/,77,remove the start instead of creating a sequence with 0 length,
magenta/,97,use np instead of python for loop for speed,
magenta/,158,check for interval in sustained sequence,
magenta/,163,"if no interval, or we didn't fit, try the unmodified sequence",
magenta/,165,"no splits available, use non sustain notes and find close zero crossing",
magenta/,169,"we fit, great, try to split at a zero crossing",
magenta/,179,give up and just return where there are at least no notes,
magenta/,183,"there are no good places to cut, so just pick the last zero crossing",
magenta/,184,check the entire valid range for zero crossings,
magenta/,194,give up and advance by max amount,
magenta/,197,only advance as far as max_length,
magenta/,204,ensure that we've generated a valid sequence of splits,
magenta/,220,Ensure that all sequences for training and evaluation have gone through,
magenta/,221,sustain processing.,
magenta/,282,Add padding to samples if notesequence is longer.,
magenta/,319,the resampling that happen in crop_wav_data is really slow,
magenta/,320,"and we've already done it once, avoid doing it twice",
magenta/,346,Normalize samples and sequence velocities before mixing.,
magenta/,347,This ensures that the velocities/loudness of the individual samples,
magenta/,348,are treated equally.,
magenta/,358,Ensure that samples are always at least as long as their paired sequences.,
magenta/,366,Repeat each ns/wav pair to be as long as the longest wav.,
magenta/,379,Mix samples and sequences together,
magenta/,388,Process sustain changes before copying notes.,
magenta/,392,TODO(fjord): Manage instrument/program numbers.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,35,unused,
magenta/,233,pylint:disable=g-long-lambda,
magenta/,264,Include some features and labels in output because Estimator 'predict',
magenta/,265,API does not give access to them.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,33,Should be dropped because it is 0 duration.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,143,samples1 will be .1 seconds shorter than sequence1,
magenta/,169,We expect samples1 to have 2 samples of padding and samples2 to be,
magenta/,170,repeated 1 time fully and once with a single sample.,
magenta/,246,Expected time is 1.9 because the sequences are repeated according to the,
magenta/,247,length of their associated audio. So sequence1 is not repeated at all,
magenta/,248,(audio is 2 seconds) and sequence2 is repeated once after shifting all the,
magenta/,249,notes by the audio length of 1 second. The final total_time is left as is,
magenta/,250,"after the last repeat, so it ends up being 1 + .9 seconds.",
magenta/,291,previous max was .5,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,29,Should not be called from within the graph to avoid redundant summaries.,
magenta/,41,Create a markdown table from hparams.,
magenta/,74,Workaround for Estimator API that forces 'labels' to be None when in,
magenta/,75,predict mode.,
magenta/,76,https://github.com/tensorflow/tensorflow/issues/17824,
magenta/,77,See also infer_util.labels_to_features_wrapper,
magenta/,175,"If num_steps is specified, we will evaluate only a subset of the data.",
magenta/,176,,
magenta/,177,The following is a hack that works around the problems of not being able,
magenta/,178,to determine the number of records in a given TFRecord shard without,
magenta/,179,reading the whole thing and not being able to persist a tf.data.Dataset,
magenta/,180,session across multiple estimator evaluate calls.,
magenta/,181,,
magenta/,182,This code tries to select a different subset for every evaluation by doing,
magenta/,183,the following:,
magenta/,184,- Setting shuffle_examples=True. This shuffles not only individual,
magenta/,185,"examples, but also shuffles the order in which shards are read.",
magenta/,186,"- Skipping N examples before starting evaluation, where N is selected",
magenta/,187,randomly for each evaluation run. This provides a different starting,
magenta/,188,offset.,
magenta/,190,"In order to skip a random number of records, we need to provide an upper",
magenta/,191,bound that will still let us run num_steps evaluation steps before running,
magenta/,192,out of data. The following code does a one-time check on startup to see,
magenta/,193,"if there are up to num_steps * 5 records available, which would allow",
magenta/,194,"a maximum skip range of [0, num_steps*4].",
magenta/,218,Determine max number of records we could skip and still have num_steps,
magenta/,219,records remaining.,
magenta/,226,"Since we're doing a limited number of steps, we should shuffle the",
magenta/,227,examples we're evaluating so each evaluation is over a different portion,
magenta/,228,of the dataset.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,67,decode to handle filenames with extended characters.,
magenta/,114,The reason we bounce between two Dataset objects is so we can use,
magenta/,115,the data processing functionality in data.py without having to,
magenta/,116,construct all the Example protos in memory ahead of time or create,
magenta/,117,a temporary tfrecord file.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,95,Use base names.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,145,Workaround for Estimator API that forces 'labels' to be None when in,
magenta/,146,predict mode.,
magenta/,147,https://github.com/tensorflow/tensorflow/issues/17824,
magenta/,148,See also train_util.create_estimator,
magenta/,168,Show overlap in yellow,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,"The base pipeline is a list of stages, each of which consists of a name",
magenta/,31,(corresponding to a SoX function) and a dictionary of parameters with name,
magenta/,32,(corresponding to an argument to the SoX function) and min and max values,
magenta/,33,along with the scale (linear or log) used to sample values. The min and max,
magenta/,34,values can be overridden with hparams.,
magenta/,36,Pitch shift.,
magenta/,41,Contrast (simple form of compression).,
magenta/,46,Two independent EQ modifications.,
magenta/,58,Reverb (for now just single-parameter).,
magenta/,64,Default hyperparameter values from the above pipeline. Note the additional,
magenta/,65,"`transform_audio` hparam that defaults to False, i.e. by default no audio",
magenta/,66,transformation will be performed.,
magenta/,245,Add noise before all other pipeline steps.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,35,Disable for Numpy and Pandas containers.,
magenta/,36,pylint: disable=g-explicit-length-test,
magenta/,53,mir_eval does not allow notes that start and end at the same time.,
magenta/,60,"Reshape intervals to ensure that the second dim is 2, even if the list is",
magenta/,61,of size 0. mir_eval functions will complain if intervals is not shaped,
magenta/,62,appropriately.,
magenta/,204,Pad transcribed frames with silence.,
magenta/,209,Truncate transcribed frames.,
magenta/,259,Return 1-d tensors for the metrics,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,33,"Requested 100, but there are only 4 unique mixes, so that's how many",
magenta/,34,we should end up with.,
magenta/,43,Ensure we get the number of mixes we requested even when more unique mixes,
magenta/,44,would be possible.,
magenta/,54,"There are only 3 unique ids, but we're request mixes of 3 items, so only",
magenta/,55,1 unique mix is possible.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,81,Command line flags override any of the preceding hyperparameter values.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,22,Names for pitches in the Groove MIDI Dataset and Expanded Groove MIDI Dataset.,
magenta/,46,New,
magenta/,55,Drum hit mappings.,
magenta/,56,Each mapping is an array of arrays containing pitches.  Each internal array,
magenta/,57,represents a pitch class. The first element of each pitch class is the base,
magenta/,58,pitch to which all other pitches in the class will be mapped.,
magenta/,61,kick drum,
magenta/,64,"hi-hats (including cymbals, maracas, cowbell)",
magenta/,67,snare drum (including toms),
magenta/,71,Kick,
magenta/,74,"Snare,X-stick, handclap",
magenta/,77,Toms + (Low_Conga extra),
magenta/,80,HH + Tambourine + (Maracas extra),
magenta/,83,Ride,
magenta/,86,Ride bell+ cow bell,
magenta/,89,Crashes,
magenta/,92,Clave / Sticks,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,25,Retain only mixes with unique lists of examples.,
magenta/,28,Retain only unique mixes.,
magenta/,35,Brute force way to ensure every example from every source is used at least,
magenta/,36,"once. Just goes through every source, selects each example, and generates",
magenta/,37,a mix using random examples from other sources.,
magenta/,38,"Number of final outputs is variable, depending on how many end up getting",
magenta/,39,deduped.,
magenta/,54,"Generate 5x the number of mixes requested. We'll dedup them later, so",
magenta/,55,this helps increase the chance we'll end up with as many as requested.,
magenta/,56,"This isn't guaranteed to always work, but it almost always will and is",
magenta/,57,easier than trying to generate every possible mix and sampling from that,
magenta/,58,since the numbers blow up pretty quickly.,
magenta/,68,Make the selection deterministic,
magenta/,73,"First, generate mixes ensuring that every example is used at least once.",
magenta/,80,"We need more mixes, so generate some random ones, then crop the excess",
magenta/,81,"from the random mixes, ensuring that we preserve the mixes that use every",
magenta/,82,example at least once.,
magenta/,86,If the random mixes happened to include any of the mixes we already,
magenta/,87,"generated, remove them.",
magenta/,89,Do a random crop.,
magenta/,92,Combine the two mix lists.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,107,Remove batch dimension for convenience.,
magenta/,131,Make filenames UNIX-friendly.,
magenta/,145,Also write a pianoroll showing acoustic model output vs labels.,
magenta/,150,Calculate frames based on the sequence. Includes any postprocessing done,
magenta/,151,to turn raw onsets/frames predictions into the final sequence.,
magenta/,152,TODO(fjord): This work is duplicated in metrics.py.,
magenta/,169,Update histogram and current scalar for metrics.,
magenta/,185,Write final mean values for all metrics.,
magenta/,203,Batch size should always be 1 for inference.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,65,find matching mid files,
magenta/,78,load the wav data,
magenta/,80,load the midi data and convert to a notesequence,
magenta/,95,find matching mid files,
magenta/,107,load the wav data and resample it.,
magenta/,111,load the midi data and convert to a notesequence,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,63,This method re-implements a portion of the TensorFlow graph using numpy.,
magenta/,64,While typically it is frowned upon to test complicated code with other,
magenta/,65,"code, there is no way around this for testing the pipeline end to end,",
magenta/,66,"which requires an actual spec computation. Furthermore, much of the",
magenta/,67,"complexity of the pipeline is due to the TensorFlow implementation,",
magenta/,68,so comparing it against simpler numpy code still provides effective,
magenta/,69,coverage.,
magenta/,73,Pad or slice spec if differs from truncated_length.,
magenta/,80,Pad or slice labels if differs from truncated_length.,
magenta/,145,Wait to ensure example is pre-processed.,
magenta/,152,Add batch padding if needed.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,73,"Transpose so that the data is in [frame, bins] format.",
magenta/,90,"Transpose so that the data is in [frame, bins] format.",
magenta/,103,Fill in everything but the last frame which may not be the full length,
magenta/,106,Fill the last frame,
magenta/,151,Ensure that we decoded the samples at the expected sample rate.,
magenta/,169,"False here, but would be True on device.",
magenta/,176,"Compute a hash of the spectrogram, save it as an int64.",
magenta/,177,Uses adler because it's fast and will fit into an int (md5 is too large).,
magenta/,348,"if there is combined jitter, we must generate it once here",
magenta/,356,possibly shift the entire sequence backward for better forward only training,
magenta/,442,Slice specs and labels tensors so they are no longer than truncated_length.,
magenta/,457,"If max_expected_train_example_len is set, ensure that all examples are",
magenta/,458,padded to this length. This results in a fixed shape that can work on TPUs.,
magenta/,460,"In this case, final_length is a constant.",
magenta/,469,"In this case, it is min(hparams.truncated_length, length)",
magenta/,586,Read examples from a TFRecord file containing serialized NoteSequence,
magenta/,587,and audio.,
magenta/,590,Could be a glob pattern.,
magenta/,594,"If we've already expanded the list of sharded filenames, don't send to",
magenta/,595,Dataset.list_files because that will attempt to execute a potentially,
magenta/,596,slow (especially for network filesystems) glob expansion on each entry,
magenta/,597,in the already expanded list.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,42,Model specific constants.,
magenta/,91,Use axis 0 to stack but then shove the axis to the end so its,
magenta/,92,"[time, midinote (0-88), {frame,onset, offset, velocity}]",
magenta/,93,"The first 3 are logits, the last is simply the velocity",
magenta/,96,TODO(fjord): Add onset filtering similar to our regular inference,
magenta/,97,setup.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,82,How many frames of audio PyAudio will fetch at once.,
magenta/,83,Higher numbers will increase the latancy.,
magenta/,86,Limit queue to this number of audio chunks.,
magenta/,89,Timeout if we can't get a chunk from the queue for timeout_factor times the,
magenta/,90,chunk duration.,
magenta/,158,unused args to match expected,
magenta/,262,"Read the wav file, converting sample rate & number of channels.",
magenta/,264,pylint: disable=broad-except,
magenta/,267,Convert to float32.,
magenta/,269,Already float32.,
magenta/,273,Convert to mono and the desired sample rate.,
magenta/,278,pylint: disable=broad-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,84,Initialize recorder.,
magenta/,109,Extract overlapping,
magenta/,119,Keep the remaining bytes for next time,
magenta/,123,This actually executes in each worker thread!,
magenta/,157,+ str(n//12),
magenta/,160,TODO(mtyka) Ensure serial stitching of results (no guarantee that,
magenta/,161,the blocks come in in order but they are all timestamped),
magenta/,195,Only the first 10 seconds,
magenta/,198,Extend samples with zeros,
magenta/,211,Make and start the workers,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,72,Force all input processing onto CPU in order to reserve the GPU for the,
magenta/,73,forward inference and back-propagation.,
magenta/,79,"Load style images and select one at random (for each graph execution, a",
magenta/,80,new random selection occurs),
magenta/,87,Process style and weight flags,
magenta/,99,Rescale style weights dynamically based on the current style image,
magenta/,105,Define the model,
magenta/,116,Compute losses.,
magenta/,128,Function to restore VGG16 parameters.,
magenta/,132,Function to restore N-styles parameters.,
magenta/,140,Set up training.,
magenta/,146,Run training.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,59,Define input tensor as placeholder to allow export,
magenta/,65,Load the graph definition from Magenta,
magenta/,77,Load model weights from downloaded checkpoint file,
magenta/,80,Write SavedModel for serving or conversion to TF Lite,
magenta/,96,Append filename if output_model is a directory name,
magenta/,104,Initialize TF Lite Converter,
magenta/,112,Specify quantization option,
magenta/,116,Convert and save the TF Lite model,
magenta/,127,Load model weights from trained checkpoint and export to SavedModel format,
magenta/,131,Convert from SavedModel to TensorFlow Lite format,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,86,We use 'pool5' instead of 'fc8' because a) fully-connected,
magenta/,87,layers are already too deep in the network to be useful for,
magenta/,88,style and b) they're quite expensive to store.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,66,Create filename_queue.,
magenta/,78,Approximate number of examples per shard.,
magenta/,80,Size the random shuffle queue to balance between good global,
magenta/,81,mixing (more examples) and memory use (fewer examples).,
magenta/,82,1 image uses 299*299*3*4 bytes = 1MB,
magenta/,83,The default input_queue_memory_factor is 16 implying a shuffling queue,
magenta/,84,size: examples_per_shard * 16 * 1MB = 17.6GB,
magenta/,92,Create multiple readers to populate the queue of examples.,
magenta/,105,Parse a serialized Example proto to extract the image and metadata.,
magenta/,110,pylint: disable=protected-access,
magenta/,113,pylint: enable=protected-access,
magenta/,126,Display the training images in the visualizer.,
magenta/,290,Force all input processing onto CPU in order to reserve the GPU for the,
magenta/,291,forward inference and back-propagation.,
magenta/,364,Selects a random size for the style images and resizes all the images,
magenta/,365,in the batch to that size.,
magenta/,403,Workaround for black-and-white images,
magenta/,441,Center-crop into a square and resize to image_size,
magenta/,520,The following functions are copied over from,
magenta/,521,tf.slim.preprocessing.vgg_preprocessing,
magenta/,522,because they're not visible to this module.,
magenta/,559,Use tf.strided_slice instead of crop_to_bounding box as it accepts tensors,
magenta/,560,to define the crop size.,
magenta/,688,Dense features in Example proto.,
magenta/,698,Sparse features in Example proto.,
magenta/,713,"Note that we impose an ordering of (y, x) just to make life difficult.",
magenta/,716,Force the variable number of bounding boxes into the shape,
magenta/,717,"[1, num_boxes, coords].",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,105,Allocate parameters for the beta and gamma of the normalization.,
magenta/,113,Calculate the moments on the last axis (instance activations).,
magenta/,115,Compute layer normalization using the batch_normalization function.,
magenta/,203,Allocate parameters for the beta and gamma of the normalization.,
magenta/,211,Calculate the moments on the last axis (instance activations).,
magenta/,213,Compute layer normalization using the batch_normalization function.,
magenta/,290,Allocates parameters for the beta and gamma of the normalization.,
magenta/,294,Calculates the moments on the last axis (instance activations).,
magenta/,297,Compute layer normalization using the batch_normalization function.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,71,Propagate the input and its stylized version through VGG16.,
magenta/,75,Compute the content loss,
magenta/,79,Compute the style loss,
magenta/,83,Compute the total loss,
magenta/,112,Reducing over all but the batch axis before multiplying with the content,
magenta/,113,weights allows to use multiple sets of content weights in a single batch.,
magenta/,148,Reducing over all but the batch axis before multiplying with the style,
magenta/,149,weights allows to use multiple sets of style weights in a single batch.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,67,"Create inputs in [0, 1], as expected by vgg_16.",
magenta/,72,Process style and weight flags,
magenta/,83,Load style images.,
magenta/,97,Dummy call to simplify the reuse logic,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,==============================================================================,
magenta/,57,Bounding box data consists of 615299 bounding boxes for 544546 images.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,66,Force all input processing onto CPU in order to reserve the GPU for the,
magenta/,67,forward inference and back-propagation.,
magenta/,73,"Load style images and select one at random (for each graph execution, a",
magenta/,74,new random selection occurs),
magenta/,84,Process style and weight flags,
magenta/,96,Rescale style weights dynamically based on the current style image,
magenta/,102,Define the model,
magenta/,113,Compute losses.,
magenta/,120,Adding Image summaries to the tensorboard.,
magenta/,125,Set up training,
magenta/,131,Function to restore VGG16 parameters.,
magenta/,135,Run training,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,124,Load image,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,106,Use conv2d instead of fully_connected layers.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,26,FFT Specgram Shapes,
magenta/,27,pylint:disable=g-complex-comprehension,
magenta/,35,pylint:enable=g-complex-comprehension,
magenta/,92,random crop,
magenta/,102,fixed center crop,
magenta/,103,24320,
magenta/,136,Get Specgrams,
magenta/,156,Pad and crop specgram to 256x256,
magenta/,164,Form a Batch,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,26,pylint: disable=redefined-builtin,
magenta/,37,===============================================================================,
magenta/,38,WaveNet Functions,
magenta/,39,===============================================================================,
magenta/,136,Max sample length is the data length,
magenta/,139,Multiple of hop_length,
magenta/,141,Trim,
magenta/,143,Assume all examples are the same length,
magenta/,145,Max sample length is the data length,
magenta/,148,Multiple of hop_length,
magenta/,150,Trim,
magenta/,156,===============================================================================,
magenta/,157,Baseline Functions,
magenta/,158,===============================================================================,
magenta/,159,---------------------------------------------------,
magenta/,160,Pre/Post-processing,
magenta/,161,---------------------------------------------------,
magenta/,232,"Magnitudes, scaled 0-1",
magenta/,240,Derivative of phase,
magenta/,245,Normal phase,
magenta/,247,Mask the phase,
magenta/,250,Return Mag and Phase,
magenta/,331,Roll up phase,
magenta/,336,Magnitudes,
magenta/,416,Add back in nyquist frequency,
magenta/,427,---------------------------------------------------,
magenta/,428,Summaries,
magenta/,429,---------------------------------------------------,
magenta/,501,Must divide minibatch evenly,
magenta/,648,---------------------------------------------------,
magenta/,649,Neural Nets,
magenta/,650,---------------------------------------------------,
magenta/,749,For residual,
magenta/,751,Choose convolution function,
magenta/,753,Double output channels for gates,
magenta/,758,Apply a stack of convolutions Before adding residual,
magenta/,762,Use interpolation to upsample instead of conv_transpose,
magenta/,789,Apply residual to last layer  before the last nonlinearity,
magenta/,792,Don't upsample residual in time,
magenta/,795,Make n_channels match for residual,
magenta/,849,create queue,
magenta/,859,get pretrained weights,
magenta/,870,perform op w/ cached states,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,70,"If ps_tasks is 0, the local device is used. When using multiple",
magenta/,71,"(non-local) replicas, the ReplicaDeviceSetter distributes the variables",
magenta/,72,across the different devices.,
magenta/,76,Run the Reader on the CPU,
magenta/,90,Run training,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,93,Make the graph,
magenta/,99,Load the trained model with is_training=False,
magenta/,112,Add ops to save and restore all the variables.,
magenta/,113,Restore variables from disk.,
magenta/,118,Start up some threads,
magenta/,134,"Report all exceptions to the coordinator, pylint: disable=broad-except",
magenta/,137,pylint: enable=broad-except,
magenta/,140,Terminate as usual.  It is innocuous to request stop twice.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,41,Optimization,
magenta/,48,Preprocessing,
magenta/,60,Graph,
magenta/,61,dimension of z.,
magenta/,64,Frequency weighted cost,
magenta/,67,Set values from a dictionary in the config,
magenta/,90,Magnitude,
magenta/,100,Phase,
magenta/,105,"Von Mises Distribution ""Circular Normal""",
magenta/,106,"Added constant to keep positive (Same Probability) range [0, 2]",
magenta/,131,Add height and channel dims,
magenta/,136,Define the model,
magenta/,141,For interpolation,
magenta/,147,Compute losses,
magenta/,150,Apply optimizer,
magenta/,181,Add height and channel dims,
magenta/,186,Define the model,
magenta/,191,For interpolation,
magenta/,199,Define the metrics:,
magenta/,204,Define the summaries,
magenta/,208,Interpolate,
magenta/,212,Linear interpolation,
magenta/,218,Pitch shift,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,66,Make temp dir,
magenta/,69,Make wav files,
magenta/,75,Load the files,
magenta/,88,Make temp dir,
magenta/,91,Make wav files,
magenta/,97,Load the files,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,95,Ensure that files has batch_size elements.,
magenta/,103,Load up the model for encoding and find the encoding,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,53,Use directory of files,
magenta/,69,Use a single file,
magenta/,77,Now synthesize from files one batch at a time,
magenta/,89,Encode waveforms,
magenta/,95,Or load encodings,
magenta/,99,Synthesize multi-gpu,
magenta/,104,Single gpu,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,75,Run the Reader on the CPU,
magenta/,92,pylint: disable=cell-var-from-loop,
magenta/,97,pylint: enable=cell-var-from-loop,
magenta/,100,build the model graph,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,48,Encode the source with 8-bit Mu-Law.,
magenta/,61,,
magenta/,62,The WaveNet Decoder.,
magenta/,63,,
magenta/,79,Set up skip connections.,
magenta/,82,Residual blocks with skip connections.,
magenta/,86,dilated masked cnn,
magenta/,101,local conditioning,
magenta/,104,gated cnn,
magenta/,109,residuals,
magenta/,112,skips,
magenta/,120,,
magenta/,121,Compute the logits and get the loss.,
magenta/,122,,
magenta/,208,Encode the source with 8-bit Mu-Law.,
magenta/,215,,
magenta/,216,The Non-Causal Temporal Encoder.,
magenta/,217,,
magenta/,253,"Depending on the accelerator used for training, masked.pool1d may",
magenta/,254,lead to out of memory error.,
magenta/,255,reduce_mean is equivalent to masked.pool1d when the stride is the same,
magenta/,256,as the window length (which is the case here).,
magenta/,267,,
magenta/,268,The WaveNet Decoder.,
magenta/,269,,
magenta/,278,Set up skip connections.,
magenta/,286,Residual blocks with skip connections.,
magenta/,339,,
magenta/,340,Compute the logits and get the loss.,
magenta/,341,,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,99,"Load up the model for encoding and find the encoding of ""wav_data""",
magenta/,124,Load the data,
magenta/,128,Add padding if less than sample length,
magenta/,135,Return as an numpy array,
magenta/,154,Load the data,
magenta/,161,Add padding or crop if not equal to sample length,
magenta/,168,Return as an numpy array,
magenta/,218,Get lengths,
magenta/,223,initialize queues w/ 0s,
magenta/,226,Regenerate the audio file sample by sample,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,48,assert mask is constant across pitch,
magenta/,50,get rid of pitch dimension and transpose to get landscape orientation,
magenta/,123,sample a mask size,
magenta/,125,sample a mask of size k,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,114,append or overwrite such that we retain every `subsample_factor`th value,
magenta/,115,and the most recent value,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,56,"If a checkpoint directory is not specified, see if there is only one",
magenta/,57,subdir in this folder and use that.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,48,Dataset.,
magenta/,65,Model architecture.,
magenta/,68,Hparams for depthwise separable conv.,
magenta/,76,Hparams for reducing pointwise in separable convs.,
magenta/,83,Hparams for dilated conv.,
magenta/,99,Mask related.,
magenta/,115,Run parameters.,
magenta/,150,Update tfpopstat variables.,
magenta/,159,reduce variance in validation loss by fixing the seed,
magenta/,173,Evaluate the graph and run back propagation.,
magenta/,183,Aggregate performances.,
magenta/,185,Multiply the mean loss_mask by reduced_mask_size for aggregation as the,
magenta/,186,mask size could be different for every batch.,
magenta/,195,Collect run statistics.,
magenta/,204,Make summaries.,
magenta/,237,Get data.,
magenta/,250,Save hparam configs.,
magenta/,258,Build the graph and subsequently running it for train and validation.,
magenta/,262,"Build placeholders and training graph, and validation graph with reuse.",
magenta/,274,Graph will be finalized after instantiating supervisor.,
magenta/,286,Run training.,
magenta/,290,Run validation.,
magenta/,316,"NOTE: age is reset with decay, but true_age is not",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,120,"pianorolls, masks = self.inputs['pianorolls'], self.inputs[",
magenta/,121,'masks'],
magenta/,125,"flip meaning of mask for convnet purposes: after flipping, mask is hot",
magenta/,126,where values are known. this makes more sense in light of padding done,
magenta/,127,"by convolution operations: the padded area will have zero mask,",
magenta/,128,indicating no information to rely on.,
magenta/,134,"If not training, don't need to add optimizer to the graph.",
magenta/,146,FIXME 0.5 -> hparams.decay_rate,
magenta/,158,don't use tf.nn.softmax_cross_entropy because we need the shape to,
magenta/,159,remain constant,
magenta/,167,construct mask to identify zero padding that was introduced to,
magenta/,168,make the batch rectangular,
magenta/,174,"construct mask and its complement, respecting pad mask",
magenta/,178,Compute numbers of variables,
magenta/,179,#timesteps * #variables per timestep,
magenta/,186,Compute numbers of variables to be predicted/conditioned on,
magenta/,194,Compute average loss over entire set of variables,
magenta/,197,Compute separate losses for masked/unmasked variables,
magenta/,198,NOTE: indexing the pitch dimension with 0 because the mask is constant,
magenta/,199,"across pitch. Except in the sigmoid case, but then the pitch dimension",
magenta/,200,will have been reduced over.,
magenta/,214,Check which loss to use as objective function.,
magenta/,242,shape mismatch; e.g. change in number of filters,
magenta/,256,Instantiate or retrieve filter weights.,
magenta/,297,TODO(annahuang): support non equal splits.,
magenta/,304,Compute batch normalization or add biases.,
magenta/,348,make update happen when mean/variance are used,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,25,,
magenta/,26,Samplers,
magenta/,27,,
magenta/,28,Composable strategies for filling in a masked-out block,
magenta/,74,pylint: disable=unexpected-special-method-signature,
magenta/,177,"bb, tt, pp, ii = pianorolls.shape",
magenta/,181,determine how many model evaluations we need to make,
magenta/,235,"with lib_util.timing(""gibbs step %d"" % s):",
magenta/,245,Ensure sampler did actually sample everything under inner_masks.,
magenta/,276,upsample by zero-order hold and mask out every second time step,
magenta/,293,,
magenta/,294,Maskers,
magenta/,295,,
magenta/,302,pylint: disable=unexpected-special-method-signature,
magenta/,365,"bb, tt, pp, ii = shape",
magenta/,399,broadcast explicitly,
magenta/,403,,
magenta/,404,Schedules,
magenta/,405,,
magenta/,446,,
magenta/,447,Selectors,
magenta/,448,,
magenta/,449,Used in ancestral sampling to determine which variable to sample next.,
magenta/,475,determine which variable to update,
magenta/,477,"find index of first (t, i) with mask[:, t, :, i] == 1",
magenta/,485,"find index of first (t, p) with mask[:, t, p, :] == 1",
magenta/,488,"Intersect with mask to avoid selecting outside of the mask, e.g. in case",
magenta/,489,some masks[b] is zero everywhere.,
magenta/,490,"This can happen inside blocked Gibbs, where different examples have",
magenta/,491,different block sizes.,
magenta/,503,select one variable to sample. sample according to normalized mask;,
magenta/,504,is uniform as all masked out variables have equal positive weight.,
magenta/,512,"Intersect with mask to avoid selecting outside of the mask, e.g. in case",
magenta/,513,some masks[b] is zero everywhere.,
magenta/,514,"This can happen inside blocked Gibbs, where different examples have",
magenta/,515,different block sizes.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,153,"The code below assumes x is binary, so instead of x * log(px) which is",
magenta/,154,"inconveniently NaN if both x and log(px) are zero, we can use",
magenta/,155,"where(x, log(px), 0).",
magenta/,181,Compile a batch with each frame being an example.,
magenta/,187,Set up sequence of masks to predict the first (according to ordering),
magenta/,188,instrument for each frame,
magenta/,192,"When time rolls over, reveal the entire current frame for purposes of",
magenta/,193,predicting the next one.,
magenta/,204,"We can't parallelize within the frame, as we need the predictions of",
magenta/,205,some of the other instruments.,
magenta/,206,Hence we outer loop over the instruments and parallelize across frames.,
magenta/,209,Call out to the model to get predictions for the first instrument,
magenta/,210,at each time step.,
magenta/,216,Write in predictions and update mask.,
magenta/,221,Every example in the batch sees one frame more than the previous.,
magenta/,229,Every example in the batch sees one frame more than the previous.,
magenta/,236,conjunction over notes within frames; frame is the unit of prediction,
magenta/,243,random variable orderings within each time step,
magenta/,261,compile a batch with an example for each variable,
magenta/,268,"set up sequence of masks, one for each variable",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,42,"Oboe, English horn, clarinet, bassoon, sounds better on timidity.",
magenta/,64,Sequence can either be a 2D numpy array or a list of lists.,
magenta/,68,"If sequence is an numpy array should have shape (time, num_instruments).",
magenta/,81,step_size larger than 1 means some notes will be skipped over.,
magenta/,99,Only takes time steps that are on the quantization grid.,
magenta/,105,Some instruments are silence in this time step.,
magenta/,111,Silences are sometimes encoded as NaN when instruments are separated.,
magenta/,130,NOTE: Assumes four separate instruments ordered from high to low.,
magenta/,160,"Returns matrix of shape (128, time) with summed velocities.",
magenta/,161,16th notes,
magenta/,170,TODO(annahuang): Generalize to not requiring a requested shape.,
magenta/,171,TODO(annahuang): Assign instruments to SATB according to range of notes.,
magenta/,182,Encode each instrument separately.,
magenta/,213,TODO(annahuang): Sampling frequency is dataset dependent.,
magenta/,215,"Returns matrix of shape (128, time) with summed velocities.",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,24,adapts batch size in response to ResourceExhaustedErrors,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,60,The default value is only used for checking if completion masker,
magenta/,61,should be evoked.  It can't be used directly as the batch size,
magenta/,62,and length of pianorolls are unknown during static time.,
magenta/,82,"If outer_masks come in as all zeros, it means there's no masking,",
magenta/,83,"which also means nothing will be generated. In this case, use",
magenta/,84,completion mask to make new outer masks.,
magenta/,119,Calculate total_gibbs_steps as steps * num_instruments if not given.,
magenta/,125,sample_steps is set to total_gibbs_steps if not given.,
magenta/,135,"1 indicates mask out, 0 is not mask.",
magenta/,157,Initializes pianorolls by evaluating the model once to fill in all gaps.,
magenta/,248,Build graph and restore checkpoint.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,99,"NOTE: in case of multiple equal maxima, returns uniform distribution.",
magenta/,102,oldp = p,
magenta/,132,just making sure we don't put log probabilities in here,
magenta/,163,move new axis forward,
magenta/,328,example lengths must be the same across arguments,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,51,Update the default pitch ranges in hparams to reflect that of dataset.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,64,Creates a folder for storing the process of the sampling.,
magenta/,75,Saves the results as midi or returns as midi out.,
magenta/,90,Stores all the (intermediate) steps.,
magenta/,96,Save the prime as midi and npy if in harmonization mode.,
magenta/,97,"First, checks the stored npz for the first (context) and last step.",
magenta/,109,Only synthesize the one prime if in Midi-melody-prime mode.,
magenta/,133,Instantiates generation strategy.,
magenta/,169,Update the length of piece to be generated.,
magenta/,174,Generates.,
magenta/,186,Logs final step,
magenta/,255,Update the length of piece to be generated.,
magenta/,260,Generates.,
magenta/,308,,
magenta/,309,Strategies,
magenta/,310,,
magenta/,311,"Commonly used compositions of samplers, user-selectable through FLAGS.strategy",
magenta/,331,convenience function to avoid passing the same arguments over and over,
magenta/,337,pylint:disable=missing-docstring,
magenta/,348,"mroll shape: time, pitch",
magenta/,349,"requested_shape: batch, time, pitch, instrument",
magenta/,390,"start with an empty pianoroll of length 1, then repeatedly upsample",
magenta/,415,optionally start with bach samples,
magenta/,576,fill in the silences,
magenta/,603,fill in the silences,
magenta/,623,pylint:enable=missing-docstring,
magenta/,626,ok something else entirely.,
magenta/,631,"TODO(annahuang): Properties of the model/data_tools, not of the ascii art.",
magenta/,651,set up cycle through pitches and octaves,
magenta/,660,pylint: disable=cell-var-from-loop,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,36,"hparams_fpath = os.path.join(os.path.dirname(checkpoint_path), 'config')",
magenta/,47,Data.,
magenta/,52,Input dimensions.,
magenta/,59,Batch norm parameters.,
magenta/,62,Initialization.,
magenta/,64,Model architecture.,
magenta/,66,Hparams for depthwise separable convs.,
magenta/,70,Hparams for reducing pointwise in separable convs.,
magenta/,73,Hparams for dilated convs.,
magenta/,77,num_layers is used only for non dilated convs,
magenta/,78,as the number of layers in dilated convs is computed based on,
magenta/,79,num_dilation_blocks.,
magenta/,84,Loss setup.,
magenta/,85,"TODO(annahuang): currently maskout_method here is not functional,",
magenta/,86,still need to go through config_tools.,
magenta/,89,"use_softmax_loss=True,",
magenta/,91,Training.,
magenta/,92,"learning_rate=2**-6,",
magenta/,93,for sigmoids.,
magenta/,98,Runtime configs.,
magenta/,202,include whitelisted keys only,
magenta/,260,pylint:disable=unused-argument,
magenta/,295,pylint:disable=unused-argument,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,53,Melody,
magenta/,61,2 bars w/ 16 steps per bar,
magenta/,75,Truncate long melodies before slicing.,
magenta/,89,2 bars w/ 16 steps per bar,
magenta/,103,Truncate long melodies before slicing.,
magenta/,110,Chord-Conditioned Melody,
magenta/,118,2 bars w/ 16 steps per bar,
magenta/,134,Drums,
magenta/,142,2 bars w/ 16 steps per bar,
magenta/,153,Truncate long drum sequences before slicing.,
magenta/,168,2 bars w/ 16 steps per bar,
magenta/,179,Truncate long drum sequences before slicing.,
magenta/,194,2 bars w/ 16 steps per bar,
magenta/,206,Truncate long drum sequences before slicing.,
magenta/,222,2 bars w/ 16 steps per bar,
magenta/,234,Truncate long drum sequences before slicing.,
magenta/,244,Trio Models,
magenta/,255,melody,
magenta/,256,bass,
magenta/,257,drums,
magenta/,284,melody,
magenta/,285,bass,
magenta/,286,drums,
magenta/,318,melody,
magenta/,319,bass,
magenta/,320,drums,
magenta/,341,16-bar Melody Models,
magenta/,344,Truncate long melodies before slicing.,
magenta/,418,Multitrack,
magenta/,507,GrooVAE configs,
magenta/,515,4 bars w/ 16 steps per bar,
magenta/,539,2 bars w/ 16 steps per bar,
magenta/,563,2 bars w/ 16 steps per bar,
magenta/,587,2 bars w/ 16 steps per bar,
magenta/,612,2 bars w/ 16 steps per bar,
magenta/,636,2 bars w/ 16 steps per bar * 9 instruments,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,94,Should not be called from within the graph to avoid redundant summaries.,
magenta/,104,Create a markdown table from hparams.,
magenta/,190,pylint:disable=g-long-lambda,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,31,pylint:disable=g-direct-tensorflow-import,
magenta/,58,"At a segment boundary, note-offs happen before the cutoff.",
magenta/,59,Everything else happens after.,
magenta/,68,We're not at a segment boundary.,
magenta/,72,"If it's a time shift, but we're still within the current segment,",
magenta/,73,just append to current segment.,
magenta/,77,"If it's a time shift that goes beyond the current segment, possibly",
magenta/,78,split the time shift into two events and create a new segment.,
magenta/,100,"There may be a final segment with zero duration. If so, remove it.",
magenta/,105,Convert each segment to NoteSequence and back to remove notes that are,
magenta/,106,held across segment boundaries.,
magenta/,110,Performance is quantized relative to meter.,
magenta/,114,Performance is quantized with absolute timing.,
magenta/,208,TODO(iansimon): The way control tensors are set in ConverterTensors is,
magenta/,209,ugly when using a hierarchical converter. Figure out how to clean this up.,
magenta/,213,Pad empty segments with end tokens and flatten hierarchy.,
magenta/,222,Pad and concatenate flatten hierarchy.,
magenta/,357,Each encoded track will begin with a program specification token,
magenta/,358,(with one extra program for drums).,
magenta/,385,Reject sequences with out-of-range pitches.,
magenta/,390,Extract all instruments.,
magenta/,397,Reject sequences with too few instruments.,
magenta/,402,"Sort tracks by program, with drums at the end.",
magenta/,411,Make sure the track is the proper number of time steps.,
magenta/,414,Split this track into chunks.,
magenta/,430,Each track chunk needs room for program token and end token.,
magenta/,440,Aggregate by chunk.,
magenta/,444,Reject sequences that are too short (in events).,
magenta/,457,Add a special token for program at the beginning of each track.,
magenta/,460,Then encode the performance events.,
magenta/,463,Then add the end token.,
magenta/,471,Extract corresponding chords for each track. The chord sequences may,
magenta/,472,be different for different tracks even though the underlying chords,
magenta/,473,"are the same, as the performance event times will generally be",
magenta/,474,different.,
magenta/,484,Chord encoding for all tracks is inside this try block. If any,
magenta/,485,track fails we need to skip the whole subsequence.,
magenta/,488,Start with a pad token corresponding to the track program token.,
magenta/,490,Then encode the chords.,
magenta/,494,Then repeat the final chord for the track end token.,
magenta/,511,Performance sequences require sustain to be correctly interpreted.,
magenta/,518,Quantize just for the purpose of chord inference.,
magenta/,519,TODO(iansimon): Allow chord inference in unquantized sequences.,
magenta/,526,Infer chords in quantized sequence.,
magenta/,533,Copy inferred chords back to original sequence.,
magenta/,549,Split note sequence by bar hop size (in seconds).,
magenta/,560,Quantize this subsequence.,
magenta/,571,Convert the quantized subsequence to tensors.,
magenta/,609,Decode all tracks in this chunk into performance representation.,
magenta/,610,We don't immediately convert to NoteSequence as we first want to group,
magenta/,611,by track and concatenate.,
magenta/,615,Trim to end token.,
magenta/,620,"Handle program token. If there are extra program tokens, just use the",
magenta/,621,first one.,
magenta/,633,This is the drum program.,
magenta/,639,Decode the tokens into a performance track.,
magenta/,651,Get the corresponding chord and time for each event in the track.,
magenta/,652,This is a little tricky since we removed extraneous program tokens,
magenta/,653,when constructing the track.,
magenta/,664,Make sure the track has the proper length in time steps.,
magenta/,667,Aggregate by instrument.,
magenta/,670,Concatenate all of the track chunks for each instrument.,
magenta/,681,Set total time.,
magenta/,686,Sort chord times from all tracks and add to the sequence.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,72,Input placeholders,
magenta/,97,Outputs,
magenta/,115,Strip ':0' suffix.,
magenta/,122,Restore graph,
magenta/,131,Assume only a single checkpoint is in the directory.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,74,Non-Cudnn LSTM cells add 1.0 to the forget bias variable.,
magenta/,81,Non-Cudnn LSTM cells add 1.0 to the forget bias variable.,
magenta/,101,pylint:disable=protected-access,
magenta/,198,This is likely an eval/test job associated with a training job using,
magenta/,199,scheduled sampling.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,109,Test unsplit.,
magenta/,120,Test already split.,
magenta/,128,Test invalid total length.,
magenta/,134,Test invalid segment length.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,232,"Shouldn't be necessary, but the slice loses shape information when",
magenta/,233,control depth is zero.,
magenta/,236,The target/expected outputs.,
magenta/,238,"Inputs to be fed to decoder, including zero padding for the initial input.",
magenta/,243,"Either encode to get `z`, or do unconditional, decoder-only.",
magenta/,244,vae mode:,
magenta/,248,Prior distribution.,
magenta/,252,KL Divergence (nats),
magenta/,255,Concatenate the Z vectors to the inputs at each time step.,
magenta/,256,"unconditional, decoder-only generation",
magenta/,360,Maximum sequence length. Others will be truncated.,
magenta/,361,Size of latent vector z.,
magenta/,362,Bits to exclude from KL loss per dimension.,
magenta/,363,"Maximum KL cost weight, or cost if not annealing.",
magenta/,364,Exponential rate at which to anneal KL cost.,
magenta/,365,Minibatch size.,
magenta/,366,Gradient clipping. Recommend leaving at 1.0.,
magenta/,367,value or global_norm.,
magenta/,368,"If clip_mode=global_norm and global_norm is greater than this value,",
magenta/,369,"the gradient will be clipped to 0, effectively ignoring the step.",
magenta/,371,Learning rate.,
magenta/,372,Learning rate decay per minibatch.,
magenta/,373,Minimum learning rate.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,38,ENCODERS,
magenta/,71,Convert to time-major.,
magenta/,141,"Implements stacked bidirectional LSTM for variable-length sequences,",
magenta/,142,which are not supported by the CudnnLSTM layer.,
magenta/,155,"outputs_bw has already been reversed, so we can take the first element.",
magenta/,167,Note we access the outputs (h) from the states since the backward,
magenta/,168,ouputs are reversed to the input order in the returned outputs.,
magenta/,261,"In the first level, we use the input `sequence_length`. After that,",
magenta/,262,we use the full embedding sequences.,
magenta/,275,DECODERS,
magenta/,361,CudnnLSTM does not support sampling so it can only replace TrainingHelper.,
magenta/,362,pylint:disable=unidiomatic-typecheck,
magenta/,375,TODO(adarob): Pass the final state when it is valid (fixed-length).,
magenta/,438,Use teacher forcing.,
magenta/,442,Use scheduled sampling.,
magenta/,466,Sum loss over sequences.,
magenta/,505,Use a dummy Z in unconditional case.,
magenta/,509,Tile control sequence across samples.,
magenta/,512,"If not given, start with zeros.",
magenta/,515,"In the conditional case, also concatenate the Z.",
magenta/,529,We need to stop if we've run out of control input.,
magenta/,537,should be unused,
magenta/,611,"TODO(iansimon): Support conditioning in beam search decoder, which may be",
magenta/,612,awkward as there's no helper.,
magenta/,616,"If `end_token` is not given, use an impossible value.",
magenta/,625,Use a dummy Z in unconditional case.,
magenta/,628,"If not given, start with dummy `-1` token and replace with zero vectors in",
magenta/,629,`embedding_fn`.,
magenta/,640,Tile `z` across beams.,
magenta/,644,"If tokens are the start_tokens (negative), replace with zero vectors.",
magenta/,650,Concatenate `z` to next inputs.,
magenta/,672,Rebuild the input by combining the inital input with the sampled output.,
magenta/,813,Split output for each core model.,
magenta/,818,Compute reconstruction losses for the split output.,
magenta/,821,TODO(adarob): Sample initial inputs when using scheduled sampling.,
magenta/,828,Merge the metric maps by passing through renamed values and taking the,
magenta/,829,mean across the splits.,
magenta/,851,TODO(adarob): Support variable length outputs.,
magenta/,886,Overwrite output layer for NADE parameterization.,
magenta/,970,Check for explicit True/False since lists may be given.,
magenta/,971,pylint:disable=g-bool-id-comparison,
magenta/,973,pylint:disable=g-bool-id-comparison,
magenta/,1038,Subtract 1 for the core decoder level.,
magenta/,1060,The initial input should be the same size as the tensors returned by,
magenta/,1061,next level.,
magenta/,1081,Return the encoding of the outputs using the appropriate level of the,
magenta/,1082,hierarchical encoder.,
magenta/,1088,Return the final state.,
magenta/,1095,"Exclude the final, core decoder length.",
magenta/,1104,We only expect rank-2 for lengths and rank-3 for sequences.,
magenta/,1107,Move the batch dimension to after the hierarchical dimensions.,
magenta/,1173,"Get the approximate ""sample"" from the model.",
magenta/,1174,Start with the inputs the RNN saw (excluding the start token).,
magenta/,1176,Pad to be the max length.,
magenta/,1181,"Set the final value based on the target, since the scheduled sampling",
magenta/,1182,helper does not sample the final value.,
magenta/,1188,Return the re-encoded sample.,
magenta/,1200,Accumulate the split sequence losses.,
magenta/,1203,Merge the metric maps by passing through renamed values and taking the,
magenta/,1204,mean across the splits.,
magenta/,1258,Reshape control sequence to hierarchy.,
magenta/,1285,Populate `all_sample_ids`.,
magenta/,1300,Decoder RNN: number of units per layer.,
magenta/,1301,Encoder RNN: number of units per layer per dir.,
magenta/,1302,Probability all dropout keep.,
magenta/,1303,"constant, exponential, inverse_sigmoid",
magenta/,1304,Interpretation is based on `sampling_schedule`.,
magenta/,1305,Uses faster CudnnLSTM to train. For GPU only.,
magenta/,1306,Use residual connections in encoder.,
magenta/,1307,Use residual connections in decoder.,
magenta/,1335,"flat_x_target is by default shape (1,27), [on/offs... vels...offsets...]",
magenta/,1336,split into 3 equal length vectors,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,17,TODO(adarob): Add support for models with conditioning.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,141,Convert bool type to int for easier-to-read error messages.,
magenta/,337,Subtract min pitch (21).,
magenta/,672,"Mel 1, coverage bars: [3, 9] / [2, 9]",
magenta/,675,"Mel 2, coverage bars: [1, 3] / [0, 4]",
magenta/,678,"Bass, coverage bars: [0, 1], [4, 6] / [0, 7]",
magenta/,681,"Drum, coverage bars: [0, 2], [6, 7] / [0, 3], [5, 8]",
magenta/,688,Chords.,
magenta/,887,0.125 is a sixteenth note at 120bpm,
magenta/,889,Not on the beat,
magenta/,894,Not on the beat,
magenta/,902,0.125 is a sixteenth note at 120bpm,
magenta/,921,0.125 is a sixteenth note at 120bpm,
magenta/,925,Not on the beat,
magenta/,932,0.125 is a sixteenth note at 120bpm,
magenta/,935,Not on the beat,
magenta/,949,0.125 is a sixteenth note at 120bpm,
magenta/,952,Not on the beat,
magenta/,959,Not on the beat,
magenta/,968,0.125 is a sixteenth note at 120bpm,
magenta/,971,Not on the beat,
magenta/,987,Not on the beat,
magenta/,1020,Convert one or two measures to a tensor and back,
magenta/,1021,This example should yield basically a perfect reconstruction,
magenta/,1027,Test one bar sequence,
magenta/,1030,"Should output a tuple containing a tensor of shape (16,27)",
magenta/,1038,Test two bar sequence,
magenta/,1041,"Should output a tuple containing a tensor of shape (32,27)",
magenta/,1054,Test one bar sequence,
magenta/,1057,"Should output a tuple containing a tensor of shape (16,27)",
magenta/,1066,Test two bar sequence,
magenta/,1069,"Should output a tuple containing 2 tensors of shape (16,27)",
magenta/,1076,Get notes in first bar,
magenta/,1081,"Get notes in second bar, back them up by 2 secs for comparison",
magenta/,1100,Output sequence should match the initial input.,
magenta/,1103,Input sequence should match the pre-defined tap_sequence.,
magenta/,1115,Output sequence should match the initial input.,
magenta/,1118,Input sequence should match the pre-defined tap_sequence but with 0 vels.,
magenta/,1145,Output sequence should match the initial input.,
magenta/,1148,Input sequence should have <= the number of notes as regular tap.,
magenta/,1160,Output sequence should match the initial input.,
magenta/,1163,Input sequence should match the pre-defined quantized_sequence.,
magenta/,1168,Remove closed hi-hat from inputs.,
magenta/,1176,Output sequence should match the initial input.,
magenta/,1179,Input sequence should match the pre-defined sequence.,
magenta/,1183,Remove snare from inputs.,
magenta/,1191,Output sequence should match the initial input.,
magenta/,1194,Input sequence should match the pre-defined sequence.,
magenta/,1199,Removes closed hi-hat from inputs.,
magenta/,1279,This compares output_sequences[0] to the first bar of two_bar_sequence,
magenta/,1280,since they are not actually the same length.,
magenta/,1304,Convert one or two measures to a tensor and back,
magenta/,1305,This example should yield basically a perfect reconstruction,
magenta/,1320,Test one bar sequence,
magenta/,1323,"Should output a tuple containing a tensor of shape (16, 12)",
magenta/,1356,Test in default mode.,
magenta/,1365,Test in train mode.,
magenta/,1371,Test in inference mode.,
magenta/,1388,Create NoteSequence,
magenta/,1406,Setup reader mocks,
magenta/,1412,Use a mock data converter to make the test robust,
magenta/,1416,Create test config and verify results,
magenta/,1428,"inputs, outputs, controls, lengths",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,47,"piano, chromatic percussion, organ, guitar",
magenta/,51,"9 classes: kick, snare, closed_hh, open_hh, low_tom, mid_tom, hi_tom, crash,",
magenta/,52,ride,
magenta/,54,61 classes: full General MIDI set,
magenta/,56,pylint:disable=g-complex-comprehension,
magenta/,63,kick drum,
magenta/,65,snare drum,
magenta/,67,closed hi-hat,
magenta/,69,open hi-hat,
magenta/,71,low tom,
magenta/,73,mid tom,
magenta/,75,high tom,
magenta/,77,crash cymbal,
magenta/,79,ride cymbal,
magenta/,90,"pylint:disable=g-explicit-length-test,len-as-condition",
magenta/,439,We are conditioning on chords but sequence does not have chords. Try to,
magenta/,440,infer them.,
magenta/,468,TODO(adarob): Consider handling the fact that different event lists can,
magenta/,469,"be mapped to identical tensors by the encoder_decoder (e.g., Drums).",
magenta/,487,Repeat the last chord instead of using a special token; otherwise,
magenta/,488,the model may learn to rely on the special token to detect,
magenta/,489,endings.,
magenta/,684,Use pitch classes as `drum_type_pitches` since we have already done the,
magenta/,685,mapping.,
magenta/,793,"pylint: disable=g-explicit-length-test,len-as-condition",
magenta/,801,Map classes to exemplars.,
magenta/,895,We are conditioning on chords but sequence does not have chords. Try to,
magenta/,896,infer them.,
magenta/,902,"The trio parts get extracted from the original NoteSequence, so copy the",
magenta/,903,inferred chords back to that one.,
magenta/,915,"Assign an instrument class for each instrument, and compute its coverage.",
magenta/,916,"If an instrument has multiple classes, it is considered INVALID.",
magenta/,941,Group instruments by type.,
magenta/,947,This NoteSequence doesn't have all 3 types.,
magenta/,950,Encode individual instruments.,
magenta/,951,Set total time so that instruments will be padded correctly.,
magenta/,977,Fill in coverage gaps up to self._gap_bars.,
magenta/,985,Take cross product of instruments from each class and compute combined,
magenta/,986,encodings where they overlap.,
magenta/,993,Consider an instrument covered within gap_bars from the end if any of,
magenta/,994,the other instruments are. This allows more leniency when re-encoding,
magenta/,995,slices.,
magenta/,1152,"Each drum hit is represented by 3 numbers - on/off, velocity, and offset",
magenta/,1160,Set up controls for passing hits as side information.,
magenta/,1166,Set up controls for cycling through instrument outputs.,
magenta/,1191,pylint: disable=g-missing-from-attributes,
magenta/,1230,"Switch from [0, 127] to [0, 1] for tensors.",
magenta/,1232,Default velocity if there's no note is 0,
magenta/,1237,"Switch from [-0.5, 0.5] to [-1, 1] for tensors.",
magenta/,1239,Default offset if there's no note is 0,
magenta/,1281,Avoid edge case errors by adding a small amount to max_value,
magenta/,1317,Round up so we pad to the end of the bar.,
magenta/,1321,"Each of these stores a (total_beats, num_drums) matrix.",
magenta/,1326,Loop through timesteps.,
magenta/,1330,Loop through each drum instrument.,
magenta/,1345,These are the input tensors for the encoder.,
magenta/,1351,Choose a uniform dropout probability for notes per sequence.,
magenta/,1354,Drop out lower velocity notes with higher probability.,
magenta/,1378,"If learning to add drums, remove the specified drums from the inputs.",
magenta/,1384,Convert continuous velocity and offset to one hots.,
magenta/,1396,Split the outputs for each drum into separate steps.,
magenta/,1407,"Now concatenate all 3 vectors into 1, eg (16, 27).",
magenta/,1414,Controls section.,
magenta/,1419,Cycle through instrument numbers.,
magenta/,1437,"Output shape will look like (1, 64, output_depth).",
magenta/,1472,"Each timestep should be a (1, output_depth) vector",
magenta/,1473,"representing n hits, n velocities, and n offsets in order.",
magenta/,1477,Split out the categories from the flat output.,
magenta/,1479,pylint: disable=unbalanced-tuple-unpacking,
magenta/,1484,pylint: disable=unbalanced-tuple-unpacking,
magenta/,1488,Split out the instruments.,
magenta/,1496,pylint: disable=unbalanced-tuple-unpacking,
magenta/,1499,"Loop through the drum instruments: kick, snare, etc.",
magenta/,1501,Create a new note,
magenta/,1504,All drums are instrument 9,
magenta/,1536,TODO(adarob): Generalize to other data types if needed.,
magenta/,1603,pylint:disable=not-callable,
magenta/,1694,Don't remove padding for hierarchical examples.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,38,Velocity at which to play chord notes when rendering chords.,
magenta/,178,Create backing chord progression from flags.,
magenta/,184,Derive the total number of seconds to generate based on the QPM of the,
magenta/,185,priming sequence and the length of the backing chord progression.,
magenta/,189,Specify start/stop time for generation based on starting generation at the,
magenta/,190,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,191,long.,
magenta/,195,Set the start time to begin on the next step after the last note ends.,
magenta/,218,Add the backing chords to the input sequence.,
magenta/,234,Make the generate request num_outputs times and save the output as midi,
magenta/,235,files.,
magenta/,265,Having too large of a batch size will slow generation down unnecessarily.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,66,Use primer melody from input section only. Take backing chords from,
magenta/,67,beginning of input section through end of generate section.,
magenta/,76,No input section. Take primer melody from the beginning of the sequence,
magenta/,77,up until the start of the generate section.,
magenta/,95,Quantize the priming and backing sequences.,
magenta/,101,Setting gap_bars to infinite ensures that the entire input will be used.,
magenta/,110,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,111,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,112,seconds when the requested end time is 4.99.,
magenta/,119,"If no melody could be extracted, create an empty melody that starts 1",
magenta/,120,step before the request start_step. This will result in 1 step of,
magenta/,121,silence when the melody is extended below.,
magenta/,133,Make sure that chords and melody start on the same step.,
magenta/,139,Ensure that the melody extends up to the step we want to start generating.,
magenta/,142,Extract generation arguments from generator options.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,146,Default configurations.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,120,10 convolution layers of 'residual/residual*/conv*' have the same depth.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,51,Propagate the input and its stylized version through VGG16.,
magenta/,59,Compute the content loss,
magenta/,64,Compute the style loss,
magenta/,69,Compute the total variation loss,
magenta/,74,Compute the total loss,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,78,Forces all input processing onto CPU in order to reserve the GPU for the,
magenta/,79,forward inference and back-propagation.,
magenta/,83,Loads content images.,
magenta/,87,Loads style images.,
magenta/,98,Process style and content weight flags.,
magenta/,102,Define the model,
magenta/,119,Adding scalar summaries to the tensorboard.,
magenta/,123,Adding Image summaries to the tensorboard.,
magenta/,128,Set up training,
magenta/,136,Function to restore VGG16 parameters.,
magenta/,140,Function to restore Mobilenet V2 parameters.,
magenta/,147,Function to restore VGG16 and Mobilenet V2 parameters.,
magenta/,152,Run training,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,89,To avoid error related to reading expected variable save_counter.,
magenta/,90,pylint: disable=pointless-statement,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,69,Defines place holder for the style image.,
magenta/,78,Defines place holder for the content image.,
magenta/,87,Defines the model.,
magenta/,108,Gets the list of the input style images.,
magenta/,115,Gets list of input content images.,
magenta/,123,Saves preprocessed content image.,
magenta/,132,Computes bottleneck features of the style prediction network for the,
magenta/,133,identity transform.,
magenta/,149,Saves preprocessed style image.,
magenta/,158,Computes bottleneck features of the style prediction network for the,
magenta/,159,given style image.,
magenta/,164,Interpolates between the parameters of the identity transform and,
magenta/,165,style parameters of the given style image.,
magenta/,176,Saves stylized image.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,"pylint:disable=g-import-not-at-top,g-multiple-import",
magenta/,86,Defines the style prediction network.,
magenta/,98,Defines the style transformer network,
magenta/,109,Adds losses,
magenta/,169,"(batch_size, 1, 1, depth).",
magenta/,180,"(batch_size, 1, 1, style_prediction_bottleneck).",
magenta/,193,Computing beta parameter of the style normalization for the,
magenta/,194,activation_names[i] layer of the style transformer network.,
magenta/,195,"(batch_size, 1, 1, activation_depths[i])",
magenta/,197,"(batch_size, activation_depths[i])",
magenta/,201,Computing gamma parameter of the style normalization for the,
magenta/,202,activation_names[i] layer of the style transformer network.,
magenta/,203,"(batch_size, 1, 1, activation_depths[i])",
magenta/,205,"(batch_size, activation_depths[i])",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,63,Loads content images.,
magenta/,67,Process style and content weight flags.,
magenta/,71,Loads evaluation style images.,
magenta/,81,Computes stylized noise.,
magenta/,94,Computes stylized images.,
magenta/,108,Adds Image summaries to the tensorboard.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,78,Forces all input processing onto CPU in order to reserve the GPU for the,
magenta/,79,forward inference and back-propagation.,
magenta/,83,Loads content images.,
magenta/,87,Loads style images.,
magenta/,99,Process style and content weight flags.,
magenta/,103,Define the model,
magenta/,116,Adding scalar summaries to the tensorboard.,
magenta/,120,Adding Image summaries to the tensorboard.,
magenta/,126,Set up training,
magenta/,134,Function to restore VGG16 parameters.,
magenta/,138,Function to restore Inception_v3 parameters.,
magenta/,146,Function to restore VGG16 and Inception_v3 parameters.,
magenta/,151,Run training,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,83,Forces all input processing onto CPU in order to reserve the GPU for the,
magenta/,84,forward inference and back-propagation.,
magenta/,88,Load content images,
magenta/,92,Loads style images.,
magenta/,104,Process style and content weight flags.,
magenta/,108,Define the model,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,77,Defines place holder for the style image.,
magenta/,81,Defines place holder for the content image.,
magenta/,85,Defines the model.,
magenta/,98,Load model weights from  checkpoint file,
magenta/,101,Write SavedModel for serving or conversion to TF Lite,
magenta/,242,Load style dataset,
magenta/,249,Load content dataset,
magenta/,309,Load and run the style predict SavedModel,
magenta/,314,Load the style dataset,
magenta/,353,Calculate style bottleneck in advance for representative dataset,
magenta/,362,Get ImageNet data to use as content_image representative dataset,
magenta/,368,Generate representative dataset,
magenta/,381,"Load model weights from trained checkpoint, and export to SavedModel format",
magenta/,386,Define output TF Lite models path,
magenta/,393,Convert from SavedModel to TensorFlow Lite format,
magenta/,406,Convert the SavedModels to float and weight quantized TF Lite models,
magenta/,427,"The training dataset is provided, so we'll do full int8 quantization",
magenta/,448,Convert predict model,
magenta/,457,Convert transform model,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,66,Gets scope name and shape of the activations of transformer network which,
magenta/,67,will be used to apply style.,
magenta/,71,Defines the style prediction network.,
magenta/,82,Defines the style transformer network.,
magenta/,91,Adds losses.,
magenta/,148,"Shape of feat_convlayer is (batch_size, ?, ?, depth).",
magenta/,149,"For Mixed_6e end point, depth is 768, for input image size of 256x265",
magenta/,150,width and height are 14x14.,
magenta/,153,"(batch_size, 1, 1, depth).",
magenta/,163,"(batch_size, 1, 1, style_prediction_bottleneck).",
magenta/,177,Computing beta parameter of the style normalization for the,
magenta/,178,activation_names[i] layer of the style transformer network.,
magenta/,179,"(batch_size, 1, 1, activation_depths[i])",
magenta/,181,"(batch_size, activation_depths[i])",
magenta/,185,Computing gamma parameter of the style normalization for the,
magenta/,186,activation_names[i] layer of the style transformer network.,
magenta/,187,"(batch_size, 1, 1, activation_depths[i])",
magenta/,189,"(batch_size, activation_depths[i])",
magenta/,214,Decay for the moving averages.,
magenta/,216,epsilon to prevent 0s in variance.,
magenta/,218,collection containing the moving mean and moving variance.,
magenta/,228,Set weight_decay for weights in Conv and FC layers.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,25,State for constructing a time-varying control sequence. Keeps track of the,
magenta/,26,"current event position and time step in the generated performance, to allow",
magenta/,27,the control sequence to vary with clock time.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,This model can leave hanging notes. To avoid cacophony we turn off any note,
magenta/,31,after 5 seconds.,
magenta/,34,Default number of notes per second used to determine number of RNN generation,
magenta/,35,steps.,
magenta/,114,Quantize the priming sequence.,
magenta/,126,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,127,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,128,seconds when the requested end time is 4.99.,
magenta/,135,"If no track could be extracted, create an empty track that starts at the",
magenta/,136,requested generate_start_step.,
magenta/,143,Ensure that the track extends up to the step we want to start generating.,
magenta/,146,Extract generation arguments from generator options.,
magenta/,162,Make sure control signals are present and convert to lists if necessary.,
magenta/,179,Make sure disable conditioning flag is present when conditioning is,
magenta/,180,optional and convert to list if necessary.,
magenta/,202,Set up functions that map generation step to control signal values and,
magenta/,203,disable conditioning flag.,
magenta/,221,Primer is empty; let's just start with silence.,
magenta/,225,Assume the average specified (or default) note density and 4 RNN steps,
magenta/,226,per note. Can't know for sure until generation is finished because the,
magenta/,227,number of notes per quantized step is variable.,
magenta/,239,"In the interest of speed just go through this loop once, which may not",
magenta/,240,entirely fill the generate section.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,110,Add flags for all performance control signals.,
magenta/,185,Derive the total number of seconds to generate.,
magenta/,189,Specify start/stop time for generation based on starting generation at the,
magenta/,190,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,191,long.,
magenta/,193,Set the start time to begin when the last note ends.,
magenta/,241,Make the generate request num_outputs times and save the output as midi,
magenta/,242,files.,
magenta/,265,Having too large of a batch size will slow generation down unnecessarily.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,22,"pylint:disable=g-line-too-long,line-too-long",
magenta/,47,"pylint:enable=g-line-too-long,line-too-long",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,28,Data parameters,
magenta/,33,RNN parameters (encoder and decoder),
magenta/,38,Encoder parameters,
magenta/,43,Decoder parameters,
magenta/,48,"Unconstrained ""discretization"" parameters",
magenta/,49,Passes sequence of continuous embeddings directly to decoder (which we,
magenta/,50,will discretize during post-processing i.e. with K-means),
magenta/,54,VQ-VAE parameters,
magenta/,60,Integer quant parameters,
magenta/,69,Unconstrained parameters... just like VAE but passed directly (no prior),
magenta/,73,VAE parameters. Last hidden state of RNN will be projected to a summary,
magenta/,74,vector which will be passed to decoder with Gaussian re-parameterization.,
magenta/,78,(lo)w-(r)ate latents... one per every N steps of input,
magenta/,83,Training parameters,
magenta/,97,Eval parameters,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,61,"initial_state = cell.zero_state(batch_size, dtype)",
magenta/,135,Parse features,
magenta/,140,Create sequence lens,
magenta/,157,Encode,
magenta/,161,Build encoder features,
magenta/,188,Step embeddings (single vector per timestep),
magenta/,197,Quantized step embeddings with VQ-VAE,
magenta/,199,pylint:disable=g-import-not-at-top,
magenta/,202,"pre_vq_encoding is tf.float32 of [batch_size, seq_len, embedding_dim]",
magenta/,226,This tensor retrieves continuous embeddings from codebook. It should,
magenta/,227,*never* be used during training.,
magenta/,231,Integer-quantized step embeddings with straight-through,
magenta/,235,"pre_iq_encoding is tf.float32 of [batch_size, seq_len]",
magenta/,248,Pass rounded vals to decoder w/ straight-through estimator,
magenta/,256,Determine which elements round to valid indices,
magenta/,264,Regularize to encourage encoder to output in range,
magenta/,269,Regularize to correlate latent finite differences to input,
magenta/,296,Regularize to maintain note consistency,
magenta/,311,Calculate perplexity of discrete encoder posterior,
magenta/,335,This tensor converts discrete values to continuous.,
magenta/,336,It should *never* be used during training.,
magenta/,340,Sequence embedding (single vector per sequence),
magenta/,351,Sequence embeddings (variational w/ reparameterization trick),
magenta/,373,Low-rate embeddings,
magenta/,378,Downsample step embeddings,
magenta/,389,Upsample lo-rate embeddings for decoding,
magenta/,399,Build decoder features,
magenta/,403,Retrieve pitch numbers,
magenta/,408,Prepend <SOS> token,
magenta/,432,Decode,
magenta/,472,Stats,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,47,Create piano roll,
magenta/,57,Colorize,
magenta/,59,Create color palette,
magenta/,72,Rotate and flip for visual ease,
magenta/,75,Increase vertical dilation for visual ease,
magenta/,83,Cast to tf.uint8,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,59,Deserializes NoteSequences and extracts numeric tensors,
magenta/,76,Transposition data augmentation,
magenta/,92,Tempo data augmentation,
magenta/,99,Delta time start high to indicate free decision,
magenta/,109,Filter out excessively short examples,
magenta/,114,Take a random crop of a note sequence,
magenta/,125,Find sharded filenames,
magenta/,128,Create dataset,
magenta/,131,Deserialize protos,
magenta/,132,pylint: disable=g-long-lambda,
magenta/,138,pylint: enable=g-long-lambda,
magenta/,140,Filter sequences that are too short,
magenta/,143,Get random crops,
magenta/,146,Shuffle,
magenta/,150,Make batches,
magenta/,153,Repeat,
magenta/,157,Get tensors,
magenta/,161,Set shapes,
magenta/,165,Retrieve tensors,
magenta/,172,Onsets and frames model samples at 31.25Hz,
magenta/,176,Reduce time discretizations to a fixed number of buckets,
magenta/,180,Quantize velocities,
magenta/,186,Build return dict,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,Load data,
magenta/,65,Summarize data,
magenta/,70,Build model,
magenta/,79,Summarize quantized step embeddings,
magenta/,91,Summarize integer-quantized step embeddings,
magenta/,112,Summarize VAE sequence embeddings,
magenta/,116,Summarize output,
magenta/,129,Reconstruction loss,
magenta/,133,Build hybrid loss,
magenta/,154,Construct optimizer,
magenta/,159,Train,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,54,Load data,
magenta/,67,Build model,
magenta/,78,Build gold model,
magenta/,118,Summarize quantized step embeddings,
magenta/,124,Summarize integer-quantized step embeddings,
magenta/,143,Summarize VAE sequence embeddings,
magenta/,147,Reconstruction loss,
magenta/,157,Create dataset summaries,
magenta/,177,Create saver,
magenta/,210,Eval,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,36,TODO(iansimon): figure out the best way not to hard-code these constants,
magenta/,43,pylint: disable=line-too-long,
magenta/,49,pylint: enable=line-too-long,
magenta/,164,unused,
magenta/,171,TODO(trandustin): We default to not applying any transformation; to,
magenta/,172,"apply one, pass modalities.bottom to the model's hparams.bottom. In",
magenta/,173,"future, refactor the tuple of the ""inputs"" feature to be part of the",
magenta/,174,"features dict itself, i.e., have multiple inputs each with its own",
magenta/,175,modality and vocab size.,
magenta/,203,"Create a composite score encoder, only used for inference.",
magenta/,207,"If only one score component, just use its encoder.",
magenta/,218,"We don't actually ""decode"" anything here; the encodings are simply read as",
magenta/,219,tensors.,
magenta/,226,Stack encoded score components depthwise as inputs.,
magenta/,234,Take a random crop of the training example.,
magenta/,248,Split the example into non-overlapping segments.,
magenta/,266,"If not cropping or splitting, do standard preprocessing.",
magenta/,330,"We don't actually ""decode"" anything here; the encodings are simply read as",
magenta/,331,tensors.,
magenta/,391,unused,
magenta/,397,iterate over each score encoder and update modality/vocab_size,
magenta/,408,"CompositeScoreEncoder is tricky, so using a list of encoders instead.",
magenta/,413,"If only one score component, just use its encoder.",
magenta/,424,"We don't actually ""decode"" anything here; the encodings are simply read as",
magenta/,425,tensors.,
magenta/,556,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,561,Transpose no more than a minor third.,
magenta/,605,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,610,Transpose no more than a minor third.,
magenta/,638,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,643,Transpose no more than a minor third.,
magenta/,687,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,692,Transpose no more than a minor third.,
magenta/,738,"Stretch by -5%, -2.5%, 0%, 2.5%, and 5%.",
magenta/,743,Transpose no more than a minor third.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,41,TODO(iansimon): this should probably be defined in the problem,
magenta/,44,Shortcut to beat annotation.,
magenta/,53,TODO(iansimon): Figure out how to avoid explicitly serializing and,
magenta/,54,deserializing NoteSequence protos.,
magenta/,66,"Awkward to use ReadAllFromTFRecord instead of ReadFromTFRecord here,",
magenta/,67,but for some reason ReadFromTFRecord doesn't work with gs:// URLs.,
magenta/,166,Seed random number generator based on key so that hop times are,
magenta/,167,deterministic.,
magenta/,172,Deserialize NoteSequence proto.,
magenta/,175,Apply sustain pedal.,
magenta/,178,Remove control changes as there are potentially a lot of them and they are,
magenta/,179,no longer needed.,
magenta/,191,Split using fixed hop size.,
magenta/,195,Sample random hop positions such that each segment size is within,
magenta/,196,the specified range.,
magenta/,200,"It's important that we get a valid hop size here, since the",
magenta/,201,remainder of the sequence is too long.,
magenta/,206,It's okay if the next hop time is invalid (in which case we'll,
magenta/,207,just stop).,
magenta/,211,Split at the chosen hop times (ignoring zero and the final invalid,
magenta/,212,time).,
magenta/,219,We need to extract a score.,
magenta/,221,Beats are required to extract a score with metric timing.,
magenta/,231,Ensure the sequence starts and ends on a beat.,
magenta/,238,Infer beat-aligned chords (only for relative timing).,
magenta/,249,Infer melody regardless of relative/absolute timing.,
magenta/,263,Now rectify detected beats to occur at fixed tempo.,
magenta/,264,TODO(iansimon): also include the alignment,
magenta/,268,Score uses same timing as performance.,
magenta/,271,Remove melody notes from performance.,
magenta/,279,Remove non-melody notes from score.,
magenta/,287,Remove key signatures and beat/chord annotations from performance.,
magenta/,294,Augment and encode the performance.,
magenta/,311,Take a random crop of the encoded performance.,
magenta/,318,Augment the extracted score.,
magenta/,325,Apply all score encoding functions.,
magenta/,389,Make sure Beam's log messages are not filtered.,
magenta/,404,Check for existence of prior outputs. Since the number of shards may be,
magenta/,405,"different, the prior outputs will not necessarily be overwritten and must",
magenta/,406,be deleted explicitly.,
magenta/,425,Input data is already partitioned into splits.,
magenta/,431,Read using a single PTransform.,
magenta/,508,Seed random number generator based on key so that hop times are,
magenta/,509,deterministic.,
magenta/,514,Deserialize NoteSequence proto.,
magenta/,517,Apply sustain pedal.,
magenta/,520,Remove control changes as there are potentially a lot of them and they are,
magenta/,521,no longer needed.,
magenta/,526,Augment and encode the performance.,
magenta/,534,feed in performance as both input/output to music transformer,
magenta/,535,chopping sequence into length 2048 (throw out shorter sequences),
magenta/,547,decode truncated performance sequence for melody inference,
magenta/,551,extract melody from cropped performance sequence,
magenta/,560,remove non-melody notes from score,
magenta/,569,encode melody,
magenta/,572,make sure performance input also matches targets; needed for,
magenta/,573,compatibility of both perf and (mel & perf) autoencoders,
magenta/,576,randomly sample a pitch shift to construct noisy performance,
magenta/,582,make sure you transpose,
magenta/,636,Make sure Beam's log messages are not filtered.,
magenta/,651,Check for existence of prior outputs. Since the number of shards may be,
magenta/,652,"different, the prior outputs will not necessarily be overwritten and must",
magenta/,653,be deleted explicitly.,
magenta/,672,Input data is already partitioned into splits.,
magenta/,678,Read using a single PTransform.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,"Lint as: python2, python3",
magenta/,32,pylint: disable=g-multiple-import,
magenta/,46,pylint: disable=g-direct-tensorflow-import,
magenta/,48,"Alias some commonly reused layers, here and elsewhere.",
magenta/,98,Otherwise the encoder will just use encoder_self_attention_bias.,
magenta/,173,Otherwise the encoder will just use encoder_self_attention_bias.,
magenta/,177,do the same thing for melody,
magenta/,192,Otherwise the encoder will just use encoder_self_attention_bias.,
magenta/,196,use the proper encoder function for perf/melody,
magenta/,208,same thing for melody,
magenta/,221,concatenate the global mean vector/bias term with the full melody encoding,
magenta/,225,different methods of aggregating over the performance + melody vectors!,
magenta/,227,add both mean performance and melody vectors together,
magenta/,233,concatenate melody with mean-aggregated performance embedding,
magenta/,243,tile performance embedding across each dimension of melody embedding!,
magenta/,315,TPU does not react kindly to extra dimensions.,
magenta/,316,TODO(noam): remove this once TPU is more forgiving of extra dims.,
magenta/,319,Expand since t2t expects 4d tensors.,
magenta/,329,For visualizing attention heads.,
magenta/,330,Override to enable recurrent memory,
magenta/,353,For visualizing attention heads.,
magenta/,354,Override to enable recurrent memory,
magenta/,385,For visualizing attention heads.,
magenta/,386,Override to enable recurrent memory,
magenta/,428,extract appropriate performance and melody inputs,
magenta/,444,Not all subclasses of Transformer support keyword arguments related to,
magenta/,445,"recurrent memory, so only pass these arguments if memory is enabled.",
magenta/,448,TODO(kitaev): The chunk_number feature currently has the same shape as,
magenta/,449,"""targets"", but this is only for the purposes of sharing sharding code.",
magenta/,450,In fact every token within an example must have the same chunk number.,
magenta/,453,Uncomment the code below to verify that tokens within a batch share the,
magenta/,454,same chunk number:,
magenta/,455,with tf.control_dependencies([,
magenta/,456,"tf.assert_equal(chunk_number_each_token,",
magenta/,457,"chunk_number_each_example[:, None])",
magenta/,458,]):,
magenta/,459,chunk_number_each_example = tf.identity(chunk_number_each_example),
magenta/,510,process all conditioning features,
magenta/,515,this would be for melody decoding,
magenta/,525,Prepare partial targets.,
magenta/,526,"In either features[""inputs""] or features[""targets""].",
magenta/,527,We force the outputs to begin with these sequences.,
magenta/,532,Save the targets in a var and reassign it after the tf.while loop to avoid,
magenta/,533,having targets being in a 'while' frame. This ensures targets when used,
magenta/,534,in metric functions stays in the same frame as other vars.,
magenta/,551,"This is inefficient in that it generates samples at all timesteps,",
magenta/,552,"not just the last one, except if target_modality is pointwise.",
magenta/,554,Concatenate the already-generated recent_output with last timestep,
magenta/,555,of the newly-generated samples.,
magenta/,572,Assuming we have one shard for logits.,
magenta/,577,Create an initial output tensor. This will be passed,
magenta/,578,"to the infer_step, which adds one timestep at every iteration.",
magenta/,593,Hack: foldl complains when the output shape is less specified than the,
magenta/,594,"input shape, so we confuse it about the input shape.",
magenta/,604,"this code will generate outputs that tend to be long,",
magenta/,605,but this is to avoid the case when the melody is extremely short.,
magenta/,606,"this can be changed to features[""melody""] for the actual behavior.",
magenta/,610,"Initial values of result, logits and loss.",
magenta/,619,"tensor of shape [batch_size, time, 1, 1, vocab_size]",
magenta/,627,pylint: disable=unused-argument,
magenta/,636,Check if the last predicted element is a EOS,
magenta/,640,We only check for early stopping if there is at least 1 element (,
magenta/,641,otherwise not_eos will crash).,
magenta/,649,"If batch_size == 1, we check EOS for early stopping.",
magenta/,651,"Else, just wait for max length",
magenta/,665,Restore to not confuse Estimator.,
magenta/,667,Reassign targets back to the previous value.,
magenta/,690,For visualizing attention heads.,
magenta/,691,Override to enable recurrent memory,
magenta/,726,use melody-only as input features,
magenta/,740,Not all subclasses of Transformer support keyword arguments related to,
magenta/,741,"recurrent memory, so only pass these arguments if memory is enabled.",
magenta/,744,TODO(kitaev): The chunk_number feature currently has the same shape as,
magenta/,745,"""targets"", but this is only for the purposes of sharing sharding code.",
magenta/,746,In fact every token within an example must have the same chunk number.,
magenta/,749,Uncomment the code below to verify that tokens within a batch share the,
magenta/,750,same chunk number:,
magenta/,751,with tf.control_dependencies([,
magenta/,752,"tf.assert_equal(chunk_number_each_token,",
magenta/,753,"chunk_number_each_example[:, None])",
magenta/,754,]):,
magenta/,755,chunk_number_each_example = tf.identity(chunk_number_each_example),
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,40,For local attention.,
magenta/,43,For decoding.,
magenta/,46,For multi-embedding aggregation in melody & performance autoencoder,
magenta/,53,"If using relative attention, set max relative distance to be half",
magenta/,54,the max training length.,
magenta/,71,did not actually adjust number of warmup steps,
magenta/,72,hparams.warmup = 10000,
magenta/,97,============== n8 d20 =================,
magenta/,123,============= d10 ==================,
magenta/,172,============== d15 =================,
magenta/,252,hparams = transformer.transformer_base(),
magenta/,258,Need to specify num_hidden_layers,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,44,Convert ret to tensor.,
magenta/,56,Add together the embeddings for each tuple position.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,86,Create a trie mapping n-grams to new indices.,
magenta/,91,Also add all unigrams to the trie.,
magenta/,116,Greedily encode performance event n-grams as new indices.,
magenta/,163,Decode indices corresponding to event n-grams back into the n-grams.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,60,VELOCITY(25),
magenta/,61,NOTE-ON(60),
magenta/,62,NOTE-ON(64),
magenta/,63,TIME-SHIFT(100),
magenta/,64,VELOCITY(32),
magenta/,65,NOTE-ON(67),
magenta/,66,TIME-SHIFT(100),
magenta/,67,NOTE-OFF(67),
magenta/,68,TIME-SHIFT(100),
magenta/,69,NOTE-OFF(64,
magenta/,70,TIME-SHIFT(100),
magenta/,71,NOTE-OFF(60),
magenta/,87,VELOCITY(25),
magenta/,88,NOTE-ON(60),
magenta/,89,NOTE-ON(64),
magenta/,90,TIME-SHIFT(100),
magenta/,91,VELOCITY(32),
magenta/,92,NOTE-ON(67),
magenta/,93,TIME-SHIFT(100),
magenta/,94,NOTE-OFF(67),
magenta/,95,TIME-SHIFT(100),
magenta/,96,NOTE-OFF(64,
magenta/,97,TIME-SHIFT(100),
magenta/,98,NOTE-OFF(60),
magenta/,99,EOS,
magenta/,115,VELOCITY(25),
magenta/,116,"NOTE-ON(60), NOTE-ON(64)",
magenta/,117,TIME-SHIFT(100),
magenta/,118,"VELOCITY(32), NOTE-ON(67)",
magenta/,119,TIME-SHIFT(100),
magenta/,120,NOTE-OFF(67),
magenta/,121,TIME-SHIFT(100),
magenta/,122,NOTE-OFF(64,
magenta/,123,TIME-SHIFT(100),
magenta/,124,NOTE-OFF(60),
magenta/,137,Write NoteSequence to MIDI file as encoder takes in filename.,
magenta/,143,VELOCITY(25),
magenta/,144,NOTE-ON(60),
magenta/,145,"TIME-SHIFT(100), NOTE-OFF(60)",
magenta/,156,VELOCITY(25),
magenta/,157,NOTE-ON(60),
magenta/,158,"TIME-SHIFT(100), NOTE-OFF(60)",
magenta/,161,"Decode method returns MIDI filename, read and convert to NoteSequence.",
magenta/,165,Remove default tempo & time signature.,
magenta/,172,Add source info fields.,
magenta/,205,no-chord,
magenta/,206,C major,
magenta/,207,C major,
magenta/,208,D minor,
magenta/,209,B diminished,
magenta/,219,C major,
magenta/,220,G major,
magenta/,221,A minor,
magenta/,222,F major,
magenta/,249,ON(60),
magenta/,250,ON(62),
magenta/,251,HOLD(62),
magenta/,252,OFF(62),
magenta/,253,REST,
magenta/,254,ON(64),
magenta/,255,HOLD(64),
magenta/,256,HOLD(64),
magenta/,268,ON(60),
magenta/,269,HOLD(60),
magenta/,270,ON(62),
magenta/,271,OFF(62),
magenta/,272,ON(64),
magenta/,273,HOLD(64),
magenta/,297,ON(vel=127),
magenta/,298,ON(vel=15),
magenta/,299,HOLD(62),
magenta/,300,REST,
magenta/,301,REST,
magenta/,302,ON(vel=32),
magenta/,303,HOLD(64),
magenta/,304,HOLD(64),
magenta/,335,no-chord,
magenta/,336,no-chord,
magenta/,337,C major,
magenta/,338,C major,
magenta/,339,D minor,
magenta/,340,D minor,
magenta/,341,D minor,
magenta/,342,D minor,
magenta/,346,ON(60),
magenta/,347,ON(62),
magenta/,348,HOLD(62),
magenta/,349,OFF(62),
magenta/,350,REST,
magenta/,351,ON(64),
magenta/,352,HOLD(64),
magenta/,353,HOLD(64),
magenta/,359,TODO(iansimon): also test MusicXML encoding,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,5 measures,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,177,Derive the total number of seconds to generate.,
magenta/,181,Specify start/stop time for generation based on starting generation at the,
magenta/,182,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,183,long.,
magenta/,185,Set the start time to begin when the last note ends.,
magenta/,204,Make the generate request num_outputs times and save the output as midi,
magenta/,205,files.,
magenta/,228,Having too large of a batch size will slow generation down unnecessarily.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,126,Flatten time dimension.,
magenta/,155,Remove last value from input sequences.,
magenta/,158,Add initial padding value to input sequences.,
magenta/,163,Flatten time dimension.,
magenta/,338,Flatten state tuples for metagraph compatibility.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,57,"This sequence will be quantized later, so it is guaranteed to have only 1",
magenta/,58,tempo.,
magenta/,89,Quantize the priming sequence.,
magenta/,99,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,100,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,101,seconds when the requested end time is 4.99.,
magenta/,110,Ensure that the track extends up to the step we want to start generating.,
magenta/,113,Extract generation arguments from generator options.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,5 measures,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,32,Raw dataset paths (from datagen_beam.py),
magenta/,33,(Run t2t datagen on GlyphAzznProblem to convert these into a t2t dataset),
magenta/,55,10% evaluation data,
magenta/,66,the data comes pre-split. so we should not shuffle and split it again.,
magenta/,67,this also means generate_samples will be called twice (one per split),
magenta/,81,ignore any encoding since we don't need that,
magenta/,111,indicates we're using one-hot categories for command type.,
magenta/,137,"FIRST, COPY THE MEAN/STDEV INTO DATA_DIR, in npz format",
magenta/,143,"also want to set mean[:4] to zeros and stdev[:4] to ones, because",
magenta/,144,these are the class labels,
magenta/,147,"finally, save",
magenta/,157,determing whether this example belongs to a fontset in train or test,
magenta/,161,"randomly sample 10% to be test, the rest is train",
magenta/,206,normalize (via gaussian),
magenta/,210,redefine shape inside model!,
magenta/,216,"training vae mode, use the last image (rendered icon) as input & output",
magenta/,252,"vae mode, outputs is image, just do image summary and continue",
magenta/,262,undo normalize (via gaussian),
magenta/,266,"simple cmds are 10 dim (4 one-hot, 6 args).",
magenta/,267,Convert to full SVG spec dimensionality so we can convert it to text.,
magenta/,271,sampled text summary,
magenta/,276,original text summary,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,39,"in order of arg complexity, with absolutes clustered",
magenta/,40,recall we don't handle all commands (see docstring),
magenta/,45,GENERAL UTILS,
magenta/,48,"grouper('ABCDEF', 3) -> 'ABC', 'DEF'",
magenta/,62,UTILS FOR CONVERTING SFD/SPLINESETS TO SVG PATHS,
magenta/,81,COMMAND NOT RECOGNIZED.,
magenta/,83,"assert cmd in 'cml', 'Command not recognized: {}'.format(cmd)",
magenta/,108,UTILS FOR PROCESSING TOKENIZED PATHS,
magenta/,111,"For instance, the command 'a' takes 7 arguments, but some SVGs declare:",
magenta/,112,a 1 2 3 4 5 6 7 8 9 10 11 12 13 14,
magenta/,113,Which is 14 arguments. This function converts the above to the equivalent:,
magenta/,114,a 1 2 3 4 5 6 7  a 8 9 10 11 12 13 14,
magenta/,115,,
magenta/,116,"Note: if remove_zs is True, this also removes any occurences of z commands.",
magenta/,127,E.g.: given:,
magenta/,128,"['a', '0', '0', '0', '0', '0', '0', '0',",
magenta/,129,"'0', '0', '0', '0', '0', '0', '0']",
magenta/,130,Converts to:,
magenta/,131,"[['a', '0', '0', '0', '0', '0', '0', '0'],",
magenta/,132,"['a', '0', '0', '0', '0', '0', '0', '0']]",
magenta/,133,And returns a string that joins these elements with spaces.,
magenta/,142,command has no args (e.g.: 'z'),
magenta/,157,"This argument is an x-coordinate if even, y-coordinate if odd",
magenta/,158,except when flip == True,
magenta/,170,Each SVG lives in a 2D plane. The viewbox determines the region of that,
magenta/,171,"plane that gets rendered. For instance, some designers may work with a",
magenta/,172,"viewbox that's 24x24, others with one that's 100x100, etc.",
magenta/,174,"Suppose I design the the letter ""h"" in the Arial style using a 100x100",
magenta/,175,"viewbox (let's call it icon A). Let's suppose the icon has height 75. Then,",
magenta/,176,"I design the same character using a 20x20 viewbox (call this icon B), with",
magenta/,177,"height 15 (=75% of 20). This means that, when rendered, both icons with look",
magenta/,178,"exactly the same, but the scale of the commands each icon is using is",
magenta/,179,"different. For instance, if icon A has a command like ""lineTo 100 100"", the",
magenta/,180,"equivalent command in icon B will be ""lineTo 20 20"".",
magenta/,182,"In order to avoid this problem and bring all real values to the same scale,",
magenta/,183,I scale all icons' commands to use a 24x24 viewbox. This function does this:,
magenta/,184,it converts a path that exists in the given viewbox into a standard 24x24,
magenta/,185,viewbox.,
magenta/,228,"NOTE: glyphs only use a very small subset of commands (L, C, M, and Z -- I",
magenta/,229,believe). So I'm not handling A and H for now.,
magenta/,344,convert args to floats,
magenta/,347,canonicalize each subpath separately,
magenta/,360,"we're looking at the first substructure now, we can determine whether we",
magenta/,361,will flip the cardniality of the whole icon or not,
magenta/,370,convert args to strs,
magenta/,375,UTILS FOR CONVERTING TOKENIZED PATHS TO VECTORS,
magenta/,378,Notes:,
magenta/,379,"- The SimpleSVG dataset does not have any 't', 'q', 'Z', 'T', or 'Q'.",
magenta/,380,"Thus, we don't handle those here.",
magenta/,381,- We also removed all 'z's.,
magenta/,382,- The x-axis-rotation argument to a commands is always 0 in this,
magenta/,383,"dataset, so we ignore it",
magenta/,385,Many commands have args that correspond to args in other commands.,
magenta/,386,"v  __,__ _______________ ______________,_________ __,__ __,__ _,y",
magenta/,387,"h  __,__ _______________ ______________,_________ __,__ __,__ x,_",
magenta/,388,"z  __,__ _______________ ______________,_________ __,__ __,__ _,_",
magenta/,389,"a  rx,ry x-axis-rotation large-arc-flag,sweepflag __,__ __,__ x,y",
magenta/,390,"l  __,__ _______________ ______________,_________ __,__ __,__ x,y",
magenta/,391,"c  __,__ _______________ ______________,_________ x1,y1 x2,y2 x,y",
magenta/,392,"m  __,__ _______________ ______________,_________ __,__ __,__ x,y",
magenta/,393,"s  __,__ _______________ ______________,_________ __,__ x2,y2 x,y",
magenta/,395,So each command will be converted to a vector where the dimension is the,
magenta/,396,minimal number of arguments to all commands:,
magenta/,397,"[rx, ry, large-arc-flag, sweepflag, x1, y1, x2, y2, x, y]",
magenta/,398,"If a command does not output a certain arg, it is set to 0.",
magenta/,399,"""l 5,5"" becomes [0, 0, 0, 0, 0, 0, 0, 0, 5, 5]",
magenta/,401,"Also note, as of now we also output an extra dimension at index 0, which",
magenta/,402,indicates which command is being outputted (integer).,
magenta/,411,"For description of how this conversion happens, see",
magenta/,412,path_to_vector docstring.,
magenta/,417,"integer, for MSE",
magenta/,420,one hot + 1 dim for EOS.,
magenta/,426,x,
magenta/,428,y,
magenta/,430,x,
magenta/,431,y,
magenta/,433,x2,
magenta/,434,y2,
magenta/,435,x,
magenta/,436,y,
magenta/,438,x1,
magenta/,439,y1,
magenta/,440,x2,
magenta/,441,y2,
magenta/,442,x,
magenta/,443,y,
magenta/,445,rx,
magenta/,446,ry,
magenta/,447,we skip x-axis-rotation,
magenta/,448,large-arc-flag,
magenta/,449,sweep-flag,
magenta/,450,"a does not have x1, y1, x2, y2 args",
magenta/,451,x,
magenta/,452,y,
magenta/,457,UTILS FOR RENDERING PATH INTO IMAGE,
magenta/,460,from http://rosettacode.org/wiki/Bitmap/B%C3%A9zier_curves/Cubic,
magenta/,554,"assumes tensor is already unnormalized, and in long form",
magenta/,570,UTILS FOR PROCESSING VECTORS,
magenta/,583,out has 10 dims,
magenta/,584,"the first 4 are respectively dims 0, 4, 5, 9 of the full 20-dim onehot vec",
magenta/,585,the latter 6 are the 6 last dims of the 10-dim arg vec,
magenta/,596,UTILS FOR CONVERTING VECTORS TO SVGS,
magenta/,629,EOS,
magenta/,638,x,
magenta/,640,y,
magenta/,642,x,
magenta/,643,y,
magenta/,645,x2,
magenta/,646,y2,
magenta/,647,x,
magenta/,648,y,
magenta/,650,x1,
magenta/,651,y1,
magenta/,652,x2,
magenta/,653,y2,
magenta/,654,x,
magenta/,655,y,
magenta/,657,rx,
magenta/,658,ry,
magenta/,659,x-axis-rotation is always 0,
magenta/,661,the following two flags are binary.,
magenta/,662,large-arc-flag,
magenta/,663,sweep-flag,
magenta/,664,x,
magenta/,665,y,
magenta/,670,UTILS FOR CONVERTING SVGS/VECTORS TO IMAGES,
magenta/,684,UTILS FOR CREATING TF SUMMARIES,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,42,we want the exact hparams used for training this vv,
magenta/,47,go back to root variable scope,
magenta/,52,the real input to vae will be features['rendered_targets'],
magenta/,57,we want vae to return bottleneck,
magenta/,68,inputs and targets are both sequences with,
magenta/,69,"shape = [batch, seq_len, 1, hparams.problem.feature_dim]",
magenta/,78,"override bottleneck, or return it, if requested",
magenta/,81,"return sampled_bottleneck,",
magenta/,82,set losses['training'] = 0 so self.top() doesn't get called on it,
magenta/,85,we want to use the given bottleneck,
magenta/,88,finalize bottleneck,
magenta/,89,twice because using LSTM,
magenta/,93,unbottleneck back to LSTMStateTuple,
magenta/,106,Add 1 to account for the padding added to the left from shift_right,
magenta/,109,LSTM decoder,
magenta/,133,"IN PREDICT MODE, RUN tf.while RNN",
magenta/,145,"append one-hot class to bottleneck, which will be given per step",
magenta/,160,unflatten hidden:,
magenta/,164,put logits_so_far through top,
magenta/,166,need to reuse top params,
magenta/,175,append a zero pad to the samples. this effectively shifts the samples,
magenta/,176,"right, but, unlike shift_right, by not removing the last element, we",
magenta/,177,allow an empty samples_so_far to not be empty after padding,
magenta/,180,"now take the very last one here, will be the actual input to the rnn",
magenta/,183,tile and append the bottleneck to inputs,
magenta/,197,RUN PRE-LSTM LAYER,
magenta/,202,RUN LSTM,
magenta/,211,flatten state,
magenta/,220,passing state must be flattened:,
magenta/,223,actually run tf.while:,
magenta/,236,logits should be returned in 3d mode:,
magenta/,243,NOT IN PREDICT MODE. JUST RUN TEACHER-FORCED RNN:,
magenta/,248,"append one-hot class to bottleneck, which will be given per step",
magenta/,261,tile and append the bottleneck to inputs,
magenta/,300,Create an initial output tensor. This will be passed,
magenta/,301,"to the infer_step, which adds one timestep at every iteration.",
magenta/,306,Hack: foldl complains when the output shape is less specified than the,
magenta/,307,"input shape, so we confuse it about the input shape.",
magenta/,315,"extra_decode_length is set to 0, unused.",
magenta/,319,pylint: disable=not-callable,
magenta/,344,LSTM-specific hparams,
magenta/,347,VAE params,
magenta/,350,VAE loss params (don't matter but must be defined),
magenta/,354,loss params,
magenta/,358,"params required by LayerNormLSTMCell, for us to just use recurrent dropout",
magenta/,363,Decode architecture hparams,
magenta/,369,MDN loss hparams,
magenta/,375,VAE meta hparams (to load image encoder),
magenta/,382,data format hparams,
magenta/,385,"problem hparams (required, don't modify)",
magenta/,390,modality hparams,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,41,pylint: disable=expression-not-assigned,
magenta/,42,pylint: disable=abstract-method,
magenta/,43,pylint: disable=arguments-differ,
magenta/,46,HELPERS FOR DATASET PROCESSING,
magenta/,73,zoom out,
magenta/,75,make clockwise,
magenta/,78,render path for training,
magenta/,81,make path relative,
magenta/,83,convert to vector,
magenta/,85,make simple vector,
magenta/,90,count some stats,
magenta/,95,append eos,
magenta/,98,pad path to 51 (with eos),
magenta/,102,make pure list:,
magenta/,119,"add [0] after ""value"" if you want to just get value ""1"" instead of [""1""]",
magenta/,132,mean_stdev is a dict,
magenta/,150,"x, x^2, count",
magenta/,154,"new_input is a dict with keys = ['seq_len', 'sequence']",
magenta/,157,remove padding and eos from sequence,
magenta/,161,accumulate new_sum and new_sum_sq,
magenta/,176,-ve value could happen due to rounding,
magenta/,194,PIPELINE GENERATORS,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,pylint: disable=redefined-outer-name,
magenta/,28,pylint: disable=unused-variable,
magenta/,29,pylint: disable=invalid-name,
magenta/,44,mask out unimportant terms given the ground truth commands,
magenta/,54,"targets already come in 10-dim mode, no need to so any mdn stuff",
magenta/,55,obviously.,
magenta/,63,"args are [batch, seq, 1, 6*3*num_mix]. want [batch * seq * 6, 3*num_mix]",
magenta/,67,"before we compute mdn_args_loss, we need to create a mask for elements",
magenta/,68,to ignore on it.,
magenta/,69,create mask,
magenta/,76,"calculate mdn loss, which auto masks it out",
magenta/,81,we dont have to manually mask out the softmax xent loss because,
magenta/,82,"internally, each dimention of the xent loss is multiplied by the",
magenta/,83,"given probability in the label for that dim. So for a one-hot label [0,",
magenta/,84,"1, 0] the xent loss between logit[0] and label[0] are multiplied by 0,",
magenta/,85,whereas between logit[1] and label[1] are multiplied by 1. Because our,
magenta/,86,"targets_commands_rel is all 0s for the padding, sofmax_xent_loss is 0",
magenta/,87,for those elements as well.,
magenta/,91,Accumulate losses,
magenta/,105,this tells us not to re-create the summary ops,
magenta/,135,mixture of gaussians for 6 args plus 4 extra states for cmds,
magenta/,139,the 'hard' option is meant to be used if 'top' is called within body,
magenta/,147,"apply temperature, do softmax",
magenta/,153,"sample from the given probs, this is the same as get_pi_idx,",
magenta/,154,and already returns not soft prob,
magenta/,156,"this is now [batch, seq, 1], need to make it one_hot",
magenta/,160,"args are [batch, seq, 1, 6*3*num_mix]. want [batch * seq * 6, 3*num_mix]",
magenta/,164,"these are [batch*seq*6, num_mix]",
magenta/,166,apply temp to logmix,
magenta/,172,get_pi_idx,
magenta/,174,"should now be [batch*seq*6, 1]",
magenta/,177,prepare for gather,
magenta/,184,sample!!,
magenta/,190,concat with the command we picked!,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,43,"inputs and targets should all be images, no preprocessing needed.",
magenta/,44,but we do need to resize them to 64x64.,
magenta/,58,"body_output should be a dict with 'outputs', which will be an image.",
magenta/,59,no postprocessing needed.,
magenta/,63,"logits should be dict with 'outputs', which is image.",
magenta/,70,"inputs and targets should both be images with dims [batch, 64, 64, 1]",
magenta/,78,encoder,
magenta/,82,bottleneck,
magenta/,88,return bottleneck for interpolation,
magenta/,89,set losses['training'] = 0 so top() isn't called on it,
magenta/,90,potential todo: use losses dict so we have kl_loss here for non stop,
magenta/,91,gradient models,
magenta/,94,we want to use the given bottleneck,
magenta/,97,finalize bottleneck,
magenta/,100,decoder.,
magenta/,103,calculate training loss here lol,
magenta/,124,No sampling or kl loss on eval.,
magenta/,130,This is the 'free bits' trick mentioned in Kingma et al. (2016),
magenta/,136,"goes from [batch, 64, 64, 1] to [batch, hidden_size]",
magenta/,141,"conv layer, followed by instance norm + FiLM",
magenta/,162,"new conv layer, to bring shape down",
magenta/,168,"new conv layer, to bring shape down",
magenta/,174,ret has 1024,
magenta/,181,"goes from [batch, bottleneck_bits] to [batch, 64, 64, 1]",
magenta/,183,unbottleneck,
magenta/,188,new deconv to bring shape up,
magenta/,194,new deconv to bring shape up,
magenta/,244,VAE hparams,
magenta/,248,loss hparams,
magenta/,253,data format hparams,
magenta/,256,"problem hparams (required, don't modify)",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,25,pylint: disable=redefined-builtin,
magenta/,32,Number of output note classes. This is a property of the dataset.,
magenta/,35,Default batch size.,
magenta/,38,Music-related constants.,
magenta/,41,Inclusive,
magenta/,42,Exclusive,
magenta/,43,C Major,
magenta/,46,Music theory constants used in defining reward functions.,
magenta/,47,Note that action 2 = midi note 48.,
magenta/,54,"The number of half-steps in musical intervals, in order of dissonance",
magenta/,64,Special intervals that have unique rewards,
magenta/,72,Indicate melody direction,
magenta/,76,Indicate whether a melodic leap has been resolved or if another leap was made,
magenta/,108,TODO(natashajaques): ability to restore basic_rnn from any .mag file.,
magenta/,185,pylint: disable=bare-except,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,60,The following functions compute evaluation metrics to test whether the model,
magenta/,61,trained successfully.,
magenta/,199,Compute note by note stats as it composes.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,44,pylint: disable=redefined-builtin,
magenta/,45,pylint: disable=redefined-builtin,
magenta/,46,pylint: disable=redefined-builtin,
magenta/,49,Note values of special actions.,
magenta/,53,"Training data sequences are limited to this length, so the padding queue pads",
magenta/,54,to this length.,
magenta/,71,Hyperparameters,
magenta/,80,Trained Note RNN to load and tune,
magenta/,86,Other music related settings.,
magenta/,92,Logistics.,
magenta/,149,Make graph.,
magenta/,153,Memorize arguments.,
magenta/,205,DQN state.,
magenta/,214,Stored reward metrics.,
magenta/,226,Variables to keep track of characteristics of the current composition,
magenta/,227,TODO(natashajaques): Implement composition as a class to obtain data,
magenta/,228,encapsulation so that you can't accidentally change the leap direction.,
magenta/,232,stores the note at which composition leapt,
magenta/,258,Add internal networks to the graph.,
magenta/,292,Add rest of variables to graph.,
magenta/,296,Prepare saver and session.,
magenta/,301,Initialize internal networks.,
magenta/,307,Double check that the model was initialized from checkpoint properly.,
magenta/,315,TODO(natashamjaques): Remove print statement once tf.logging outputs,
magenta/,316,to Jupyter notebooks (once the following issue is resolved:,
magenta/,317,https://github.com/tensorflow/tensorflow/issues/3047),
magenta/,348,Get the next note that was predicted for each priming melody to be used,
magenta/,349,in priming.,
magenta/,352,"Each melody has TRAIN_SEQUENCE_LENGTH outputs, but the last note is",
magenta/,353,actually stored at lengths[i]. The rest is padding.,
magenta/,425,Output of the q network gives the value of taking each action (playing,
magenta/,426,each note).,
magenta/,431,The action values for the G algorithm are computed differently.,
magenta/,435,"Compute predicted action, which is the argmax of the action scores.",
magenta/,443,"Compute predicted action, which is the argmax of the action scores.",
magenta/,453,The target q network is used to estimate the value of the best action at,
magenta/,454,the state resulting from the current action.,
magenta/,459,Rewards are observed from the environment and are fed in later.,
magenta/,462,Each algorithm is attempting to model future rewards with a different,
magenta/,463,function.,
magenta/,477,Use default based on Q learning.,
magenta/,481,Total rewards are the observed rewards plus discounted estimated future,
magenta/,482,rewards.,
magenta/,487,Action mask will be a one-hot encoding of the action the network,
magenta/,488,actually took.,
magenta/,497,Prediction error is the mean squared error between the reward the,
magenta/,498,"network actually received for a given action, and what it expected to",
magenta/,499,receive.,
magenta/,502,Compute gradients.,
magenta/,506,Clip gradients.,
magenta/,516,Backprop.,
magenta/,521,Updates the target_q_network to be similar to the q_network based on,
magenta/,522,the target_network_update_rate.,
magenta/,526,Equivalent to target = (1-alpha) * target + alpha * source,
magenta/,568,"Experiencing observation, state, action, reward, new observation,",
magenta/,569,"new state tuples, and storing them.",
magenta/,585,Used to keep track of how the reward is changing over time.,
magenta/,588,Used to keep track of the current musical composition and beat for,
magenta/,589,the reward functions.,
magenta/,607,Save a checkpoint.,
magenta/,619,TODO(natashamjaques): Remove print statement once tf.logging outputs,
magenta/,620,to Jupyter notebooks (once the following issue is resolved:,
magenta/,621,https://github.com/tensorflow/tensorflow/issues/3047),
magenta/,637,Backprop.,
magenta/,640,Update current state as last state.,
magenta/,643,Reset the state after each composition is complete.,
magenta/,674,Compute the exploration probability.,
magenta/,682,Run the observation through the q_network.,
magenta/,752,Sample experience.,
magenta/,757,Batch states.,
magenta/,899,Gets and saves log p(a|s) as output by reward_rnn.,
magenta/,904,Makes the model play a scale (defaults to c major).,
magenta/,907,Makes the model play within a key.,
magenta/,910,"Makes the model play within a key, while starting and ending on the",
magenta/,911,tonic note.,
magenta/,915,"The model can play any composition it wants, but receives a large",
magenta/,916,negative reward for playing the same note repeatedly.,
magenta/,919,"The model receives reward for playing in key, playing tonic notes,",
magenta/,920,and not playing repeated notes. However the rewards it receives are,
magenta/,921,uniformly distributed over all notes that do not violate these rules.,
magenta/,926,"As above, the model receives reward for playing in key, tonic notes",
magenta/,927,"at the appropriate times, and not playing repeated notes. However, the",
magenta/,928,rewards it receives are based on the note probabilities learned from,
magenta/,929,data in the original model.,
magenta/,936,"Uses the same reward function as above, but adds a penalty for",
magenta/,937,compositions with a high autocorrelation (aka those that don't have,
magenta/,938,sufficient variety).,
magenta/,1047,"New rewards based on Gauldin's book, ""A Practical Approach to Eighteenth",
magenta/,1048,"Century Counterpoint""",
magenta/,1231,Note that the current action yas not yet been added to the composition,
magenta/,1378,Check if the motif is in the previous composition.,
magenta/,1444,get rid of non-notes in prev_note,
magenta/,1455,get rid of non-notes in action_note,
magenta/,1494,either no interval or involving uninteresting rests,
magenta/,1500,rests can be good,
magenta/,1512,large leaps and awkward intervals bad,
magenta/,1520,common major intervals are good,
magenta/,1528,smaller steps are generally preferred,
magenta/,1539,"larger leaps not as good, especially if not in key",
magenta/,1633,detect if leap,
magenta/,1642,there was already an unresolved leap,
magenta/,1658,the composition had no previous leaps,
magenta/,1666,there is no leap,
magenta/,1672,"If there was a leap before, check if composition has gradually returned",
magenta/,1673,This could be changed by requiring you to only go a 5th back in the,
magenta/,1674,opposite direction of the leap.,
magenta/,1714,TODO(natashajaques): music theory book also suggests having a mix of steps,
magenta/,1715,that are both incremental and larger. Want to write a function that,
magenta/,1716,rewards this. Could have some kind of interval_stats stored by,
magenta/,1717,reward_preferred_intervals function.,
magenta/,1778,np.log(1.0 + softmax),
magenta/,1789,TODO(natashamjaques): Remove print statement once tf.logging outputs,
magenta/,1790,to Jupyter notebooks (once the following issue is resolved:,
magenta/,1791,https://github.com/tensorflow/tensorflow/issues/3047),
magenta/,2021,TODO(natashamjaques): Remove print statement once tf.logging outputs,
magenta/,2022,to Jupyter notebooks (once the following issue is resolved:,
magenta/,2023,https://github.com/tensorflow/tensorflow/issues/3047),
magenta/,2031,TODO(natashamjaques): Remove print statement once tf.logging outputs,
magenta/,2032,to Jupyter notebooks (once the following issue is resolved:,
magenta/,2033,https://github.com/tensorflow/tensorflow/issues/3047),
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,166,TODO(lukaszkaiser): investigate the problem here and remove this hack.,
magenta/,183,Make an LSTM cell with the number and size of layers specified in,
magenta/,184,hparams.,
magenta/,190,"Shape of melody_sequence is batch size, melody length, number of",
magenta/,191,output note actions.,
magenta/,202,Set up a tf queue to read melodies from the training data tfrecord,
magenta/,209,Closure function is used so that this part of the graph can be,
magenta/,210,"re-run in multiple places, such as __call__.",
magenta/,252,Does not recreate the model architecture but rather uses it to feed,
magenta/,253,data from the training queue through the model.,
magenta/,308,Convert primer Melody to model inputs.,
magenta/,318,Run model over primer sequence.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,28,pylint: disable=unused-import,
magenta/,31,Need to use 'Agg' option for plotting and saving files from command line.,
magenta/,32,Can't use 'Agg' in RL Tuner because it breaks plotting in notebooks.,
magenta/,33,"pylint: disable=g-import-not-at-top,wrong-import-position",
magenta/,36,"pylint: enable=g-import-not-at-top,wrong-import-position",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,pylint: disable=unused-import,
magenta/,31,Need to use 'Agg' option for plotting and saving files from command line.,
magenta/,32,Can't use 'Agg' in RL Tuner because it breaks plotting in notebooks.,
magenta/,33,"pylint: disable=g-import-not-at-top,wrong-import-position",
magenta/,36,"pylint: enable=g-import-not-at-top,wrong-import-position",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,35,Our dataset.,
magenta/,36,Total number of steps of training. Keep large.,
magenta/,37,Number of batches per checkpoint creation.,
magenta/,38,Not used. Will be changed by model. [Eliminate?],
magenta/,39,Size of decoder.,
magenta/,40,"Decoder: lstm, layer_norm or hyper.",
magenta/,41,Size of encoder.,
magenta/,42,"Encoder: lstm, layer_norm or hyper.",
magenta/,43,"Size of latent vector z. Recommend 32, 64 or 128.",
magenta/,44,KL weight of loss equation. Recommend 0.5 or 1.0.,
magenta/,45,KL start weight when annealing.,
magenta/,46,Level of KL loss at which to stop optimizing for KL.,
magenta/,47,Minibatch size. Recommend leaving at 100.,
magenta/,48,Gradient clipping. Recommend leaving at 1.0.,
magenta/,49,Number of mixtures in Gaussian mixture model.,
magenta/,50,Learning rate.,
magenta/,51,Learning rate decay per minibatch.,
magenta/,52,KL annealing decay rate per minibatch.,
magenta/,53,Minimum learning rate.,
magenta/,54,Dropout with memory loss. Recommended,
magenta/,55,Probability of recurrent dropout keep.,
magenta/,56,Input dropout. Recommend leaving False.,
magenta/,57,Probability of input dropout keep.,
magenta/,58,Output dropout. Recommend leaving False.,
magenta/,59,Probability of output dropout keep.,
magenta/,60,Random scaling data augmentation proportion.,
magenta/,61,Point dropping augmentation proportion.,
magenta/,62,"When False, use unconditional decoder-only model.",
magenta/,63,Is model training? Recommend keeping true.,
magenta/,108,"bi-dir, so x2",
magenta/,115,"bi-dir, so x2",
magenta/,153,vae mode:,
magenta/,173,dropout:,
magenta/,195,The target/expected vectors of strokes,
magenta/,197,"vectors of strokes to be fed to decoder (same as above, but lagged behind",
magenta/,198,"one step to include initial dummy value of (0, 0, 1, 0, 0))",
magenta/,201,"either do vae-bit and get z, or do unconditional, decoder-only",
magenta/,202,vae mode:,
magenta/,205,sigma > 0. div 2.0 -> sqrt.,
magenta/,209,KL cost,
magenta/,224,"unconditional, decoder-only generation",
magenta/,234,TODO(deck): Better understand this comment.,
magenta/,235,Number of outputs is 3 (one logit per pen state) plus 6 per mixture,
magenta/,236,"component: mean_x, stdev_x, mean_y, stdev_y, correlation_xy, and the",
magenta/,237,mixture weight/probability (Pi_k),
magenta/,244,decoder module of sketch-rnn is below,
magenta/,258,"NB: the below are inner functions, not methods of Model",
magenta/,264,eq 25,
magenta/,276,This represents the L_R only (i.e. does not include the KL loss term).,
magenta/,281,result1 is the loss wrt pen offset (L_s in equation 9 of,
magenta/,282,https://arxiv.org/pdf/1704.03477.pdf),
magenta/,285,avoid log(0),
magenta/,287,use training data for this,
magenta/,289,"Zero out loss terms beyond N_s, the last actual stroke",
magenta/,292,"result2: loss wrt pen state, (L_p in equation 9)",
magenta/,296,"eval mode, mask eos columns",
magenta/,302,below is where we need to do MDN (Mixture Density Network) splitting of,
magenta/,303,distribution params,
magenta/,306,This uses eqns 18 -> 23 of http://arxiv.org/abs/1308.0850.,
magenta/,308,pen states,
magenta/,311,process output z's into MDN parameters,
magenta/,313,softmax all the pi's and pen states:,
magenta/,317,exponentiate the sigmas and also make corr between -1 and 1.,
magenta/,335,pen state probabilities (result of applying softmax to self.pen_logits),
magenta/,338,reshape target data so that it is compatible with prediction shape,
magenta/,397,"initially, we want to see beginning of new stroke",
magenta/,399,not used if unconditional,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,57,A note on formats:,
magenta/,58,Sketches are encoded as a sequence of strokes. stroke-3 and stroke-5 are,
magenta/,59,different stroke encodings.,
magenta/,60,"stroke-3 uses 3-tuples, consisting of x-offset, y-offset, and a binary",
magenta/,61,variable which is 1 if the pen is lifted between this position and,
magenta/,62,"the next, and 0 otherwise.",
magenta/,63,"stroke-5 consists of x-offset, y-offset, and p_1, p_2, p_3, a binary",
magenta/,64,"one-hot vector of 3 possible pen states: pen down, pen up, end of sketch.",
magenta/,65,See section 3.1 of https://arxiv.org/abs/1704.03477 for more detail.,
magenta/,66,"Sketch-RNN takes input in stroke-5 format, with sketches padded to a common",
magenta/,67,"maximum length and prefixed by the special start token [0, 0, 1, 0, 0]",
magenta/,68,The QuickDraw dataset is stored using stroke-3.,
magenta/,105,drop each point within a line segments with a probability of prob,
magenta/,106,note that the logic in the loop prevents points at the ends to be dropped.,
magenta/,110,Added to be safe.,
magenta/,117,uniform random variable,
magenta/,130,"stroke is a numpy array of [dx, dy, pstate], average_dimension is a float.",
magenta/,131,modifies stroke directly.,
magenta/,154,Useful function for exporting data to .json format.,
magenta/,177,(But does not insert special start token).,
magenta/,210,minibatch size,
magenta/,211,N_max in sketch-rnn paper,
magenta/,212,divide offsets by this factor,
magenta/,213,data augmentation method,
magenta/,214,Removes large gaps in the data. x and y offsets are clamped to have,
magenta/,215,absolute value no greater than this limit.,
magenta/,217,data augmentation method,
magenta/,218,S_0 in sketch-rnn paper,
magenta/,219,"sets self.strokes (list of ndarrays, one per sketch, in stroke-3 format,",
magenta/,220,sorted by size),
magenta/,233,removes large gaps from the data,
magenta/,240,nstrokes for each sketch,
magenta/,298,"We return three things: stroke-3 format, stroke-5 format, list of seq_len.",
magenta/,326,"put in the first token, as described in sketch-rnn methodology",
magenta/,329,setting S_0 from paper.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,79,only sample one at a time,
magenta/,86,sample one point at a time,
magenta/,113,normalizes the x and y columns using the training set.,
magenta/,114,applies same scaling factor to valid and test set.,
magenta/,158,calculate the max strokes we need.,
magenta/,160,overwrite the hps with this calculation.,
magenta/,177,only sample one at a time,
magenta/,178,sample one point at a time,
magenta/,252,Setup summary writer.,
magenta/,255,Calculate trainable params.,
magenta/,269,setup eval stats,
magenta/,270,set a large init value,
magenta/,273,main train loop,
magenta/,453,Write config file to json file.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,38,pylint: disable=unused-argument,
magenta/,47,pylint: disable=unused-argument,
magenta/,49,assumes lstm.,
magenta/,95,uniform,
magenta/,99,Keep W_xh and W_hh separate here as well to use different init methods.,
magenta/,122,fuk tuples.,
magenta/,135,"Performs layer norm on multiple base at once (ie, i, g, j, o for lstm)",
magenta/,136,Reshapes h in to perform layer norm in parallel,
magenta/,143,reshape back to original,
magenta/,211,uniform,
magenta/,285,uniform,
magenta/,294,concat for speed.,
magenta/,296,+ bias # live life without garbage.,
magenta/,298,"i = input_gate, j = new_input, f = forget_gate, o = output_gate",
magenta/,386,recurrent batch norm init trick (https://arxiv.org/abs/1603.09025).,
magenta/,387,cooijmans' da man.,
magenta/,436,uniform,
magenta/,448,concatenate the input and hidden states for hyperlstm input,
magenta/,458,split Wxh contributions,
magenta/,465,split Whh contributions,
magenta/,472,split bias,
magenta/,473,bias is to be broadcasted.,
magenta/,475,"i = input_gate, j = new_input, f = forget_gate, o = output_gate",
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,85,Quantize the priming sequence.,
magenta/,88,Setting gap_bars to infinite ensures that the entire input will be used.,
magenta/,96,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,97,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,98,seconds when the requested end time is 4.99.,
magenta/,105,"If no drum track could be extracted, create an empty drum track that",
magenta/,106,starts 1 step before the request start_step. This will result in 1 step,
magenta/,107,of silence when the drum track is extended below.,
magenta/,115,Ensure that the drum track extends up to the step we want to start,
magenta/,116,generating.,
magenta/,119,Extract generation arguments from generator options.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,175,Derive the total number of seconds to generate based on the QPM of the,
magenta/,176,priming sequence and the num_steps flag.,
magenta/,180,Specify start/stop time for generation based on starting generation at the,
magenta/,181,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,182,long.,
magenta/,186,Set the start time to begin on the next step after the last note ends.,
magenta/,216,Make the generate request num_outputs times and save the output as midi,
magenta/,217,files.,
magenta/,243,Having too large of a batch size will slow generation down unnecessarily.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,67,Default configurations.,
magenta/,75,use hand clap as default when decoding,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,52,5 measures,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,58,Transpose up to a major third in either direction.,
magenta/,59,"Because our current dataset is Bach chorales, transposing more than a major",
magenta/,60,"third in either direction probably doesn't makes sense (e.g., because it is",
magenta/,61,likely to exceed normal singing range).,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,191,Derive the total number of seconds to generate.,
magenta/,195,Specify start/stop time for generation based on starting generation at the,
magenta/,196,end of the priming sequence and continuing until the sequence is num_steps,
magenta/,197,long.,
magenta/,199,Set the start time to begin when the last note ends.,
magenta/,226,Make the generate request num_outputs times and save the output as midi,
magenta/,227,files.,
magenta/,250,Having too large of a batch size will slow generation down unnecessarily.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,27,pylint: disable=redefined-builtin,
magenta/,39,Beginning of the sequence.,
magenta/,41,End of the sequence.,
magenta/,43,End of a step within the sequence.,
magenta/,45,Start of a new note.,
magenta/,47,Continuation of a note.,
magenta/,157,First remove any trailing end events.,
magenta/,159,"Then add an end step event, to close out any incomplete steps.",
magenta/,162,Then trim or pad as needed.,
magenta/,167,Then add a trailing end event.,
magenta/,280,Use a list rather than a set because one pitch may be active multiple,
magenta/,281,times.,
magenta/,348,Use lists rather than sets because one pitch may be active multiple times.,
magenta/,371,"Find active pitches that should end. Create notes for them, based on",
magenta/,372,when they started.,
magenta/,373,Make a copy of pitch_start_steps so we can remove things from it while,
magenta/,374,iterating.,
magenta/,391,Increment the step counter.,
magenta/,394,All active pitches are eligible for ending unless continued.,
magenta/,442,Create a histogram measuring lengths (in bars not steps).,
magenta/,447,Allow only 1 program.,
magenta/,455,Translate the quantized sequence into a PolyphonicSequence.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,54,5 measures,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,30,pylint:disable=invalid-name,
magenta/,52,step 0,
magenta/,56,step 1,
magenta/,61,step 2,
magenta/,65,step 3,
magenta/,82,Make comparison easier,
magenta/,93,step 0,
magenta/,97,step 1,
magenta/,100,"Was not started, should be ignored.",
magenta/,114,Make comparison easier,
magenta/,125,step 0,
magenta/,127,END event before end. Should be ignored.,
magenta/,129,END event before end. Should be ignored.,
magenta/,131,END event before end. Should be ignored.,
magenta/,132,step 1,
magenta/,134,END event before end. Should be ignored.,
magenta/,136,END event before end. Should be ignored.,
magenta/,150,Make comparison easier,
magenta/,161,step 0,
magenta/,164,missing STEP_END and END events at end of sequence.,
magenta/,177,step 0,
magenta/,181,step 1,
magenta/,197,Make comparison easier,
magenta/,209,step 0,
magenta/,213,step 1,
magenta/,233,Make comparison easier,
magenta/,245,step 0,
magenta/,247,step 1,
magenta/,282,Add 5 more steps to make sure END is managed properly.,
magenta/,310,Construct a list with one silence step and no END.,
magenta/,328,Construct a list with one note and no STEP_END or END.,
magenta/,350,step 0,
magenta/,353,step 1,
magenta/,356,step 2,
magenta/,368,step 0,
magenta/,371,step 1,
magenta/,382,step 0,
magenta/,401,Construct a list with two silence steps and no END.,
magenta/,419,"Construct a list with a silence step, a new note, and no STEP_END or END.",
magenta/,439,step 0,
magenta/,443,step 1,
magenta/,461,step 0,
magenta/,465,step 1,
magenta/,469,incomplete step. should not be counted.,
magenta/,482,step 0,
magenta/,486,step 1,
magenta/,510,step 0,
magenta/,524,step 0,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
magenta/,15,Lint as: python3,
magenta/,59,"This sequence will be quantized later, so it is guaranteed to have only 1",
magenta/,60,tempo.,
magenta/,91,Quantize the priming sequence.,
magenta/,101,"Note that when quantizing end_step, we set quantize_cutoff to 1.0 so it",
magenta/,102,always rounds down. This avoids generating a sequence that ends at 5.0,
magenta/,103,seconds when the requested end time is 4.99.,
magenta/,110,"If no track could be extracted, create an empty track that starts at the",
magenta/,111,requested generate_start_step. This will result in a sequence that,
magenta/,112,contains only the START token.,
magenta/,118,Ensure that the track extends up to the step we want to start generating.,
magenta/,120,Trim any trailing end events to prepare the sequence for more events to be,
magenta/,121,appended during generation.,
magenta/,124,Extract generation arguments from generator options.,
magenta/,135,"Inject the priming sequence as melody in the output of the generator, if",
magenta/,136,requested.,
magenta/,137,This option starts with no_ so that if it is unspecified (as will be the,
magenta/,138,"case when used with the midi interface), the default will be to inject the",
magenta/,139,primer.,
magenta/,146,0 steps because we'll overwrite poly_seq with a blank sequence below.,
magenta/,152,"If we don't want to condition on the priming sequence, then overwrite",
magenta/,153,poly_seq with a blank sequence to feed into the generator.,
magenta/,165,Assume it takes ~5 rnn steps to generate one quantized step.,
magenta/,166,Can't know for sure until generation is finished because the number of,
magenta/,167,notes per quantized step is variable.,
magenta/,180,Specify a base_note_sequence because the priming sequence was not,
magenta/,181,included in poly_seq.,
magenta/,212,Only modify the event sequence if we're at the start of a new step or this,
magenta/,213,is the first step.,
magenta/,220,Determine the current step event.,
magenta/,226,Find the corresponding event in the input melody.,
magenta/,1,Copyright 2020 The Magenta Authors.,
magenta/,2,,
magenta/,3,"Licensed under the Apache License, Version 2.0 (the ""License"");",
magenta/,4,you may not use this file except in compliance with the License.,
magenta/,5,You may obtain a copy of the License at,
magenta/,6,,
magenta/,7,http://www.apache.org/licenses/LICENSE-2.0,
magenta/,8,,
magenta/,9,"Unless required by applicable law or agreed to in writing, software",
magenta/,10,"distributed under the License is distributed on an ""AS IS"" BASIS,",
magenta/,11,"WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
magenta/,12,See the License for the specific language governing permissions and,
magenta/,13,limitations under the License.,
